{"version":3,"sources":["webpack:///webpack/bootstrap c288dd7c421aefffdcc4","webpack:///./src/index.js","webpack:///./src/utils.js","webpack:///./src/constants.js","webpack:///./src/image-editor.js","webpack:///./node_modules/rematrix/dist/rematrix.es.js","webpack:///./src/canvas-workspace.js","webpack:///./src/crop-container.js"],"names":["window","imageEditor","imagePath","imageAltText","onWorkSpaceUpdated","document","querySelector","state","template","appContainer","width","height","image","originalWidth","originalHeight","ratio","left","top","cropContainer","right","bottom","innerHTML","noop","throttle","createElement","getOffsetRelativeToParent","getCenterPositionRelativeToParent","getMousePosition","calculateAspectRatioFit","calculateOriginalDimensionsFromScaled","transformCSS","getRadianFromDegrees","getDegreesFromRadians","regExp","hasClass","removeClass","addClass","createTransformMatrix","getOriginalCoordinatesFromTransformedMatrix","setTimeout","Function","prototype","type","name","obj","running","func","requestAnimationFrame","throttledRequestAnimationFrame","dispatchEvent","CustomEvent","addEventListener","options","element","tagName","className","attributes","attr","setAttribute","text","appendChild","createTextNode","children","length","i","childrenLength","HTMLElement","childCssSelector","parentCssSelector","childElem","parentElem","Error","childRect","getBoundingClientRect","parentRect","childElement","parentElement","offsetWidth","offsetHeight","event","contextElement","offsetLeft","pageXOffset","offsetTop","pageYOffset","x","pageX","touches","y","pageY","srcWidth","srcHeight","maxWidth","maxHeight","rotated","gutter","aspectRatio","Math","min","floor","scaledWidth","scaledHeight","translateX","translateY","scale","radians","style","transform","degrees","PI","RegExp","Element","test","classList","contains","replace","remove","add","transformMatrix","inverseTransformMatrix","rotate","cos","sin","cross","xx","yy","CSS_NAMESPACE","IMAGE_ALT_TEXT","ACTIVE_CLASS","EDITOR_GUTTER","DEBUG","Rematrix","ImageEditor","props","container","centerX","centerY","originX","originY","imageEditorContainer","center","onImageLoaded","bind","updateWorkspace","onWindowResize","imageObj","Image","onload","onerror","canvasWorkspace","croppingContainerState","imageEditorWorkspace","getElement","fragment","createDocumentFragment","frameRateInterval","requestAnimationFrameId","lastTimestamp","src","naturalWidth","naturalHeight","performance","now","timestamp","elapsedTime","imageAspectRatio","appContainerCenterX","appContainerCenterY","imageCenterTranslateX","imageCenterTranslateY","imageObjStyle","getComputedStyle","parse","r1","r2","product","reduce","multiply","toString","cropContainerState","getState","cropContainerWidth","initialized","cropContainerHeight","cropContainerLeft","cropContainerTop","update","imageCoords","drawImage","canvasWidth","canvasHeight","imageWidth","imageHeight","imageX","imageY","drawWidth","drawHeight","drawX","drawY","format","source","constructor","Array","TypeError","matrix","identity","RangeError","push","inverse","m","s0","s1","s2","s3","s4","s5","c5","c4","c3","c2","c1","c0","determinant","isNaN","Infinity","fm","fx","row","j","k","col","result","match","raw","split","map","parseFloat","angle","rotateZ","rotateX","theta","rotateY","scalar","scalarY","scaleX","scaleY","scaleZ","skew","angleX","angleY","thetaX","tan","thetaY","skewX","skewY","join","translate","distanceX","distanceY","distance","translateZ","CanvasWorkspace","context","getContext","clearRect","save","restore","CropContainer","maxDimensions","minDimensions","onStartDragCropArea","onStartCropResize","onCropResize","onStopCropResize","dragging","passive","preventDefault","target","stopImmediatePropagation","cropEvent","mousePos","ignoreResize","console","log","constrain","shiftKey","imageLeft","imageTop","cropActionTriggered","removeEventListener"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c288dd7c421aefffdcc4","import Editor from './image-editor';\n\nwindow.imageEditor = new Editor(\n    {\n        imagePath: 'http://localhost:8888/src/amsler.jpg',\n        imageAltText: 'A village after dark',\n        onWorkSpaceUpdated\n    },\n    document.querySelector( '.media-image-editor__canvas-container' )\n);\n\n\n// DEBUG\nfunction onWorkSpaceUpdated( state ) {\n    //const croppedImageObj = document.querySelector( '.media-image-editor_debug__preview-container img' );\n    //const croppedImageAtag = document.querySelector( '.media-image-editor_debug__preview-container a' );\n    //const previewImage = newImageEditorState.canvas.toDataURL('image/jpeg', 0.8 );\n    //croppedImageObj.src = previewImage;\n    //croppedImageObj.width = newImageEditorState.cropped.width;\n    //croppedImageObj.height = newImageEditorState.cropped.height;\n    //croppedImageAtag.href = previewImage;\n\n    const template = `\n        <li>\n            <var>App container dimensions</var>\n            <samp>\n                ${ state.appContainer.width } x ${ state.appContainer.height }\n            </samp>\n        </li>\n        <li>\n            <var>Original image dimensions</var>\n            <samp>\n                ${ state.image.originalWidth } x ${ state.image.originalHeight  }\n            </samp>\n        </li>\n\t\t<li>\n\t\t\t<var>Scaled image dimensions</var>\n\t\t\t<samp>\n\t\t\t\t${ state.image.width } x ${ state.image.height }\n\t\t\t</samp>\n\t\t</li>\n        <li>\n\t\t\t<var>Ratio to original image</var>\n\t\t\t<samp>${ state.image.ratio }</samp>\n        </li>\n         <li>\n            <var>Image coordinates relative to window</var>\n            <samp>\n                left: ${ state.image.left }, top:  ${ state.image.top  }\n            </samp>\n        </li>\n         <li>\n            <var>Crop container height and width</var>\n            <samp>\n                ${ state.cropContainer.width } x ${ state.cropContainer.height }\n            </samp>\n        </li>\n         <li>\n            <var>Crop container coordinates relative to window</var>\n            <samp>\n                left: ${ state.cropContainer.left }, top:  ${ state.cropContainer.top  },\n                right: ${ state.cropContainer.right }, bottom:  ${ state.cropContainer.bottom  }\n            </samp>\n        </li>\n    `;\n\n    document.querySelector( '.media-image-editor_debug-values ul' ).innerHTML = template;\n    document.querySelector( '.media-image-editor_debug-values ul' ).innerHTML = template;\n\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * Create a noop call\n * @returns {Function}\n */\nexport function noop() {\n    setTimeout( Function.prototype, 10000 );\n}\n\n/**\n * Throttle a func call every {threshhold}ms\n * https://developer.mozilla.org/en-US/docs/Web/Events/resize\n * Usage:\n    throttle(\"resize\", \"optimizedResize\");\n    // handle event\n    window.addEventListener(\"optimizedResize\", function() {\n        console.log(\"Resource conscious resize callback!\");\n    });\n */\nexport function throttle( type, name, obj = window ) {\n    let running = false;\n    const func = function() {\n        if (running) { return; }\n        running = true;\n        requestAnimationFrame(function throttledRequestAnimationFrame() {\n            obj.dispatchEvent( new CustomEvent( name ) );\n            running = false;\n        });\n    };\n    obj.addEventListener(type, func);\n}\n\n/**\n * Creates a simple DOM tree\n * @example\nconst htmlElementToAppend = createElement({\n  tagName: 'span',\n  className: 'new-class-name',\n  text: 'Spannend!',\n  attributes: {\n    'title': 'Geil!'\n  },\n  children: [{ \n      // recursive call to createElement()\n  }]\n})); // returns => <span class=\"new-class-name\" title=\"Geil!\">Spannend!</span>\n * @typedef {Object} OptionsObject\n * @property {String} tagName\n * @property {String} className\n * @property {String} text\n * @property {Object} attributes\n * @property {Array<options>} children\n * \n * @param {OptionsObject} options\n * @returns {HTMLElement}\n */\nexport function createElement( options ) {\n\n    const element = document.createElement( options.tagName );\n\n    if ( options.className ) {\n        element.className = options.className;\n    }\n\n    if ( options.attributes ) {\n        for ( let attr in options.attributes ) {\n            element.setAttribute( attr, options.attributes[attr] )\n        }\n    }\n\n    if ( options.text ) {\n        element.appendChild( document.createTextNode( options.text ) );\n    }\n\n    if ( options.children && options.children.length ) {\n        let i = 0;\n        let childrenLength = options.children.length;\n        for (; i < childrenLength; i++ ) {\n            element.appendChild( options.children[i] instanceof window.HTMLElement ? options.children[i] : createElement( options.children[i] ) );\n        }\n    }\n\n    return element;\n\n}\n\n/**\n * @example\n const offsetValues = getOffsetRelativeToParent(\n    '.child-selector',\n    '#parent-selector'\n ); // returns => { top: {n}, right: {n}, bottom: {n}, left: {n} }\n * @typedef {Object} OffsetObject\n * @property {Integer} top\n * @property {Integer} right\n * @property {Integer} bottom\n * @property {Integer} left\n *\n * @param {String} childCssSelector\n * @param {String} parentCssSelector\n * @returns {OffsetObject}\n */\nexport function getOffsetRelativeToParent( childCssSelector, parentCssSelector) {\n\n    // we have to query the DOM elements to get the latest position data\n    // in case there has been a CSS transform on the element(s)\n    const childElem = document.querySelector( childCssSelector );\n    const parentElem = document.querySelector( parentCssSelector );\n\n    if ( ! childElem || ! parentElem ) {\n        throw new Error( `One or more DOM elements can't be found with: ${childCssSelector} or ${parentCssSelector}` );\n    }\n\n    const childRect = childElem.getBoundingClientRect();\n    const parentRect = parentElem.getBoundingClientRect();\n\n    return {\n        top: childRect.top - parentRect.top,\n        right: childRect.right - parentRect.right,\n        bottom: childRect.bottom - parentRect.bottom,\n        left: childRect.left - parentRect.left\n    };\n\n}\n\n/**\n * @example\n const offsetValues = getCenterPositionRelativeToParent(\n    HTMLElement,\n    HTMLElement.parentNode\n ); // returns => { left: {n}, top: {n} }\n * @typedef {Object} CenterPosition\n * @property {Integer} top\n * @property {Integer} left\n *\n * @param {HTMLElement} childElement\n * @param {HTMLElement} parentElement\n * @returns {CenterPosition}\n */\nexport function getCenterPositionRelativeToParent( childElement, parentElement ) {\n    return {\n        left: ( parentElement.offsetWidth / 2 - childElement.offsetWidth / 2 ),\n        top: ( parentElement.offsetHeight / 2 - childElement.offsetHeight / 2 )\n    };\n}\n\n/**\n * @example\n const mousePos = getMousePosition(\n    DOMEventObject,\n    HTMLElement\n ); // returns => { x: {n}, y: {n} }\n * @typedef {Object} PositionObject\n * @property {Integer} x\n * @property {Integer} y\n *\n * @param {DOMEventObject} event\n * @param {HTMLElement} contextElement (optional if you need position relative to parent offset)\n * @returns {PositionObject}\n */\nexport function getMousePosition( event, contextElement = null ) {\n\n    const offsetLeft = contextElement ? contextElement.offsetLeft : window.pageXOffset;\n    const offsetTop = contextElement ? contextElement.offsetTop : window.pageYOffset;\n\n    const x = ( event.pageX || ( event.touches && event.touches[0].pageX ) ) - offsetLeft;\n    const y = ( event.pageY || ( event.touches && event.touches[0].pageY ) ) - offsetTop;\n\n    return {\n        x,\n        y\n    };\n}\n\n\n/**\n * Conserve aspect ratio of the orignal region. Useful when shrinking/enlarging\n * images to fit into a certain area.\n * At the moment we expect rotations of only 90 degrees.\n * This could be improved by always checking if the bounding box of a rotated rectangle fits within the scaled container\n *\n * @param {Number} srcWidth Source area width\n * @param {Number} srcHeight Source area height\n * @param {Number} maxWidth Fittable area maximum available width\n * @param {Number} maxHeight Fittable area maximum available height\n * @param {Boolean} rotated\n * @param {Number} gutter - Optional percentage to increase or decrease the new fit dimensions\n * @return {Object} { width, heigth }\n */\nexport function calculateAspectRatioFit( srcWidth, srcHeight, maxWidth, maxHeight, rotated = false, gutter = 1 ) {\n\n    const aspectRatio = rotated ? Math.min( maxHeight / srcWidth, maxWidth / srcHeight ) : Math.min( maxWidth / srcWidth, maxHeight / srcHeight );\n    // reduce ratio to gutter percentage amount\n    const ratio = aspectRatio * gutter;\n\n    // widths with ratio applied\n    const width = Math.floor( srcWidth * ratio ) ;\n    const height = Math.floor( srcHeight * ratio ) ;\n\n    return {\n        ratio,\n        width,\n        height\n    };\n}\n\nexport function calculateOriginalDimensionsFromScaled( scaledWidth, scaledHeight, ratio ) {\n\n    // widths with ratio applied\n    const width = Math.floor( scaledWidth / ratio ) ;\n    const height = Math.floor( scaledHeight / ratio ) ;\n\n    return {\n        width,\n        height\n    };\n}\n\nexport function transformCSS( element, translateX = 0, translateY = 0, scale = 0, radians = 0 ) {\n    element.style.transform = `translate( ${ translateX }px, ${ translateY }px ) scale( ${ scale } ) rotate( ${ radians }rad ) translateZ( 0px )`;\n    return element;\n}\n\n// Converts from degrees to radians.\nexport function getRadianFromDegrees( degrees ) {\n    return degrees * Math.PI / 180;\n}\n\n// Converts from radians to degrees.\nexport function getDegreesFromRadians( radians ) {\n    return radians * 180 / Math.PI;\n}\n\nexport function regExp( name ) {\n    return new RegExp( `(^| )${name}( |$)` );\n}\n\nexport function hasClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype )  ) {\n        return regExp( name ).test( this.element.className );\n    }\n    return element.classList.contains( className );\n}\n\nexport function removeClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className =  element.className.replace( regExp( name ), '' );\n    }\n    return element.classList.remove( className );\n}\n\nexport function addClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className += ' ' + className;\n    }\n    return element.classList.add( className );\n}\n\nexport function createTransformMatrix( transformMatrix, inverseTransformMatrix, x, y, scale, rotate ) {\n\n    // create the rotation and scale parts of the transformMatrix\n    transformMatrix[3] =   transformMatrix[0] = Math.cos(rotate) * scale;\n    transformMatrix[2] = -(transformMatrix[1] = Math.sin(rotate) * scale);\n\n    // add the translation\n    transformMatrix[4] = x;\n    transformMatrix[5] = y;\n\n    // calculate the inverse transformation\n\n    // first get the cross product of x axis and y axis\n    var cross = transformMatrix[0] * transformMatrix[3] - transformMatrix[1] * transformMatrix[2];\n\n    // now get the inverted axis\n    inverseTransformMatrix[0] =  transformMatrix[3] / cross;\n    inverseTransformMatrix[1] = -transformMatrix[1] / cross;\n    inverseTransformMatrix[2] = -transformMatrix[2] / cross;\n    inverseTransformMatrix[3] =  transformMatrix[0] / cross;\n    \n\n    return {\n        transformMatrix,\n        inverseTransformMatrix\n    };\n};\n\n// params: x, y coords in current, transformed matrix\n// returns x,y coords from original, untransformed matrix\nexport function getOriginalCoordinatesFromTransformedMatrix( transformMatrix, inverseTransformMatrix, x, y ) {\n    var xx, yy;\n    xx = x - transformMatrix[4];     // remove the translation\n    yy = y - transformMatrix[5];     // by subtracting the origin\n    // return the point {x:?,y:?} by multiplying xx,yy by the inverse matrix\n    return {\n        x:   xx * inverseTransformMatrix[0] + yy * inverseTransformMatrix[2],\n        y:   xx * inverseTransformMatrix[1] + yy * inverseTransformMatrix[3]\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","export const CSS_NAMESPACE = 'image-editor';\nexport const IMAGE_ALT_TEXT = 'Image being edited';\nexport const ACTIVE_CLASS = 'image-editor__active';\nexport const EDITOR_GUTTER = .7;\nexport const DEBUG = true;\n\n\n\n// WEBPACK FOOTER //\n// ./src/constants.js","import * as Rematrix from 'rematrix';\n\nimport {\n    noop,\n    createElement,\n    calculateAspectRatioFit,\n    getRadianFromDegrees,\n    addClass,\n    hasClass,\n    removeClass,\n    getMousePosition ,\ngetOffsetRelativeToParent,\ncreateTransformMatrix,\ngetOriginalCoordinatesFromTransformedMatrix } from './utils';\nimport CanvasWorkspace from './canvas-workspace';\nimport CropContainer from './crop-container';\nimport {\n\tCSS_NAMESPACE,\n\tIMAGE_ALT_TEXT,\n\tACTIVE_CLASS,\n\tEDITOR_GUTTER,\n\tDEBUG,\n} from './constants';\n\n\n\n// https://codepen.io/anon/pen/YQJmMr\n//https://stackoverflow.com/questions/34597160/html-canvas-mouse-position-after-scale-and-translate\n\n\n\n// animationframe\n// drawImage while resizing crop area\n// https://stackoverflow.com/questions/6198771/drawing-image-in-canvas-at-an-angle-without-rotating-the-canvas\n// https://stackoverflow.com/questions/41847928/scaling-the-image-and-fitting-in-the-canvas-after-rotation\n\n// when crop tool hits boundary and there's image overflow, zoom/scale image down\n// when cropping down, cropped area zooms out to max width and height according to aspect ratio of container\n/*\n * Cropping area\n * on page load dimensions of the cropping area = the scaled dims of the image\n *\n * 1.    the min dimensions of the cropping area:\n *\n *       a) when the scaled image dims are >= than the cropped area ? 50px square (or according to the aspect ratio)\n *       b) when the scaled image dims === cropped area ? image dims\n *\n * 2.    the max dimensions of the cropping area:\n *       a) when the image dims are > than the cropped area ? = the container bounds - gutter\n *\n *       b) when a crop handler reaches its max bound in any corner\n *       i) if scaled image dim are greater than the cropped area ? make transform-origin the dragged corner of the cropped Area and scale the image\n *      while the mouse is down according to mouse position * sensitivity (the more image overflow there is the faster the growth) until the\n *      cropped area dims reach the scaled height or width of the image\n *\n *      c) when scaled image dims === cropping area dims ?\n *\n * */\n\n\n\n\nexport default class ImageEditor {\n\n    constructor( props, container ) {\n\n        // cache of computed image properties\n        this.state = {\n\t\t\timage: {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\toriginalWidth: 0,\n\t\t\t\toriginalHeight: 0,\n\t\t\t\trotated: false,\n\t\t\t\tratio: 1,\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tcenterX: 0,\n\t\t\t\tcenterY: 0,\n\t\t\t\toriginX: 0,\n\t\t\t\toriginY: 0,\n\t\t\t},\n\t\t\t// The image container\n\t\t\timageEditorContainer: {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t},\n\n\t\t\t// The app container\n\t\t\tappContainer: {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t},\n\t\t\t// center of app container\n\t\t\tcenter: {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t}\n        };\n\n\n        // this will be an ajax call\n        this.imagePath = props.imagePath;\n\n        // append elements\n        this.appContainer = container;\n\n        // bind class methods to this\n        this.onImageLoaded = this.onImageLoaded.bind( this );\n        this.updateWorkspace = this.updateWorkspace.bind( this );\n        this.onWindowResize = this.onWindowResize.bind( this );\n\n        // the image to manipulate\n        this.imageObj = new Image();\n        this.imageObj.setAttribute('crossOrigin', 'anonymous');\n        this.imageObj.className = `${CSS_NAMESPACE}__image-layer`;\n        this.imageObj.setAttribute( 'alt', this.imageAltText || IMAGE_ALT_TEXT );\n        this.imageObj.onload = this.onImageLoaded;\n        this.imageObj.onerror = noop;\n\n\n\t\t// create elements\n        // this is the offPage workspace\n        // it takes the transformed image, and calculates the positions and ratios required to create output image\n        // https://www.html5rocks.com/en/tutorials/canvas/performance/#toc-pre-render\n        // https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\n        this.canvasWorkspace = createElement( {\n            tagName: 'canvas',\n            className: `${CSS_NAMESPACE}__canvas-workspace`\n        } );\n\n        this.canvasWorkspace = new CanvasWorkspace();\n        this.cropContainer = new CropContainer( {\n\t\t\tappContainer: this.appContainer,\n\t\t\timageObj: this.imageObj,\n\t\t\tcanvasWorkspace: this.canvasWorkspace,\n\t\t\tonWorkSpaceUpdated: ( croppingContainerState ) => {\n\t\t\t\tif ( DEBUG ) {\n\t\t\t\t\tprops.onWorkSpaceUpdated( {\n\t\t\t\t\t\t...this.state,\n\t\t\t\t\t\tcropContainer: croppingContainerState,\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t},\n\t\t} );\n\n        // this is the workspace wrapper\n        this.imageEditorWorkspace = createElement( {\n            tagName: 'div',\n            className: `${CSS_NAMESPACE}__workspace`,\n            children : [ this.imageObj, this.canvasWorkspace.getElement(), this.cropContainer.getElement() ]\n        } );\n\n        // this is the main container\n        this.imageEditorContainer = createElement( {\n            tagName: 'div',\n            className: `${CSS_NAMESPACE}__container ${CSS_NAMESPACE}__container-loading`,\n            children : [ this.imageEditorWorkspace ]\n        } );\n\n        // append elements\n\t\tconst fragment = document.createDocumentFragment();\n        fragment.appendChild( this.imageEditorContainer );\n        this.appContainer.appendChild( fragment );\n\n        this.frameRateInterval = 1000 / 30;\n        this.requestAnimationFrameId = null;\n        this.lastTimestamp = null;\n\n        // callbacks\n        this.onWorkSpaceUpdated = props.onWorkSpaceUpdated;\n\n        // load image and prepare workspace\n        this.imageObj.src = this.imagePath;\n\n        return this;\n\n    }\n\n    onImageLoaded() {\n\t\tthis.state.image.originalWidth = this.imageObj.naturalWidth;\n\t\tthis.state.image.originalHeight = this.imageObj.naturalHeight;\n\t\tthis.state.appContainer.width = this.appContainer.offsetWidth;\n\t\tthis.state.appContainer.height = this.appContainer.offsetHeight;\n\n        // initial update of coordinates\n        this.updateWorkspace();\n\n        if ( typeof window !== 'undefined' ) {\n              this.lastTimestamp = window.performance.now();\n              window.addEventListener( 'resize', this.onWindowResize );\n        }\n\n        // finally, we show the workspace\n        // place it on the end of the stack to ensure the update takes place first\n        setTimeout( () => {\n            removeClass( this.imageEditorContainer, `${CSS_NAMESPACE}__container-loading` );\n        } );\n    }\n\n    onWindowResize() {\n        this.requestAnimationFrameId = window.requestAnimationFrame( this.updateWorkspace );\n    }\n\n    // update the positions and dimensions\n    // when the workspace changes\n    updateWorkspace( timestamp ) {\n      const now = timestamp,\n          elapsedTime = now - this.lastTimestamp;\n\n        if ( elapsedTime < this.frameRateInterval ) {\n          return;\n        }\n\n        // if enough time has passed to call the next frame\n        // reset lastTimeStamp minus 1 frame in ms ( to adjust for frame rates other than 60fps )\n        this.lastTimestamp = now - ( elapsedTime % this.frameRateInterval );\n\n\n\n\t\t// get aspect ratio for the original image based on container size\n\t\tconst imageAspectRatio = calculateAspectRatioFit(\n\t\t\t\tthis.imageObj.naturalWidth,\n\t\t\t\tthis.imageObj.naturalHeight,\n\t\t\t\tthis.appContainer.offsetWidth,\n\t\t\t\tthis.appContainer.offsetHeight,\n\t\t\t\tthis.state.image.rotated,\n\t\t\t1 );\n\n\t\t// apply the initial dimensions to the image\n\t\tthis.state.image.width = imageAspectRatio.width;\n\t\tthis.state.image.height = imageAspectRatio.height;\n\t\tthis.state.image.ratio = imageAspectRatio.ratio;\n\n\n\t\tthis.imageObj.width = this.state.image.width;\n\t\tthis.imageObj.height = this.state.image.height;\n\n\n\n\n\n\n\n\t\t/*\n\t\t\tMatrix:\n\t\t\t\tCenter the image\n\t\t*/\n\n\t\t// center coords of container\n\t\t// new center - old centre\n\t\tconst appContainerCenterX = this.appContainer.offsetWidth / 2;\n\t\tconst appContainerCenterY = this.appContainer.offsetHeight / 2;\n\t\tconst imageCenterTranslateX = appContainerCenterX - ( this.state.image.width / 2 );\n\t\tconst imageCenterTranslateY = appContainerCenterY - ( this.state.image.height / 2 );\n\n\t\tconst imageObjStyle = getComputedStyle( this.imageObj ).transform;\n\t\tconst transform = Rematrix.parse( imageObjStyle );\n\t\tconst r1 = Rematrix.translateX( imageCenterTranslateX - this.state.image.originX );\n\t\tconst r2 = Rematrix.translateY( imageCenterTranslateY - this.state.image.originY );\n\t\t//const r3 = Rematrix.scale( cropContainerAspectRatio.ratio );\n\t\tconst product = [ transform, r1, r2 ].reduce( Rematrix.multiply );\n\t\tthis.imageObj.style.transform = Rematrix.toString( product );\n\t\tthis.state.image.originX = imageCenterTranslateX;\n\t\tthis.state.image.originY = imageCenterTranslateY;\n\t\tthis.state.image.left = appContainerCenterX - ( this.state.image.width / 2 );\n\t\tthis.state.image.top = appContainerCenterY - ( this.state.image.height / 2 );\n\n\t\t/*\n\t\t\tCrop container:\n\n\t\t*/\n\t\t// now we want the scale ratio for the cropping area\n\t\t// so we get the dimensions of the scaled image\n\t\t// we're scaling the image based on the container dimensions\n\t\t// we want to the crop container to fit the outerContainer, but be no bigger than the image\n\t\tconst cropContainerState = this.cropContainer.getState();\n\t\tconst cropContainerWidth = cropContainerState.initialized ? cropContainerState.width : this.state.image.width;\n\t\tconst cropContainerHeight = cropContainerState.initialized ? cropContainerState.height : this.state.image.height;\n\t\tconst cropContainerLeft = cropContainerState.initialized ? cropContainerState.left : this.state.image.left;\n\t\tconst cropContainerTop = cropContainerState.initialized ? cropContainerState.top : this.state.image.top;\n\n\n\n\n\n\n\t\tthis.cropContainer.update( {\n\t\t\tleft: cropContainerLeft,\n\t\t\ttop: cropContainerTop,\n\t\t\twidth: cropContainerWidth,\n\t\t\theight: cropContainerHeight,\n\t\t\tmaxWidth: this.state.image.height,\n\t\t\tmaxHeight: this.state.image.height,\n\t\t\timageCoords: {\n\t\t\t\tleft: this.state.image.left,\n\t\t\t\ttop: this.state.image.top,\n\t\t\t\tright: this.state.image.left + this.state.image.width,\n\t\t\t\tbottom: this.state.image.top + this.state.image.height,\n\t\t\t}\n\n\t\t} );\n\n\t\t// cache the container offset width\n\t\tthis.state.appContainer.width = this.appContainer.offsetWidth;\n\t\tthis.state.appContainer.height = this.appContainer.offsetHeight;\n\t\t/*\n\t\t\tCanvas update:\n\n\t\t*/\n        // TODO: we don't actually have to do this at all until the final save\n        this.canvasWorkspace.drawImage( {\n\t\t\timageObj: this.imageObj,\n\t\t\tcanvasWidth: this.state.appContainer.width,\n\t\t\tcanvasHeight: this.state.appContainer.height,\n\t\t\timageWidth: this.imageObj.naturalWidth,\n\t\t\timageHeight: this.imageObj.naturalHeight,\n\t\t\timageX: 0,\n\t\t\timageY: 0,\n\t\t\tdrawWidth: cropContainerWidth,\n\t\t\tdrawHeight: cropContainerHeight,\n\t\t\tdrawX: cropContainerLeft,\n\t\t\tdrawY: cropContainerTop,\n\t\t} );\n\n\t\tif ( DEBUG ) {\n\t\t\tthis.onWorkSpaceUpdated( {\n\t\t\t\t...this.state,\n\t\t\t\tcropContainer: this.cropContainer.getState(),\n\t\t\t} );\n\t\t}\n    }\n\n\n    // ==== editing API\n    // rotate( callback ) // returns new coords\n    // reflect( callback ) // returns new coords\n    // changeAspectRatio( callback ) // returns new coords\n    // save() // returns blob\n    // preview() // returns image/png for optional preview before save\n    // reset( callback )\n    // onImageLoaded( callback ) // allows consumers to do something after bootstrap\n    // destroy () clear container and remove all event listeners\n    // getOriginalImage() // returns original image\n    // getWorkingImage() // returns image at current crop state\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/image-editor.js","/*! @license Rematrix v0.3.0\n\n\tCopyright 2018 Julian Lloyd.\n\n\tPermission is hereby granted, free of charge, to any person obtaining a copy\n\tof this software and associated documentation files (the \"Software\"), to deal\n\tin the Software without restriction, including without limitation the rights\n\tto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\tcopies of the Software, and to permit persons to whom the Software is\n\tfurnished to do so, subject to the following conditions:\n\n\tThe above copyright notice and this permission notice shall be included in\n\tall copies or substantial portions of the Software.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\tIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\tAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\tLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\tTHE SOFTWARE.\n*/\n/**\n * @module Rematrix\n */\n\n/**\n * Transformation matrices in the browser come in two flavors:\n *\n *  - `matrix` using 6 values (short)\n *  - `matrix3d` using 16 values (long)\n *\n * This utility follows this [conversion guide](https://goo.gl/EJlUQ1)\n * to expand short form matrices to their equivalent long form.\n *\n * @param  {array} source - Accepts both short and long form matrices.\n * @return {array}\n */\nfunction format(source) {\n\tif (source.constructor !== Array) {\n\t\tthrow new TypeError('Expected array.')\n\t}\n\tif (source.length === 16) {\n\t\treturn source\n\t}\n\tif (source.length === 6) {\n\t\tvar matrix = identity();\n\t\tmatrix[0] = source[0];\n\t\tmatrix[1] = source[1];\n\t\tmatrix[4] = source[2];\n\t\tmatrix[5] = source[3];\n\t\tmatrix[12] = source[4];\n\t\tmatrix[13] = source[5];\n\t\treturn matrix\n\t}\n\tthrow new RangeError('Expected array with either 6 or 16 values.')\n}\n\n/**\n * Returns a matrix representing no transformation. The product of any matrix\n * multiplied by the identity matrix will be the original matrix.\n *\n * > **Tip:** Similar to how `5 * 1 === 5`, where `1` is the identity.\n *\n * @return {array}\n */\nfunction identity() {\n\tvar matrix = [];\n\tfor (var i = 0; i < 16; i++) {\n\t\ti % 5 == 0 ? matrix.push(1) : matrix.push(0);\n\t}\n\treturn matrix\n}\n\n/**\n * Returns a matrix describing the inverse transformation of the source\n * matrix. The product of any matrix multiplied by its inverse will be the\n * identity matrix.\n *\n * > **Tip:** Similar to how `5 * (1/5) === 1`, where `1/5` is the inverse.\n *\n * @param  {array} source - Accepts both short and long form matrices.\n * @return {array}\n */\nfunction inverse(source) {\n\tvar m = format(source);\n\n\tvar s0 = m[0] * m[5] - m[4] * m[1];\n\tvar s1 = m[0] * m[6] - m[4] * m[2];\n\tvar s2 = m[0] * m[7] - m[4] * m[3];\n\tvar s3 = m[1] * m[6] - m[5] * m[2];\n\tvar s4 = m[1] * m[7] - m[5] * m[3];\n\tvar s5 = m[2] * m[7] - m[6] * m[3];\n\n\tvar c5 = m[10] * m[15] - m[14] * m[11];\n\tvar c4 = m[9] * m[15] - m[13] * m[11];\n\tvar c3 = m[9] * m[14] - m[13] * m[10];\n\tvar c2 = m[8] * m[15] - m[12] * m[11];\n\tvar c1 = m[8] * m[14] - m[12] * m[10];\n\tvar c0 = m[8] * m[13] - m[12] * m[9];\n\n\tvar determinant = 1 / (s0 * c5 - s1 * c4 + s2 * c3 + s3 * c2 - s4 * c1 + s5 * c0);\n\n\tif (isNaN(determinant) || determinant === Infinity) {\n\t\tthrow new Error('Inverse determinant attempted to divide by zero.')\n\t}\n\n\treturn [\n\t\t(m[5] * c5 - m[6] * c4 + m[7] * c3) * determinant,\n\t\t(-m[1] * c5 + m[2] * c4 - m[3] * c3) * determinant,\n\t\t(m[13] * s5 - m[14] * s4 + m[15] * s3) * determinant,\n\t\t(-m[9] * s5 + m[10] * s4 - m[11] * s3) * determinant,\n\n\t\t(-m[4] * c5 + m[6] * c2 - m[7] * c1) * determinant,\n\t\t(m[0] * c5 - m[2] * c2 + m[3] * c1) * determinant,\n\t\t(-m[12] * s5 + m[14] * s2 - m[15] * s1) * determinant,\n\t\t(m[8] * s5 - m[10] * s2 + m[11] * s1) * determinant,\n\n\t\t(m[4] * c4 - m[5] * c2 + m[7] * c0) * determinant,\n\t\t(-m[0] * c4 + m[1] * c2 - m[3] * c0) * determinant,\n\t\t(m[12] * s4 - m[13] * s2 + m[15] * s0) * determinant,\n\t\t(-m[8] * s4 + m[9] * s2 - m[11] * s0) * determinant,\n\n\t\t(-m[4] * c3 + m[5] * c1 - m[6] * c0) * determinant,\n\t\t(m[0] * c3 - m[1] * c1 + m[2] * c0) * determinant,\n\t\t(-m[12] * s3 + m[13] * s1 - m[14] * s0) * determinant,\n\t\t(m[8] * s3 - m[9] * s1 + m[10] * s0) * determinant\n\t]\n}\n\n/**\n * Returns a 4x4 matrix describing the combined transformations\n * of both arguments.\n *\n * > **Note:** Order is very important. For example, rotating 45°\n * along the Z-axis, followed by translating 500 pixels along the\n * Y-axis... is not the same as translating 500 pixels along the\n * Y-axis, followed by rotating 45° along on the Z-axis.\n *\n * @param  {array} m - Accepts both short and long form matrices.\n * @param  {array} x - Accepts both short and long form matrices.\n * @return {array}\n */\nfunction multiply(m, x) {\n\tvar fm = format(m);\n\tvar fx = format(x);\n\tvar product = [];\n\n\tfor (var i = 0; i < 4; i++) {\n\t\tvar row = [fm[i], fm[i + 4], fm[i + 8], fm[i + 12]];\n\t\tfor (var j = 0; j < 4; j++) {\n\t\t\tvar k = j * 4;\n\t\t\tvar col = [fx[k], fx[k + 1], fx[k + 2], fx[k + 3]];\n\t\t\tvar result =\n\t\t\t\trow[0] * col[0] + row[1] * col[1] + row[2] * col[2] + row[3] * col[3];\n\n\t\t\tproduct[i + k] = result;\n\t\t}\n\t}\n\n\treturn product\n}\n\n/**\n * Attempts to return a 4x4 matrix describing the CSS transform\n * matrix passed in, but will return the identity matrix as a\n * fallback.\n *\n * > **Tip:** This method is used to convert a CSS matrix (retrieved as a\n * `string` from computed styles) to its equivalent array format.\n *\n * @param  {string} source - `matrix` or `matrix3d` CSS Transform value.\n * @return {array}\n */\nfunction parse(source) {\n\tif (typeof source === 'string') {\n\t\tvar match = source.match(/matrix(3d)?\\(([^)]+)\\)/);\n\t\tif (match) {\n\t\t\tvar raw = match[2].split(', ').map(parseFloat);\n\t\t\treturn format(raw)\n\t\t}\n\t}\n\treturn identity()\n}\n\n/**\n * Returns a 4x4 matrix describing Z-axis rotation.\n *\n * > **Tip:** This is just an alias for `Rematrix.rotateZ` for parity with CSS\n *\n * @param  {number} angle - Measured in degrees.\n * @return {array}\n */\nfunction rotate(angle) {\n\treturn rotateZ(angle)\n}\n\n/**\n * Returns a 4x4 matrix describing X-axis rotation.\n *\n * @param  {number} angle - Measured in degrees.\n * @return {array}\n */\nfunction rotateX(angle) {\n\tvar theta = Math.PI / 180 * angle;\n\tvar matrix = identity();\n\n\tmatrix[5] = matrix[10] = Math.cos(theta);\n\tmatrix[6] = matrix[9] = Math.sin(theta);\n\tmatrix[9] *= -1;\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Y-axis rotation.\n *\n * @param  {number} angle - Measured in degrees.\n * @return {array}\n */\nfunction rotateY(angle) {\n\tvar theta = Math.PI / 180 * angle;\n\tvar matrix = identity();\n\n\tmatrix[0] = matrix[10] = Math.cos(theta);\n\tmatrix[2] = matrix[8] = Math.sin(theta);\n\tmatrix[2] *= -1;\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Z-axis rotation.\n *\n * @param  {number} angle - Measured in degrees.\n * @return {array}\n */\nfunction rotateZ(angle) {\n\tvar theta = Math.PI / 180 * angle;\n\tvar matrix = identity();\n\n\tmatrix[0] = matrix[5] = Math.cos(theta);\n\tmatrix[1] = matrix[4] = Math.sin(theta);\n\tmatrix[4] *= -1;\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing 2D scaling. The first argument\n * is used for both X and Y-axis scaling, unless an optional\n * second argument is provided to explicitly define Y-axis scaling.\n *\n * @param  {number} scalar    - Decimal multiplier.\n * @param  {number} [scalarY] - Decimal multiplier.\n * @return {array}\n */\nfunction scale(scalar, scalarY) {\n\tvar matrix = identity();\n\n\tmatrix[0] = scalar;\n\tmatrix[5] = typeof scalarY === 'number' ? scalarY : scalar;\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing X-axis scaling.\n *\n * @param  {number} scalar - Decimal multiplier.\n * @return {array}\n */\nfunction scaleX(scalar) {\n\tvar matrix = identity();\n\tmatrix[0] = scalar;\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Y-axis scaling.\n *\n * @param  {number} scalar - Decimal multiplier.\n * @return {array}\n */\nfunction scaleY(scalar) {\n\tvar matrix = identity();\n\tmatrix[5] = scalar;\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Z-axis scaling.\n *\n * @param  {number} scalar - Decimal multiplier.\n * @return {array}\n */\nfunction scaleZ(scalar) {\n\tvar matrix = identity();\n\tmatrix[10] = scalar;\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing shear. The first argument\n * defines X-axis shearing, and an optional second argument\n * defines Y-axis shearing.\n *\n * @param  {number} angleX   - Measured in degrees.\n * @param  {number} [angleY] - Measured in degrees.\n * @return {array}\n */\nfunction skew(angleX, angleY) {\n\tvar thetaX = Math.PI / 180 * angleX;\n\tvar matrix = identity();\n\n\tmatrix[4] = Math.tan(thetaX);\n\n\tif (angleY) {\n\t\tvar thetaY = Math.PI / 180 * angleY;\n\t\tmatrix[1] = Math.tan(thetaY);\n\t}\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing X-axis shear.\n *\n * @param  {number} angle - Measured in degrees.\n * @return {array}\n */\nfunction skewX(angle) {\n\tvar theta = Math.PI / 180 * angle;\n\tvar matrix = identity();\n\n\tmatrix[4] = Math.tan(theta);\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Y-axis shear.\n *\n * @param  {number} angle - Measured in degrees\n * @return {array}\n */\nfunction skewY(angle) {\n\tvar theta = Math.PI / 180 * angle;\n\tvar matrix = identity();\n\n\tmatrix[1] = Math.tan(theta);\n\n\treturn matrix\n}\n\n/**\n * Returns a CSS Transform property value equivalent to the source matrix.\n *\n * @param  {array} source - Accepts both short and long form matrices.\n * @return {string}\n */\nfunction toString(source) {\n\treturn (\"matrix3d(\" + (format(source).join(', ')) + \")\")\n}\n\n/**\n * Returns a 4x4 matrix describing 2D translation. The first\n * argument defines X-axis translation, and an optional second\n * argument defines Y-axis translation.\n *\n * @param  {number} distanceX   - Measured in pixels.\n * @param  {number} [distanceY] - Measured in pixels.\n * @return {array}\n */\nfunction translate(distanceX, distanceY) {\n\tvar matrix = identity();\n\tmatrix[12] = distanceX;\n\n\tif (distanceY) {\n\t\tmatrix[13] = distanceY;\n\t}\n\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing X-axis translation.\n *\n * @param  {number} distance - Measured in pixels.\n * @return {array}\n */\nfunction translateX(distance) {\n\tvar matrix = identity();\n\tmatrix[12] = distance;\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Y-axis translation.\n *\n * @param  {number} distance - Measured in pixels.\n * @return {array}\n */\nfunction translateY(distance) {\n\tvar matrix = identity();\n\tmatrix[13] = distance;\n\treturn matrix\n}\n\n/**\n * Returns a 4x4 matrix describing Z-axis translation.\n *\n * @param  {number} distance - Measured in pixels.\n * @return {array}\n */\nfunction translateZ(distance) {\n\tvar matrix = identity();\n\tmatrix[14] = distance;\n\treturn matrix\n}\n\nexport { format, identity, inverse, multiply, parse, rotate, rotateX, rotateY, rotateZ, scale, scaleX, scaleY, scaleZ, skew, skewX, skewY, toString, translate, translateX, translateY, translateZ };\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/rematrix/dist/rematrix.es.js","import { CSS_NAMESPACE } from './constants';\nimport { createElement } from './utils';\n\nexport default class CanvasWorkspace {\n\tconstructor() {\n\t\tthis.element = createElement( {\n\t\t\ttagName: 'canvas',\n\t\t\tclassName: `${CSS_NAMESPACE}__canvas-workspace`\n\t\t} );\n\t}\n\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\n\t// TODO: at the moment we're calling this after every image transformation\n\t// in fact, because we're keeping track of the transforms, we don't need to call it at all until the end\n\t// it's just for the preview\n\tdrawImage( { imageObj, canvasWidth, canvasHeight, imageX, imageY, imageWidth, imageHeight, drawX, drawY, drawWidth, drawHeight } ) {\n\n\t\tthis.element.width = canvasWidth;\n\t\tthis.element.height = canvasHeight;\n\n\n\t\tconst context = this.element.getContext( '2d' );\n\t\tcontext.clearRect( 0, 0, this.element.width, this.element.height );\n\t\tcontext.save();\n\n\n\n\n\t\t// now draw!\n\t\tcontext.drawImage(\n\t\t\timageObj,\n\t\t\t// x, y coordinate of the top left corner of the sub-rectangle of the source image to draw into the destination context.\n\t\t\timageX, imageY,\n\t\t\t// w and h of the sub-rectangle of the source image to draw into the destination context.\n\t\t\timageWidth, imageHeight,\n\t\t\t// x, y coordinates in the destination canvas at which to place the top-left corner of the source image.\n\t\t\tdrawX, drawY,\n\t\t\t// w and h of the image in the destination canvas. Changing these values scales the sub-rectangle in the destination context.\n\t\t\tdrawWidth, drawHeight\n\t\t);\n\n\t\tcontext.restore();\n\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/canvas-workspace.js","import {\n\tnoop,\n\tcreateElement,\n\tcalculateAspectRatioFit,\n\tgetRadianFromDegrees,\n\taddClass,\n\thasClass,\n\tremoveClass,\n\tgetMousePosition ,\n\tgetOffsetRelativeToParent,\n\tcreateTransformMatrix,\n\tgetOriginalCoordinatesFromTransformedMatrix } from './utils';\nimport {\n\tCSS_NAMESPACE,\n\tIMAGE_ALT_TEXT,\n\tACTIVE_CLASS,\n\tEDITOR_GUTTER,\n\tDEBUG,\n} from './constants';\n\nexport default class CropContainer {\n\n\tconstructor( { appContainer, imageObj, canvasWorkspace, onWorkSpaceUpdated } ) {\n\t\tthis.state = {\n\t\t\t// maximum dimensions of the crop tool\n\t\t\t// crop rectangle cannot be bigger than these values\n\t\t\t// update with viewport size * aspect ratio\n\t\t\tmaxDimensions: {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0\n\t\t\t},\n\t\t\t// minimum dimensions of the crop tool\n\t\t\t// crop rectangle cannot be smaller than these values\n\t\t\t// update with aspect ratio\n\t\t\tminDimensions: {\n\t\t\t\twidth: 50,\n\t\t\t\theight: 50\n\t\t\t},\n\t\t\timageCoords: {\n\t\t\t\ttop: 0,\n\t\t\t\tright: 0,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\t// current position of the crop rectangle\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: 0,\n\t\t\t// current dimensions\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\t// flag to tell the world that the crop container has been resized\n\t\t\tinitialized: false,\n\t\t};\n\n\n\t\tthis.appContainer = appContainer;\n\t\tthis.imageObj = imageObj;\n\t\tthis.canvasWorkspace = canvasWorkspace;\n\n\t\t// callbacks\n\t\tthis.onWorkSpaceUpdated = onWorkSpaceUpdated;\n\n\t\tthis.onStartDragCropArea = this.onStartDragCropArea.bind( this );\n\t\t// this.onDragCropArea = this.onDragCropArea.bind( this );\n\t\t// this.onStopDragCropArea = this.onStopDragCropArea.bind( this );\n\t\tthis.onStartCropResize = this.onStartCropResize.bind( this );\n\t\tthis.onCropResize = this.onCropResize.bind( this );\n\t\tthis.onStopCropResize = this.onStopCropResize.bind( this );\n\t\tthis.dragging = false;\n\t\tthis.element = createElement( {\n\t\t\ttagName: 'div',\n\t\t\tclassName: `${CSS_NAMESPACE}__crop-container`,\n\t\t\t'aria-label': 'Cropping area',\n\t\t\tchildren : [\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${CSS_NAMESPACE}__draggable-corner-nw`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${CSS_NAMESPACE}__draggable-corner-ne`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${CSS_NAMESPACE}__draggable-corner-sw`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${CSS_NAMESPACE}__draggable-corner-se`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'span',\n\t\t\t\t\tclassName: `image-editor__guide ${CSS_NAMESPACE}__guide-horiz-top`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'span',\n\t\t\t\t\tclassName: `image-editor__guide ${CSS_NAMESPACE}__guide-horiz-bottom`\n\t\t\t\t} ],\n\t\t} );\n\n\t\t// add event listeners for dragging\n\t\t// TODO: add helper for multiple event handlers\n\t\tthis.element.addEventListener( 'mousedown', this.onStartDragCropArea );\n\t\tthis.element.addEventListener( 'touchstart', this.onStartDragCropArea, { passive: true } );\n\n\t}\n\n\tgetElement() {\n\t\treturn this.element;\n\t}\n\n\tgetState() {\n\t\treturn this.state;\n\t}\n\n\tupdate( { top, left, width, height, maxWidth, maxHeight, imageCoords } ) {\n/*\t\tthis.element.width = anotherScaleRatio.width > this.imageObj.width ? this.imageObj.width : anotherScaleRatio.width;\n\t\tthis.element.height = anotherScaleRatio.height > this.imageObj.height ? this.imageObj.height : anotherScaleRatio.height;\t*/\n\n\t\t// console.log( 'update( { top, left, width, height } )', top, left, width, height );\n\n\t\tthis.element.width = width;\n\t\tthis.element.height = height;\n\n\t\tthis.element.style.left = `${ left }px`;\n\t\tthis.element.style.top = `${ top }px`;\n\t\tthis.element.style.width = `${ width }px`;\n\t\tthis.element.style.height = `${ height }px`;\n\n\t\tthis.state = {\n\t\t\t...this.state,\n\t\t\tmaxDimensions: {\n\t\t\t\twidth: maxWidth,\n\t\t\t\theight: maxHeight,\n\t\t\t},\n\t\t\twidth,\n\t\t\theight,\n\t\t\ttop,\n\t\t\tleft,\n\t\t\timageCoords\n\t\t};\n\n\t}\n\n\t/*\n\n\t onStartDragCropArea - main event delegator\n\t Since all the interaction takes place on the cropArea,\n\t we don't need to assign multiple events to each drag handle and so on\n\n\t */\n\tonStartDragCropArea( event ) {\n\n\t\tevent.preventDefault();\n\t\taddClass( this.element, ACTIVE_CLASS );\n\t\t// if we've hit a drag handle, stop propagation\n\t\t// and throw the event to the crop resize setup method\n\t\tif  ( hasClass( event.target, `${ CSS_NAMESPACE }__draggable-corner` ) ) {\n\t\t\tevent.stopImmediatePropagation();\n\t\t\t// remove css transitions to avoid mouse delay\n\t\t\t// this.cropAreaContainer.style.transition = 'unset';\n\t\t\t// this.image.style.transition = 'unset';\n\t\t\t// cache the event\n\t\t\tthis.cropEvent = event;\n\t\t\tthis.onStartCropResize( event );\n\t\t\treturn false;\n\t\t}\n\t\t// otherwise we're free to drag the image\n\t\t// TODO abstract this out to a separate method\n\t\t// this.dragging = true;\n\t\t// this.mousePos = getMousePosition( event, this.appContainer );\n\t\t// this.state.left = this.mousePos.x;\n\t\t// this.state.top = this.mousePos.y;\n\n\n\t}\n\n\tonStartCropResize ( event ) {\n\n\t\tthis.dragging = true;\n\n\t\tevent.preventDefault();\n\n\t\tdocument.addEventListener( 'touchmove', this.onCropResize );\n\t\tdocument.addEventListener( 'touchend', this.onStopCropResize );\n\t\tdocument.addEventListener( 'mousemove', this.onCropResize );\n\t\tdocument.addEventListener( 'mouseup', this.onStopCropResize );\n\n\t\tthis.mousePos = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\t}\n\n\n\tonCropResize ( event ) {\n\t\tevent.preventDefault();\n\t\tthis.mousePos = getMousePosition( event, this.appContainer );\n\t\t// first check the mouse boundaries\n\t\t// now calculate the new dimensions of the crop area\n\t\tlet width, height, left, top, right, bottom, imageX, imageY, drawX, drawY, drawWidth, drawHeight, imageWidth, imageHeight, ignoreResize;\n\t\t\n\t\tconst imageAspectRatio = calculateAspectRatioFit(\n\t\t\tthis.imageObj.naturalWidth,\n\t\t\tthis.imageObj.naturalHeight,\n\t\t\tthis.appContainer.offsetWidth,\n\t\t\tthis.appContainer.offsetHeight,\n\t\t\tfalse,\n\t\t\t1 );\n\n\t\t\n\t\tif ( this.mousePos.x <= this.state.imageCoords.left || \n\t\t\tthis.mousePos.x >= this.state.imageCoords.right || \n\t\t\tthis.mousePos.y <= this.state.imageCoords.top || \n\t\t\tthis.mousePos.y >= this.state.imageCoords.bottom ) {\n\t\t\tignoreResize = true;\n\t\t}\n\t\t\n\t\tif ( this.cropEvent.target.classList.contains( `${CSS_NAMESPACE}__draggable-corner-se` ) ) {\n\t\t\tconsole.log( 'se drag', '');\n\t\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\t//this.image.transform.origin = [ 'left', 'top' ];\n\n\t\t\twidth  = this.mousePos.x - this.state.left;\n\t\t\theight = this.mousePos.y - this.state.top;\n\t\t\tleft = this.state.left;\n\t\t\ttop = this.state.top;\n\t\t\tright = left + width;\n\t\t\tbottom = top + height;\n\n\t\t\tif ( right >= this.state.imageCoords.right ) {\n\t\t\t\twidth = this.state.imageCoords.right - left;\n\t\t\t}\n\t\t\tif ( bottom >= this.state.imageCoords.bottom ) {\n\t\t\t\theight = this.state.imageCoords.bottom - top;\n\t\t\t}\n\t\t\tif ( ( this.constrain || event.shiftKey) ) {\n\t\t\t\theight = width / this.imageObj.width * this.imageObj.height;\n\t\t\t\twidth = height / this.imageObj.height * this.imageObj.width;\n\t\t\t\t// left = this.state.left + this.state.width - width;\n\n\t\t\t\tbottom = bottom <= this.state.imageCoords.bottom ? this.state.imageCoords.bottom : this.mousePos.y;\n\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${CSS_NAMESPACE}__draggable-corner-sw` ) ) {\n\t\t\tconsole.log( 'sw drag', '');\n\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\t//this.image.transform.origin = [ 'right', 'top' ];\n\n\n\t\t\twidth  = this.state.width - ( this.mousePos.x - this.state.left );\n\t\t\tleft = this.mousePos.x;\n\t\t\theight = this.mousePos.y - this.state.top;\n\t\t\ttop = this.state.top;\n\t\t\tbottom = top + height;\n\n\n\t\t\tif ( width <= this.state.minDimensions.width && left < this.state.imageCoords.right - this.state.minDimensions.width ) {\n\t\t\t\tleft = this.state.left + this.state.width - this.state.minDimensions.width;\n\t\t\t\twidth = this.state.minDimensions.width;\n\t\t\t}\n\n\t\t\tif ( left >= this.state.imageCoords.right - this.state.minDimensions.width ) {\n\t\t\t\tleft = this.state.left + this.state.width - this.state.minDimensions.width;\n\n\t\t\t}\n\n\t\t\tif ( bottom >= this.state.imageCoords.bottom ) {\n\t\t\t\theight = this.state.imageCoords.bottom - top;\n\t\t\t}\n\n\t\t\tif ( left <= this.state.imageCoords.left ) {\n\t\t\t\tleft = this.state.imageCoords.left;\n\t\t\t\twidth = this.state.width + ( this.state.left - this.state.imageCoords.left );\n\n\t\t\t}\n\t\t\tif ( (this.constrain || event.shiftKey)) {\n\t\t\t\theight = width / this.imageObj.width * this.imageObj.height;\n\t\t\t\twidth = height / this.imageObj.height * this.imageObj.width;\n\t\t\t\tleft = this.state.left + this.state.width - width;\n\t\t\t\tbottom = bottom <= this.state.imageCoords.bottom ? this.state.imageCoords.bottom : this.mousePos.y;\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${CSS_NAMESPACE}__draggable-corner-nw` ) ) {\n\t\t\tconsole.log( 'nw drag', '');\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\t//this.image.transform.origin = [ 'right', 'bottom' ];\n\n\t\t\twidth = this.state.width - ( this.mousePos.x - this.state.left );\n\t\t\theight = this.state.height - ( this.mousePos.y - this.state.top );\n\t\t\tleft = this.mousePos.x;\n\t\t\ttop = this.mousePos.y;\n\n\n\t\t\tif ( width <= this.state.minDimensions.width && left < this.state.imageCoords.right - this.state.minDimensions.width ) {\n\t\t\t\tleft = this.state.left + this.state.width - this.state.minDimensions.width;\n\t\t\t\twidth = this.state.minDimensions.width;\n\t\t\t}\n\n\t\t\tif ( left >= this.state.imageCoords.right - this.state.minDimensions.width ) {\n\t\t\t\tleft = this.state.left + this.state.width - this.state.minDimensions.width;\n\n\t\t\t}\n\n\t\t\tif ( left <= this.state.imageCoords.left ) {\n\t\t\t\tleft = this.state.imageCoords.left;\n\t\t\t\twidth = this.state.width + ( this.state.left - this.state.imageCoords.left );\n\n\n\t\t\t}\n\n\t\t\tif ( top <= this.state.imageCoords.top ) {\n\t\t\t\ttop = this.state.imageCoords.top;\n\t\t\t\theight = this.state.bottom - top;\n\n\t\t\t}\n\n\t\t\tif ( height <= this.state.minDimensions.height && top > this.state.imageCoords.top ) {\n\t\t\t\theight = this.state.minDimensions.height;\n\t\t\t\ttop = this.state.top + this.state.height - this.state.minDimensions.height;\n\n\t\t\t}\n\n\n\t\t\tif ( (this.constrain || event.shiftKey)) {\n\t\t\t\theight = width / this.imageObj.width * this.imageObj.height;\n\t\t\t\twidth = height / this.imageObj.height * this.imageObj.width;\n\t\t\t\tleft = this.state.left + this.state.width - width;\n\t\t\t\ttop = this.state.top + this.state.height - height;\n\t\t\t}\n\n\n\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${CSS_NAMESPACE}__draggable-corner-ne` ) ) {\n\t\t\tconsole.log( 'ne drag', '');\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\t//this.image.transform.origin = [ 'left', 'bottom' ];\n\n\t\t\twidth = ( this.mousePos.x - this.state.left );\n\t\t\theight = this.state.height - ( this.mousePos.y - this.state.top );\n\t\t\tleft = this.state.left;\n\t\t\ttop = this.mousePos.y;\n\t\t\tright = left + width;\n\n\n\t\t\tif ( height <= this.state.minDimensions.height ) {\n\t\t\t\theight = this.state.minDimensions.height;\n\t\t\t\ttop = this.state.top + this.state.height - this.state.minDimensions.height;\n\t\t\t}\n\t\t\tif ( top <= this.state.imageCoords.top ) {\n\t\t\t\ttop = this.state.imageCoords.top;\n\t\t\t\theight = this.state.bottom - top;\n\t\t\t}\n\t\t\tif ( right >= this.state.imageCoords.right ) {\n\t\t\t\twidth = this.state.imageCoords.right - left;\n\t\t\t}\n\t\t\tif ( bottom >= this.state.imageCoords.bottom ) {\n\t\t\t\theight = this.state.imageCoords.bottom - top;\n\t\t\t}\n\t\t\tif ( this.constrain || event.shiftKey ) {\n\t\t\t\twidth = height / this.imageObj.height * this.imageObj.width;\n\t\t\t}\n\n\t\t}\n\n\t\t// all this is about ensuring there is no 'sticking' at the extremes\n\t\theight = isNaN(height) ? this.state.height : height;\n\t\theight = height >= this.state.maxDimensions.height ? this.state.maxDimensions.height : height;\n\t\theight = height <= this.state.minDimensions.height ? this.state.minDimensions.height : height;\n\t\twidth = width >= this.state.maxDimensions.width ? this.state.maxDimensions.width : width;\n\t\twidth = width <= this.state.minDimensions.width ? this.state.minDimensions.width : width;\n\n\t\t\n\n\n\n\t\t// left = left >= this.state.right - this.state.minDimensions.width\n\t\t// \t? this.state.right - this.state.minDimensions.width : left;\n\t\t//\n\t\t// left = left <= this.state.left ? this.state.left : left;\n\t\t//\n\t\t// top = top >= this.state.maxDimensions.height - this.state.minDimensions.height\n\t\t// \t? this.state.maxDimensions.height - this.state.minDimensions.height : top;\n\t\t// top = (top <= this.state.top || isNaN(top)) ? this.state.top : top;\n\n\n\n\t\tconst appContainerCenterX = this.appContainer.offsetWidth / 2;\n\t\tconst appContainerCenterY = this.appContainer.offsetHeight / 2;\n\t\tconst imageLeft = appContainerCenterX - ( this.imageObj.width / 2 );\n\t\tconst imageTop = appContainerCenterY - ( this.imageObj.height / 2 );\n\n\n\n\n\t\timageX = 0 + ( ( left - imageLeft ) / imageAspectRatio.ratio );\n\t\timageY = 0 + ( ( top - imageTop ) / imageAspectRatio.ratio );\n\n\t\timageWidth = width / imageAspectRatio.ratio;\n\t\timageHeight = height / imageAspectRatio.ratio;\n\t\tdrawX = left;\n\t\tdrawY = top;\n\t\tdrawWidth = width;\n\t\tdrawHeight = height;\n\n\t\t//console.log( 'imageX, imageY, imageWidth, imageHeight, drawX, drawY, drawWidth, drawHeight', imageX, imageY, imageWidth, imageHeight, drawX, drawY, drawWidth, drawHeight );\n\n\t\tthis.canvasWorkspace.drawImage( {\n\t\t\timageObj: this.imageObj,\n\t\t\tcanvasWidth: this.appContainer.offsetWidth,\n\t\t\tcanvasHeight: this.appContainer.offsetHeight,\n\t\t\timageX,\n\t\t\timageY,\n\t\t\timageWidth,\n\t\t\timageHeight,\n\t\t\tdrawWidth,\n\t\t\tdrawHeight,\n\t\t\tdrawX,\n\t\t\tdrawY,\n\t\t} );\n\n\t\tthis.state.left = left;\n\t\tthis.element.style.left = `${ this.state.left  }px`;\n\n\t\tthis.state.width = width;\n\t\tthis.element.style.width = `${ this.state.width }px`;\n\n\t\tthis.state.height = height;\n\t\tthis.element.style.height = `${ this.state.height }px`;\n\n\t\tthis.state.top = top;\n\t\tthis.element.style.top = `${ this.state.top }px`;\n\n\t\tthis.state.bottom = this.state.top + height;\n\t\tthis.state.right = this.state.left + width;\n\t\tthis.cropActionTriggered = true;\n\n\n\t\tif ( DEBUG ) {\n\t\t\tthis.onWorkSpaceUpdated( {\n\t\t\t\t...this.getState()\n\t\t\t} );\n\t\t}\n\t\tthis.state.initialized = true;\n\t\treturn false;\n\n\t}\n\n\tonStopCropResize () {\n\n\t\tthis.dragging = false;\n\t\tthis.mousePos = null;\n\t\tthis.cropEvent = null;\n\t\tremoveClass( this.element, ACTIVE_CLASS );\n\t\tdocument.removeEventListener( 'mousemove', this.onCropResize );\n\t\tdocument.removeEventListener( 'mouseup', this.onStopCropResize );\n\t\tdocument.removeEventListener( 'touchmove', this.onCropResize );\n\t\tdocument.removeEventListener( 'touchend', this.onStopCropResize );\n\n\t\t// this.cropAreaContainer.style.transition = 'all 0.09s linear';\n\t\t// this.image.style.transition = 'transform 0.1s linear';\n\n\t\tif (!this.cropActionTriggered) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.cropActionTriggered = false;\n\t\tthis.state.scale = {\n\t\t\twidth: this.state.width / this.imageObj.width,\n\t\t\theight: this.state.height / this.imageObj.height,\n\t\t\ttop: this.state.top / this.imageObj.height,\n\t\t\tleft: this.state.left / this.imageObj.width\n\t\t};\n\n\n\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/crop-container.js"],"sourceRoot":""}