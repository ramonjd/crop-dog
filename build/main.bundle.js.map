{"version":3,"sources":["webpack:///webpack/bootstrap f06e77cd2f89b55ac10b","webpack:///./src/index.js","webpack:///./src/editor.js","webpack:///./src/utils.js"],"names":["window","imageEditor","imagePath","imageAltText","onWorkSpaceUpdated","document","querySelector","state","template","original","width","height","cropped","maxDimensions","rotated","innerHTML","NAMESPACE","IMAGE_ALT_TEXT","ACTIVE_CLASS","EDITOR_GUTTER","DEBUG","Editor","props","container","image","transform","ratio","translateX","translateY","degrees","radians","origin","position","left","top","drag","startX","startY","dx","dy","maxRatio","croppingArea","minDimensions","right","bottom","delta","touched","boundary","constrain","outerContainer","onImageLoaded","bind","updateWorkspace","onWindowResize","onStartDragCropArea","onStartCropResize","onCropResize","onStopCropResize","fragment","createDocumentFragment","imageObj","Image","setAttribute","className","onload","onerror","imageObjClone","cloneNode","canvasWorkspace","tagName","cropAreaContainer","children","imageEditorWorkspace","imageEditorContainer","addEventListener","passive","dragging","appendChild","dragRequestId","resizing","cropActionTriggered","frameRateInterval","requestAnimationFrameId","lastTimestamp","transformMatrices","transformMatrix","inverseTransformMatrix","src","performance","now","setTimeout","requestAnimationFrame","event","preventDefault","target","stopImmediatePropagation","cropEvent","mousePos","x","y","classList","contains","shiftKey","isNaN","style","naturalWidth","naturalHeight","removeEventListener","scale","zoomInImage","timestamp","elapsedTime","offsetWidth","offsetHeight","scaleRatio","anotherScaleRatio","outerContainerCenterX","outerContainerCenterY","newPositionX","newPositionY","Object","assign","noop","throttle","createElement","getOffsetRelativeToParent","getCenterPositionRelativeToParent","getMousePosition","calculateAspectRatioFit","calculateOriginalDimensionsFromScaled","transformCSS","getRadianFromDegrees","getDegreesFromRadians","regExp","hasClass","removeClass","addClass","createTransformMatrix","getOriginalCoordinatesFromTransformedMatrix","Function","prototype","type","name","obj","running","func","throttledRequestAnimationFrame","dispatchEvent","CustomEvent","options","element","attributes","attr","text","createTextNode","length","i","childrenLength","HTMLElement","childCssSelector","parentCssSelector","childElem","parentElem","Error","childRect","getBoundingClientRect","parentRect","childElement","parentElement","contextElement","offsetLeft","pageXOffset","offsetTop","pageYOffset","pageX","touches","pageY","srcWidth","srcHeight","maxWidth","maxHeight","gutter","aspectRatio","Math","min","floor","scaledWidth","scaledHeight","PI","RegExp","Element","test","replace","remove","add","rotate","cos","sin","cross","xx","yy"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f06e77cd2f89b55ac10b","import Editor from './editor';\n\nwindow.imageEditor = new Editor(\n    {\n        imagePath: 'http://localhost:8888/src/amsler.jpg',\n        imageAltText: 'A village after dark',\n        onWorkSpaceUpdated\n    },\n    document.querySelector( '.media-image-editor__canvas-container' )\n);\n\n\n// DEBUG\nfunction onWorkSpaceUpdated( state ) {\n    //const croppedImageObj = document.querySelector( '.media-image-editor_debug__preview-container img' );\n    //const croppedImageAtag = document.querySelector( '.media-image-editor_debug__preview-container a' );\n    //const previewImage = newImageEditorState.canvas.toDataURL('image/jpeg', 0.8 );\n    //croppedImageObj.src = previewImage;\n    //croppedImageObj.width = newImageEditorState.cropped.width;\n    //croppedImageObj.height = newImageEditorState.cropped.height;\n    //croppedImageAtag.href = previewImage;\n\n    const template = `\n        <li>\n            <var>Original image dimensions</var>\n            <samp>\n                ${ state.original.width }\n                x ${ state.original.height }\n            </samp>\n        </li>\n          <li>\n            <var>Scaled image dimensions</var>\n            <samp>\n                ${ state.cropped.maxDimensions.width }\n                x ${ state.cropped.maxDimensions.height }\n            </samp>\n        </li>\n        <li>\n            <var>Cropped dimensions</var>\n            <samp>\n                ${state.cropped.width} x ${state.cropped.height}\n            </samp>\n        </li>\n        <li><var>Cropped coordinates</var> <samp>TBD</samp></li>\n\n        <li><var>Rotated</var> <samp>${ state.cropped.rotated }</samp></li>\n\n        <li><var>Ratio to original image</var> <samp>TBD</samp></li>\n    `;\n\n    document.querySelector( '.media-image-editor_debug-values ul' ).innerHTML = template;\n\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import {\n\tnoop,\n\tcreateElement,\n\tcalculateAspectRatioFit,\n\tgetRadianFromDegrees,\n\taddClass,\n\thasClass,\n\tremoveClass,\n\tgetMousePosition ,\n\tgetOffsetRelativeToParent,\n\tcreateTransformMatrix,\n\tgetOriginalCoordinatesFromTransformedMatrix } from './utils';\n\nconst NAMESPACE = 'image-editor';\nconst IMAGE_ALT_TEXT = 'Image being edited';\nconst ACTIVE_CLASS = 'image-editor__active';\nconst EDITOR_GUTTER = .7;\nconst DEBUG = true;\n\n\nexport default class Editor {\n\n\tconstructor( props, container ) {\n\n\t\t// cache of computed image properties\n\t\tthis.image = {\n\t\t\ttransform: {\n\t\t\t\tratio: 0,\n\t\t\t\ttranslateX: 0,\n\t\t\t\ttranslateY: 0,\n\t\t\t\tdegrees: 0,\n\t\t\t\tradians: getRadianFromDegrees( 0 ),\n\t\t\t\torigin: [ 'center', 'center' ]\n\t\t\t},\n\t\t\t// this will contain the last offset position of the image\n\t\t\t// calculated from traslated origin\n\t\t\tposition: {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t},\n\t\t\trotated: false,\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tdrag: {\n\t\t\t\tstartX:0,\n\t\t\t\tstartY:0,\n\t\t\t\tdx: 0,\n\t\t\t\tdy: 0\n\t\t\t},\n\t\t\tmaxRatio: 20\n\t\t};\n\n\t\t// the crop tool\n\t\tthis.croppingArea = {\n\t\t\t// maximum dimensions of the crop tool\n\t\t\t// crop rectangle cannot be bigger than these values\n\t\t\t// update with viewport size * aspect ratio\n\t\t\tmaxDimensions: {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0\n\t\t\t},\n\t\t\t// minimum dimensions of the crop tool\n\t\t\t// crop rectangle cannot be smaller than these values\n\t\t\t// update with aspect ratio\n\t\t\tminDimensions: {\n\t\t\t\twidth: 50,\n\t\t\t\theight: 50\n\t\t\t},\n\t\t\t// current position of the crop rectangle\n\t\t\tposition: {\n\t\t\t\ttop: 0,\n\t\t\t\tright: 0,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\t// differences between old and new crop positions\n\t\t\tdelta: {\n\t\t\t\ttop: 0,\n\t\t\t\tright: 0,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\t// current dimensions\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\ttouched: false,\n\t\t\tboundary: {\n\t\t\t\ttop: 0,\n\t\t\t\tright: 0,\n\t\t\t\tbottom: 0,\n\t\t\t\tleft: 0\n\t\t\t}\n\t\t};\n\n\t\tthis.constrain = false;\n\n\t\t// cache of computed this.imageEditorContainer properties\n\t\tthis.outerContainer = {\n\t\t\twidth: 0,\n\t\t\theight: 0\n\t\t};\n\n\t\t// this will be an ajax call\n\t\tthis.imagePath = props.imagePath;\n\n\t\t// append elements\n\t\tthis.container = container;\n\n\t\t// bind class methods to this\n\t\tthis.onImageLoaded = this.onImageLoaded.bind( this );\n\t\tthis.updateWorkspace = this.updateWorkspace.bind( this );\n\t\tthis.onWindowResize = this.onWindowResize.bind( this );\n\t\tthis.onStartDragCropArea = this.onStartDragCropArea.bind( this );\n\t\t// this.onDragCropArea = this.onDragCropArea.bind( this );\n\t\t// this.onStopDragCropArea = this.onStopDragCropArea.bind( this );\n\t\tthis.onStartCropResize = this.onStartCropResize.bind( this );\n\t\tthis.onCropResize = this.onCropResize.bind( this );\n\t\tthis.onStopCropResize = this.onStopCropResize.bind( this );\n\n\n\t\t// create elements\n\t\tconst fragment = document.createDocumentFragment();\n\n\t\t// the image to manipulate\n\t\tthis.imageObj = new Image();\n\t\tthis.imageObj.setAttribute('crossOrigin', 'anonymous');\n\t\tthis.imageObj.className = `${NAMESPACE}__image-layer`;\n\t\tthis.imageObj.setAttribute( 'alt', this.imageAltText || IMAGE_ALT_TEXT );\n\t\tthis.imageObj.onload = this.onImageLoaded;\n\t\tthis.imageObj.onerror = noop;\n\n\t\t// create a clone of the original image\n\t\t// so we can reset and get original props\n\t\t// container for the original image\n\t\tthis.imageObjClone = null;\n\t\tthis.imageObjClone = this.imageObj.cloneNode(true);\n\n\t\t// this is the offPage workspace\n\t\t// it takes the transformed image, and calculates the positions and ratios required to create output image\n\t\t// https://www.html5rocks.com/en/tutorials/canvas/performance/#toc-pre-render\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\n\t\tthis.canvasWorkspace = createElement( {\n\t\t\ttagName: 'canvas',\n\t\t\tclassName: `${NAMESPACE}__canvas-workspace`\n\t\t} );\n\n\t\t// this is the cropping tool\n\t\t// add the cropping tool and the canvas element\n\t\tthis.cropAreaContainer = createElement( {\n\t\t\ttagName: 'div',\n\t\t\tclassName: `${NAMESPACE}__crop-container`,\n\t\t\t'aria-label': 'Cropping area',\n\t\t\tchildren : [\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-nw`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-ne`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-sw`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'div',\n\t\t\t\t\tclassName: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-se`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'span',\n\t\t\t\t\tclassName: `image-editor__guide ${NAMESPACE}__guide-horiz-top`\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttagName: 'span',\n\t\t\t\t\tclassName: `image-editor__guide ${NAMESPACE}__guide-horiz-bottom`\n\t\t\t\t},\n\t\t\t\tthis.canvasWorkspace ]\n\n\t\t} );\n\n\t\t// this is the workspace wrapper\n\t\tthis.imageEditorWorkspace = createElement( {\n\t\t\ttagName: 'div',\n\t\t\tclassName: `${NAMESPACE}__workspace`,\n\t\t\tchildren : [ this.cropAreaContainer, this.imageObj ]\n\t\t} );\n\n\t\t// this is the main container\n\t\tthis.imageEditorContainer = createElement( {\n\t\t\ttagName: 'div',\n\t\t\tclassName: `${NAMESPACE}__container ${NAMESPACE}__container-loading`,\n\t\t\tchildren : [ this.imageEditorWorkspace ]\n\t\t} );\n\n\n\t\t// add event listeners for dragging\n\t\t// TODO: add helper for multiple event handlers\n\t\tthis.cropAreaContainer.addEventListener( 'mousedown', this.onStartDragCropArea );\n\t\tthis.cropAreaContainer.addEventListener( 'touchstart', this.onStartDragCropArea, { passive: true } );\n\n\t\t// dragging flag\n\t\tthis.dragging = false;\n\n\n\t\t// append elements\n\t\tfragment.appendChild( this.imageEditorContainer );\n\t\tthis.container.appendChild( fragment );\n\n\t\t// TODO: requestAnimationFrame to optimize constant coordinate updates\n\t\tthis.dragRequestId = null;\n\n\t\t// TODO: these flags are fairly arbitraty now\n\t\t// and are meant to solve immediate dev problems\n\t\t// need review\n\t\tthis.resizing = false;\n\t\tthis.cropActionTriggered = false;\n\n\t\tthis.frameRateInterval = 1000 / 15;\n\t\tthis.requestAnimationFrameId = null;\n\t\tthis.lastTimestamp = null;\n\n\t\t// callbacks\n\t\tthis.onWorkSpaceUpdated = props.onWorkSpaceUpdated;\n\n\t\t// transform matrix defaults\n\t\tthis.transformMatrices  = {\n\t\t\ttransformMatrix: [ 1, 0, 0, 1, 0, 0 ],\n\t\t\tinverseTransformMatrix: [ 1, 0, 0, 1 ]\n\t\t};\n\t\t// load image and prepare workspace\n\t\tthis.imageObj.src = this.imagePath;\n\n\t\treturn this;\n\n\t}\n\n\tonImageLoaded() {\n\n\n\t\t// initial update of coordinates\n\t\tthis.updateWorkspace();\n\n\t\tif ( typeof window !== 'undefined' ) {\n\t\t\tthis.lastTimestamp = window.performance.now();\n\t\t\twindow.addEventListener( 'resize', this.onWindowResize );\n\t\t}\n\n\t\t// finally, we show the workspace\n\t\t// place it on the end of the stack to ensure the update takes place first\n\t\tsetTimeout( () => {\n\t\t\tremoveClass( this.imageEditorContainer, `${NAMESPACE}__container-loading` );\n\t\t} );\n\t}\n\n\tonWindowResize() {\n\t\tthis.requestAnimationFrameId = window.requestAnimationFrame( this.updateWorkspace );\n\t}\n\n\n\t/*\n\n\t onStartDragCropArea - main event delegator\n\t Since all the interaction takes place on the cropArea,\n\t we don't need to assign multiple events to each drag handle and so on\n\n\t */\n\tonStartDragCropArea( event ) {\n\n\t\tevent.preventDefault();\n\t\taddClass( this.cropAreaContainer, ACTIVE_CLASS );\n\t\t// if we've hit a drag handle, stop propagation\n\t\t// and throw the event to the crop resize setup method\n\t\tif  ( hasClass( event.target, `${NAMESPACE}__draggable-corner` ) ) {\n\t\t\tevent.stopImmediatePropagation();\n\t\t\t// remove css transitions to avoid mouse delay\n\t\t\t// this.cropAreaContainer.style.transition = 'unset';\n\t\t\t// this.imageObj.style.transition = 'unset';\n\t\t\t// cache the event\n\t\t\tthis.cropEvent = event;\n\t\t\tthis.onStartCropResize( event );\n\t\t\treturn false;\n\t\t}\n\t\t// otherwise we're free to drag the image\n\t}\n\n\tonStartCropResize ( event ) {\n\n\t\tthis.dragging = true;\n\n\t\tevent.preventDefault();\n\n\t\tdocument.addEventListener( 'touchmove', this.onCropResize );\n\t\tdocument.addEventListener( 'touchend', this.onStopCropResize );\n\t\tdocument.addEventListener( 'mousemove', this.onCropResize );\n\t\tdocument.addEventListener( 'mouseup', this.onStopCropResize );\n\n\t\tthis.mousePos = {\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t};\n\t}\n\n\n\tonCropResize ( event ) {\n\t\tevent.preventDefault();\n\t\tthis.mousePos = getMousePosition( event, this.imageEditorContainer );\n\t\t// first check the mouse boundaries\n\t\t// now calculate the new dimensions of the crop area\n\t\tlet width, height, left, top, right, bottom;\n\n\t\tif ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-se` ) ) {\n\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\tthis.image.transform.origin = [ 'left', 'top' ];\n\n\t\t\twidth  = this.mousePos.x - this.croppingArea.position.left;\n\t\t\theight = this.mousePos.y - this.croppingArea.position.top;\n\t\t\tleft = this.croppingArea.position.left;\n\t\t\ttop = this.croppingArea.position.top;\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-sw` ) ) {\n\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\tthis.image.transform.origin = [ 'right', 'top' ];\n\n\t\t\twidth  = this.croppingArea.width - ( this.mousePos.x - this.croppingArea.position.left );\n\t\t\tleft = this.mousePos.x;\n\t\t\theight = this.mousePos.y - this.croppingArea.position.top;\n\t\t\ttop = this.croppingArea.position.top;\n\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-nw` ) ) {\n\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\tthis.image.transform.origin = [ 'right', 'bottom' ];\n\n\t\t\twidth = this.croppingArea.width - ( this.mousePos.x - this.croppingArea.position.left );\n\t\t\theight = this.croppingArea.height - ( this.mousePos.y - this.croppingArea.position.top );\n\t\t\tleft = this.mousePos.x;\n\t\t\ttop = this.mousePos.y ;\n\t\t\tif ( this.constrain || event.shiftKey ) {\n\t\t\t\ttop = this.mousePos.y - ( ( width / this.image.width * this.image.height ) - height );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-ne` ) ) {\n\n\t\t\t// origin of image scale should be set to the opposite corner of this handle\n\t\t\tthis.image.transform.origin = [ 'left', 'bottom' ];\n\n\t\t\twidth = ( this.mousePos.x - this.croppingArea.position.left );\n\t\t\theight = this.croppingArea.height - ( this.mousePos.y - this.croppingArea.position.top );\n\t\t\tleft = this.croppingArea.position.left;\n\t\t\ttop = this.mousePos.y ;\n\t\t\tif ( this.constrain || event.shiftKey ) {\n\t\t\t\ttop = this.mousePos.y - ( (width / this.image.width * this.image.height ) - height );\n\t\t\t}\n\n\t\t}\n\n\t\t// all this is about ensuring there is no 'sticking' at the extremes\n\t\theight = isNaN(height) ? this.croppingArea.height : height;\n\t\theight = height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : height;\n\t\theight = height <= this.croppingArea.minDimensions.height ? this.croppingArea.minDimensions.height : height;\n\t\twidth = width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : width;\n\t\twidth = width <= this.croppingArea.minDimensions.width ? this.croppingArea.minDimensions.width : width;\n\t\tleft = left >= this.croppingArea.boundary.right - this.croppingArea.minDimensions.width\n\t\t\t? this.croppingArea.boundary.right - this.croppingArea.minDimensions.width : left;\n\t\tleft = left <= this.croppingArea.boundary.left ? this.croppingArea.boundary.left : left;\n\t\ttop = top >= this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height\n\t\t\t? this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height : top;\n\t\ttop = (top <= this.croppingArea.boundary.top || isNaN(top)) ? this.croppingArea.boundary.top : top;\n\n\t\tif ( this.constrain || event.shiftKey ) {\n\t\t\theight = width / this.image.width * this.image.height;\n\t\t}\n\n\n\n\n\n\n\t\tthis.croppingArea.position.left = left;\n\t\tthis.cropAreaContainer.style.left = `${ this.croppingArea.position.left  }px`;\n\n\t\tthis.croppingArea.width = width;\n\t\tthis.cropAreaContainer.style.width = `${ this.croppingArea.width }px`;\n\n\t\tthis.croppingArea.height = height;\n\t\tthis.cropAreaContainer.style.height = `${ this.croppingArea.height }px`;\n\n\t\tthis.croppingArea.position.top = top;\n\t\tthis.cropAreaContainer.style.top = `${ this.croppingArea.position.top }px`;\n\n\t\tthis.croppingArea.position.bottom = this.croppingArea.position.top + height;\n\t\tthis.croppingArea.position.right = this.croppingArea.position.left + width;\n\t\tthis.cropActionTriggered = true;\n\n\n\t\tthis.onWorkSpaceUpdated( {\n\t\t\timage: {\n\t\t\t\t...this.image\n\t\t\t},\n\t\t\tcropped: {\n\t\t\t\t...this.croppingArea,\n\t\t\t},\n\t\t\toriginal: {\n\t\t\t\twidth: this.imageObj.naturalWidth,\n\t\t\t\theight: this.imageObj.naturalHeight,\n\t\t\t}\n\t\t} );\n\n\t\treturn false;\n\n\t}\n\n\tonStopCropResize () {\n\n\t\tthis.dragging = false;\n\t\tthis.mousePos = null;\n\t\tthis.cropEvent = null;\n\t\tremoveClass( this.cropAreaContainer, ACTIVE_CLASS );\n\t\tdocument.removeEventListener( 'mousemove', this.onCropResize );\n\t\tdocument.removeEventListener( 'mouseup', this.onStopCropResize );\n\t\tdocument.removeEventListener( 'touchmove', this.onCropResize );\n\t\tdocument.removeEventListener( 'touchend', this.onStopCropResize );\n\n\t\t// this.cropAreaContainer.style.transition = 'all 0.09s linear';\n\t\t// this.imageObj.style.transition = 'transform 0.1s linear';\n\n\t\tif (!this.cropActionTriggered) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.cropActionTriggered = false;\n\t\tthis.croppingArea.scale = {\n\t\t\twidth: this.croppingArea.width / this.image.width,\n\t\t\theight: this.croppingArea.height / this.image.height,\n\t\t\ttop: this.croppingArea.position.top / this.image.height,\n\t\t\tleft: this.croppingArea.position.left / this.image.width\n\t\t};\n\n\n\t\tthis.croppingArea.delta.top = this.croppingArea.position.top - this.croppingArea.delta.top;\n\t\tthis.croppingArea.delta.right = this.croppingArea.position.right - this.croppingArea.delta.right;\n\t\tthis.croppingArea.delta.bottom = this.croppingArea.position.bottom - this.croppingArea.delta.bottom;\n\t\tthis.croppingArea.delta.left = this.croppingArea.position.left - this.croppingArea.delta.left;\n\n\n\t\tthis.zoomInImage();\n\t}\n\n\n\tzoomInImage() {\n/*\t\tlet scaleRatio; // for the image\n\t\tlet anotherScaleRatio; // for the cropping area\n\n\n\t\t// get aspect ratio for the original image\n\t\tscaleRatio = calculateAspectRatioFit(\n\t\t\tthis.croppingArea.width,\n\t\t\tthis.croppingArea.height,\n\t\t\tthis.image.width * this.image.transform.scale,\n\t\t\tthis.image.height * this.image.transform.scale,\n\t\t\tthis.image.rotated,\n\t\t\t1 );*/\n\t}\n\n\t// update the positions and dimensions\n\t// when the workspace changes\n\tupdateWorkspace( timestamp ) {\n\n\t\tconst now = timestamp,\n\t\t\telapsedTime = now - this.lastTimestamp;\n\n\t\tif ( elapsedTime < this.frameRateInterval ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// if enough time has passed to call the next frame\n\t\t// reset lastTimeStamp minus 1 frame in ms ( to adjust for frame rates other than 60fps )\n\t\tthis.lastTimestamp = now - ( elapsedTime % this.frameRateInterval );\n\n\t\t// cache the container offset width\n\t\tthis.outerContainer.width = this.imageEditorContainer.offsetWidth;\n\t\tthis.outerContainer.height = this.imageEditorContainer.offsetHeight;\n\n\n\t\tlet scaleRatio; // for the image\n\t\tlet anotherScaleRatio; // for the cropping area\n\n\t\t// get aspect ratio for the original image\n\t\t// we're scaling the image based on the container dimensions\n\t\t// we want to scale imageObj to fit outerContainer\n\t\tscaleRatio = calculateAspectRatioFit(\n\t\t\tthis.imageObj.naturalWidth,\n\t\t\tthis.imageObj.naturalHeight,\n\t\t\tthis.outerContainer.width,\n\t\t\tthis.outerContainer.height,\n\t\t\tthis.image.rotated,\n\t\t\t1 );\n\n\t\t// now we want the scale ratio for the cropping area\n\t\t// so we get the dimensions of the scaled image\n\t\t// we're scaling the image based on the container dimensions\n\t\t// we want to the crop container to fit the outerContainer, but be no bigger than the image\n\t\tanotherScaleRatio = calculateAspectRatioFit(\n\t\t\tscaleRatio.width,\n\t\t\tscaleRatio.height,\n\t\t\tthis.outerContainer.width,\n\t\t\tthis.outerContainer.height,\n\t\t\tthis.image.rotated,\n\t\t\tEDITOR_GUTTER );\n\n\t\t// save the initial dimensions to the image\n\t\t// the image must be AT A MINIMUM the size of the cropping container\n\t\tthis.image.width = scaleRatio.width < anotherScaleRatio.width ? anotherScaleRatio.width : scaleRatio.width ;\n\t\tthis.image.height = scaleRatio.height < anotherScaleRatio.height ? anotherScaleRatio.height : scaleRatio.height ;\n\n\t\t// apply the dimensions to the image\n\t\tthis.imageObj.width = this.image.width;\n\t\tthis.imageObj.height = this.image.height;\n\n\t\t// save this so we can use it for later transformations/zooms\n\t\tthis.image.transform.scale = anotherScaleRatio.ratio;\n\n\n\n\t\t// center coords of container\n\t\tconst outerContainerCenterX = this.outerContainer.width / 2;\n\t\tconst outerContainerCenterY = this.outerContainer.height / 2 ;\n\n\n\t\tconst newPositionX = outerContainerCenterX - ( anotherScaleRatio.width / 2);\n\t\tconst newPositionY = outerContainerCenterY - (anotherScaleRatio.height / 2);\n\n\t\tthis.croppingArea.position = {\n\t\t\ttop:  newPositionY,\n\t\t\tright: newPositionX +  anotherScaleRatio.width ,\n\t\t\tbottom: newPositionY + anotherScaleRatio.height ,\n\t\t\tleft: newPositionX\n\t\t};\n\n\t\tthis.croppingArea.boundary = {\n\t\t\t...this.croppingArea.position\n\t\t};\n\n\t\tthis.image.transform = Object.assign( {}, this.image.transform, {\n\t\t\ttranslateX: outerContainerCenterX - (scaleRatio.width / 2),\n\t\t\ttranslateY: outerContainerCenterY - (scaleRatio.height / 2),\n\t\t} );\n\n\n\t\t// set the image transform matrix\n\t\tthis.transformMatrices = {\n\t\t\t...createTransformMatrix(\n\t\t\t\tthis.transformMatrices.transformMatrix,\n\t\t\t\tthis.transformMatrices.inverseTransformMatrix,\n\t\t\t\tthis.image.transform.translateX,\n\t\t\t\tthis.image.transform.translateY,\n\t\t\t\tthis.image.transform.scale,\n\t\t\t\tthis.image.transform.radians\n\t\t\t)\n\t\t};\n\n\t\t// apply the matrix to the image\n\t\tthis.imageObj.style.transform = `matrix(    \n          ${this.transformMatrices.transformMatrix[0]}, \n          ${this.transformMatrices.transformMatrix[1]}, \n          ${this.transformMatrices.transformMatrix[2]}, \n          ${this.transformMatrices.transformMatrix[3]}, \n          ${this.transformMatrices.transformMatrix[4]}, \n          ${this.transformMatrices.transformMatrix[5]})`;\n\n\t\t// save and resize the cropping area\n\t\t// the cropping area must be AT A MAXIMUM the size of the image\n\n\t\tthis.croppingArea.width = anotherScaleRatio.width > this.image.width ? this.image.width : anotherScaleRatio.width;\n\t\tthis.croppingArea.height = anotherScaleRatio.height > this.image.height ? this.image.height : anotherScaleRatio.height;\n\t\tthis.cropAreaContainer.style.left = `${ this.croppingArea.position.left   }px`;\n\t\tthis.cropAreaContainer.style.top = `${ this.croppingArea.position.top  }px`;\n\t\tthis.cropAreaContainer.style.width =  `${ this.croppingArea.width  }px`;\n\t\tthis.cropAreaContainer.style.height =  `${ this.croppingArea.height  }px`;\n\n\t\t// reset the cropping area's limits\n\t\tthis.croppingArea.maxDimensions = {\n\t\t\twidth: anotherScaleRatio.width >= this.outerContainer.width ? this.outerContainer.width : anotherScaleRatio.width,\n\t\t\theight: anotherScaleRatio.height >= this.outerContainer.height ? this.outerContainer.height : anotherScaleRatio.height\n\t\t};\n\n\t\tthis.onWorkSpaceUpdated( {\n\t\t\timage: {\n\t\t\t\t...this.image,\n\t\t\t},\n\t\t\tcropped: {\n\t\t\t\t...this.croppingArea,\n\t\t\t},\n\t\t\toriginal: {\n\t\t\t\twidth: this.imageObj.naturalWidth,\n\t\t\t\theight: this.imageObj.naturalHeight,\n\t\t\t},\n\t\t} );\n\n\t}\n\n\n\tdrawImage() {\n\n\t}\n\n\n\t// ==== editing API\n\t// rotate( callback ) // returns new coords\n\t// reflect( callback ) // returns new coords\n\t// changeAspectRatio( callback ) // returns new coords\n\t// save() // returns blob\n\t// preview() // returns image/png for optional preview before save\n\t// reset( callback )\n\t// onImageLoaded( callback ) // allows consumers to do something after bootstrap\n\t// destroy () clear container and remove all event listeners\n\t// getOriginalImage() // returns original image\n\t// getWorkingImage() // returns image at current crop state\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/editor.js","/**\n * Create a noop call\n * @returns {Function}\n */\nexport function noop() {\n    setTimeout( Function.prototype, 10000 );\n}\n\n/**\n * Throttle a func call every {threshhold}ms\n * https://developer.mozilla.org/en-US/docs/Web/Events/resize\n * Usage:\n    throttle(\"resize\", \"optimizedResize\");\n    // handle event\n    window.addEventListener(\"optimizedResize\", function() {\n        console.log(\"Resource conscious resize callback!\");\n    });\n */\nexport function throttle( type, name, obj = window ) {\n    let running = false;\n    const func = function() {\n        if (running) { return; }\n        running = true;\n        requestAnimationFrame(function throttledRequestAnimationFrame() {\n            obj.dispatchEvent( new CustomEvent( name ) );\n            running = false;\n        });\n    };\n    obj.addEventListener(type, func);\n}\n\n/**\n * Creates a simple DOM tree\n * @example\nconst htmlElementToAppend = createElement({\n  tagName: 'span',\n  className: 'new-class-name',\n  text: 'Spannend!',\n  attributes: {\n    'title': 'Geil!'\n  },\n  children: [{ \n      // recursive call to createElement()\n  }]\n})); // returns => <span class=\"new-class-name\" title=\"Geil!\">Spannend!</span>\n * @typedef {Object} OptionsObject\n * @property {String} tagName\n * @property {String} className\n * @property {String} text\n * @property {Object} attributes\n * @property {Array<options>} children\n * \n * @param {OptionsObject} options\n * @returns {HTMLElement}\n */\nexport function createElement( options ) {\n\n    const element = document.createElement( options.tagName );\n\n    if ( options.className ) {\n        element.className = options.className;\n    }\n\n    if ( options.attributes ) {\n        for ( let attr in options.attributes ) {\n            element.setAttribute( attr, options.attributes[attr] )\n        }\n    }\n\n    if ( options.text ) {\n        element.appendChild( document.createTextNode( options.text ) );\n    }\n\n    if ( options.children && options.children.length ) {\n        let i = 0;\n        let childrenLength = options.children.length;\n        for (; i < childrenLength; i++ ) {\n            element.appendChild( options.children[i] instanceof window.HTMLElement ? options.children[i] : createElement( options.children[i] ) );\n        }\n    }\n\n    return element;\n\n}\n\n/**\n * @example\n const offsetValues = getOffsetRelativeToParent(\n    '.child-selector',\n    '#parent-selector'\n ); // returns => { top: {n}, right: {n}, bottom: {n}, left: {n} }\n * @typedef {Object} OffsetObject\n * @property {Integer} top\n * @property {Integer} right\n * @property {Integer} bottom\n * @property {Integer} left\n *\n * @param {String} childCssSelector\n * @param {String} parentCssSelector\n * @returns {OffsetObject}\n */\nexport function getOffsetRelativeToParent( childCssSelector, parentCssSelector) {\n\n    // we have to query the DOM elements to get the latest position data\n    // in case there has been a CSS transform on the element(s)\n    const childElem = document.querySelector( childCssSelector );\n    const parentElem = document.querySelector( parentCssSelector );\n\n    if ( ! childElem || ! parentElem ) {\n        throw new Error( `One or more DOM elements can't be found with: ${childCssSelector} or ${parentCssSelector}` );\n    }\n\n    const childRect = childElem.getBoundingClientRect();\n    const parentRect = parentElem.getBoundingClientRect();\n\n    return {\n        top: childRect.top - parentRect.top,\n        right: childRect.right - parentRect.right,\n        bottom: childRect.bottom - parentRect.bottom,\n        left: childRect.left - parentRect.left\n    };\n\n}\n\n/**\n * @example\n const offsetValues = getCenterPositionRelativeToParent(\n    HTMLElement,\n    HTMLElement.parentNode\n ); // returns => { left: {n}, top: {n} }\n * @typedef {Object} CenterPosition\n * @property {Integer} top\n * @property {Integer} left\n *\n * @param {HTMLElement} childElement\n * @param {HTMLElement} parentElement\n * @returns {CenterPosition}\n */\nexport function getCenterPositionRelativeToParent( childElement, parentElement ) {\n    return {\n        left: ( parentElement.offsetWidth / 2 - childElement.offsetWidth / 2 ),\n        top: ( parentElement.offsetHeight / 2 - childElement.offsetHeight / 2 )\n    };\n}\n\n/**\n * @example\n const mousePos = getMousePosition(\n    DOMEventObject,\n    HTMLElement\n ); // returns => { x: {n}, y: {n} }\n * @typedef {Object} PositionObject\n * @property {Integer} x\n * @property {Integer} y\n *\n * @param {DOMEventObject} event\n * @param {HTMLElement} contextElement (optional if you need position relative to parent offset)\n * @returns {PositionObject}\n */\nexport function getMousePosition( event, contextElement = null ) {\n\n    const offsetLeft = contextElement ? contextElement.offsetLeft : window.pageXOffset;\n    const offsetTop = contextElement ? contextElement.offsetTop : window.pageYOffset;\n\n    const x = ( event.pageX || ( event.touches && event.touches[0].pageX ) ) - offsetLeft;\n    const y = ( event.pageY || ( event.touches && event.touches[0].pageY ) ) - offsetTop;\n\n    return {\n        x,\n        y\n    };\n}\n\n\n/**\n * Conserve aspect ratio of the orignal region. Useful when shrinking/enlarging\n * images to fit into a certain area.\n * At the moment we expect rotations of only 90 degrees.\n * This could be improved by always checking if the bounding box of a rotated rectangle fits within the scaled container\n *\n * @param {Number} srcWidth Source area width\n * @param {Number} srcHeight Source area height\n * @param {Number} maxWidth Fittable area maximum available width\n * @param {Number} maxHeight Fittable area maximum available height\n * @param {Boolean} rotated\n * @param {Number} gutter - Optional percentage to increase or decrease the new fit dimensions\n * @return {Object} { width, heigth }\n */\nexport function calculateAspectRatioFit( srcWidth, srcHeight, maxWidth, maxHeight, rotated = false, gutter = 1 ) {\n\n    const aspectRatio = rotated ? Math.min( maxHeight / srcWidth, maxWidth / srcHeight ) : Math.min( maxWidth / srcWidth, maxHeight / srcHeight );\n    // reduce ratio to gutter percentage amount\n    const ratio = aspectRatio * gutter;\n\n    // widths with ratio applied\n    const width = Math.floor( srcWidth * ratio ) ;\n    const height = Math.floor( srcHeight * ratio ) ;\n\n    return {\n        ratio,\n        width,\n        height\n    };\n}\n\nexport function calculateOriginalDimensionsFromScaled( scaledWidth, scaledHeight, ratio ) {\n\n    // widths with ratio applied\n    const width = Math.floor( scaledWidth / ratio ) ;\n    const height = Math.floor( scaledHeight / ratio ) ;\n\n    return {\n        width,\n        height\n    };\n}\n\nexport function transformCSS( element, translateX = 0, translateY = 0, scale = 0, radians = 0 ) {\n    element.style.transform = `translate( ${ translateX }px, ${ translateY }px ) scale( ${ scale } ) rotate( ${ radians }rad ) translateZ( 0px )`;\n    return element;\n}\n\n// Converts from degrees to radians.\nexport function getRadianFromDegrees( degrees ) {\n    return degrees * Math.PI / 180;\n}\n\n// Converts from radians to degrees.\nexport function getDegreesFromRadians( radians ) {\n    return radians * 180 / Math.PI;\n}\n\nexport function regExp( name ) {\n    return new RegExp( `(^| )${name}( |$)` );\n}\n\nexport function hasClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype )  ) {\n        return regExp( name ).test( this.element.className );\n    }\n    return element.classList.contains( className );\n}\n\nexport function removeClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className =  element.className.replace( regExp( name ), '' );\n    }\n    return element.classList.remove( className );\n}\n\nexport function addClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className += ' ' + className;\n    }\n    return element.classList.add( className );\n}\n\nexport function createTransformMatrix( transformMatrix, inverseTransformMatrix, x, y, scale, rotate ) {\n\n    // create the rotation and scale parts of the transformMatrix\n    transformMatrix[3] =   transformMatrix[0] = Math.cos(rotate) * scale;\n    transformMatrix[2] = -(transformMatrix[1] = Math.sin(rotate) * scale);\n\n    // add the translation\n    transformMatrix[4] = x;\n    transformMatrix[5] = y;\n\n    // calculate the inverse transformation\n\n    // first get the cross product of x axis and y axis\n    var cross = transformMatrix[0] * transformMatrix[3] - transformMatrix[1] * transformMatrix[2];\n\n    // now get the inverted axis\n    inverseTransformMatrix[0] =  transformMatrix[3] / cross;\n    inverseTransformMatrix[1] = -transformMatrix[1] / cross;\n    inverseTransformMatrix[2] = -transformMatrix[2] / cross;\n    inverseTransformMatrix[3] =  transformMatrix[0] / cross;\n    \n\n    return {\n        transformMatrix,\n        inverseTransformMatrix\n    };\n};\n\n// params: x, y coords in current, transformed matrix\n// returns x,y coords from original, untransformed matrix\nexport function getOriginalCoordinatesFromTransformedMatrix( transformMatrix, inverseTransformMatrix, x, y ) {\n    var xx, yy;\n    xx = x - transformMatrix[4];     // remove the translation\n    yy = y - transformMatrix[5];     // by subtracting the origin\n    // return the point {x:?,y:?} by multiplying xx,yy by the inverse matrix\n    return {\n        x:   xx * inverseTransformMatrix[0] + yy * inverseTransformMatrix[2],\n        y:   xx * inverseTransformMatrix[1] + yy * inverseTransformMatrix[3]\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js"],"sourceRoot":""}