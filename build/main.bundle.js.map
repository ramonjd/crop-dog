{"version":3,"sources":["webpack:///webpack/bootstrap 3dfb1495544f3c0d250d","webpack:///./src/index.js","webpack:///./src/image-editor.js","webpack:///./src/utils.js"],"names":["window","imageEditor","imagePath","imageAltText","onWorkSpaceUpdated","document","querySelector","newImageEditorState","croppedImageObj","croppedImageAtag","previewImage","canvas","toDataURL","src","width","cropped","height","href","template","original","rotated","innerHTML","NAMESPACE","IMAGE_ALT_TEXT","ACTIVE_CLASS","EDITOR_GUTTER","DEBUG","ImageEditor","props","container","image","transform","ratio","translateX","translateY","degrees","radians","origin","position","left","top","drag","startX","startY","dx","dy","maxRatio","croppingArea","maxDimensions","minDimensions","right","bottom","touched","boundary","constrain","outerContainer","onImageLoaded","bind","updateWorkspace","onWindowResize","onStartDragCropArea","onDragCropArea","onStopDragCropArea","onStartCropResize","onCropResize","onStopCropResize","fragment","createDocumentFragment","imageObj","Image","setAttribute","className","onload","onerror","imageObjClone","cloneNode","canvasWorkspace","tagName","cropAreaContainer","children","imageEditorWorkspace","imageEditorContainer","addEventListener","passive","dragging","appendChild","dragRequestId","resizing","cropActionTriggered","frameRateInterval","requestAnimationFrameId","lastTimestamp","transformMatrices","transformMatrix","inverseTransformMatrix","performance","now","setTimeout","requestAnimationFrame","event","preventDefault","target","stopImmediatePropagation","style","transition","cropEvent","mousePos","x","y","newDx","newDy","scale","Object","assign","removeEventListener","drawImage","classList","contains","shiftKey","isNaN","zoomOut","scaleRatio","console","log","timestamp","elapsedTime","offsetWidth","offsetHeight","naturalWidth","naturalHeight","outerContainerCenterX","outerContainerCenterY","imageHalfWidth","imageHalfHeight","newPositionX","newPositionY","context","getContext","scaledCropWidth","Math","floor","scaledCropHeight","clearRect","save","sourceCoords","sourceX","sourceY","sourceWidth","sourceHeight","destX","destY","destWidth","destHeight","restore","noop","throttle","createElement","getOffsetRelativeToParent","getCenterPositionRelativeToParent","getMousePosition","calculateAspectRatioFit","calculateOriginalDimensionsFromScaled","transformCSS","getRadianFromDegrees","getDegreesFromRadians","regExp","hasClass","removeClass","addClass","createTransformMatrix","getOriginalCoordinatesFromTransformedMatrix","Function","prototype","type","name","obj","running","func","throttledRequestAnimationFrame","dispatchEvent","CustomEvent","options","element","attributes","attr","text","createTextNode","length","i","childrenLength","HTMLElement","childCssSelector","parentCssSelector","childElem","parentElem","Error","childRect","getBoundingClientRect","parentRect","childElement","parentElement","contextElement","offsetLeft","pageXOffset","offsetTop","pageYOffset","pageX","touches","pageY","srcWidth","srcHeight","maxWidth","maxHeight","gutter","aspectRatio","min","scaledWidth","scaledHeight","PI","RegExp","Element","test","replace","remove","add","rotate","cos","sin","cross","xx","yy"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC7DA;;;;;;AAEAA,OAAOC,WAAP,GAAqB,0BACjB;AACIC,eAAW,sCADf;AAEIC,kBAAc,sBAFlB;AAGIC;AAHJ,CADiB,EAMjBC,SAASC,aAAT,CAAwB,uCAAxB,CANiB,CAArB;;AAUA;AACA,SAASF,kBAAT,CAA6BG,mBAA7B,EAAmD;AAC/C,QAAMC,kBAAkBH,SAASC,aAAT,CAAwB,kDAAxB,CAAxB;AACA,QAAMG,mBAAmBJ,SAASC,aAAT,CAAwB,gDAAxB,CAAzB;AACA,QAAMI,eAAeH,oBAAoBI,MAApB,CAA2BC,SAA3B,CAAqC,YAArC,EAAmD,GAAnD,CAArB;AACAJ,oBAAgBK,GAAhB,GAAsBH,YAAtB;AACAF,oBAAgBM,KAAhB,GAAwBP,oBAAoBQ,OAApB,CAA4BD,KAApD;AACAN,oBAAgBQ,MAAhB,GAAyBT,oBAAoBQ,OAApB,CAA4BC,MAArD;AACAP,qBAAiBQ,IAAjB,GAAwBP,YAAxB;;AAEA,QAAMQ,sHAIQX,oBAAoBY,QAApB,CAA6BL,KAJrC,4BAKUP,oBAAoBY,QAApB,CAA6BH,MALvC,2IAWQT,oBAAoBQ,OAApB,CAA4BD,KAXpC,WAW+CP,oBAAoBQ,OAApB,CAA4BC,MAX3E,qJAe6BT,oBAAoBQ,OAApB,CAA4BK,OAfzD,6FAAN;;AAmBAf,aAASC,aAAT,CAAwB,qCAAxB,EAAgEe,SAAhE,GAA4EH,QAA5E;AAEH,C;;;;;;;;;;;;;;;;;AC3CD;;;;AAaA,IAAMI,YAAY,cAAlB;AACA,IAAMC,iBAAiB,oBAAvB;AACA,IAAMC,eAAe,sBAArB;AACA,IAAMC,gBAAgB,EAAtB;AACA,IAAMC,QAAQ,IAAd;;AAEA;AACA;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;AAqBA;;;;;;;;;;;;;IAcqBC,W;AAEjB,yBAAaC,KAAb,EAAoBC,SAApB,EAAgC;AAAA;;AAE5B;AACA,aAAKC,KAAL,GAAa;AACTC,uBAAW;AACPC,uBAAO,CADA;AAEPC,4BAAY,CAFL;AAGPC,4BAAY,CAHL;AAIPC,yBAAS,CAJF;AAKPC,yBAAS,iCAAsB,CAAtB,CALF;AAMPC,wBAAQ,CAAE,QAAF,EAAY,QAAZ;AAND,aADF;AAST;AACA;AACAC,sBAAU;AACNC,sBAAM,CADA;AAENC,qBAAK;AAFC,aAXD;AAeTpB,qBAAS,KAfA;AAgBTN,mBAAO,CAhBE;AAiBTE,oBAAQ,CAjBC;AAkBTyB,kBAAM;AACJC,wBAAO,CADH;AAEJC,wBAAO,CAFH;AAGJC,oBAAI,CAHA;AAIJC,oBAAI;AAJA,aAlBG;AAwBTC,sBAAU;AAxBD,SAAb;;AA2BA;AACA,aAAKC,YAAL,GAAoB;AAChB;AACA;AACA;AACAC,2BAAe;AACXlC,uBAAO,CADI;AAEXE,wBAAQ;AAFG,aAJC;AAQhB;AACA;AACA;AACAiC,2BAAe;AACXnC,uBAAO,EADI;AAEXE,wBAAQ;AAFG,aAXC;AAehB;AACAsB,sBAAU;AACNE,qBAAK,CADC;AAENU,uBAAO,CAFD;AAGNC,wBAAQ,CAHF;AAINZ,sBAAM;AAJA,aAhBM;AAsBhB;AACAzB,mBAAO,CAvBS;AAwBhBE,oBAAQ,CAxBQ;AAyBhBoC,qBAAS,KAzBO;AA0BhBC,sBAAU;AACNb,qBAAK,CADC;AAENU,uBAAO,CAFD;AAGNC,wBAAQ,CAHF;AAINZ,sBAAM;AAJA;AA1BM,SAApB;;AAkCA,aAAKe,SAAL,GAAiB,KAAjB;;AAEA;AACA,aAAKC,cAAL,GAAsB;AAClBzC,mBAAO,CADW;AAElBE,oBAAQ;AAFU,SAAtB;;AAKA;AACA,aAAKd,SAAL,GAAiB0B,MAAM1B,SAAvB;;AAEA;AACA,aAAK2B,SAAL,GAAiBA,SAAjB;;AAEA;AACA,aAAK2B,aAAL,GAAqB,KAAKA,aAAL,CAAmBC,IAAnB,CAAyB,IAAzB,CAArB;AACA,aAAKC,eAAL,GAAuB,KAAKA,eAAL,CAAqBD,IAArB,CAA2B,IAA3B,CAAvB;AACA,aAAKE,cAAL,GAAsB,KAAKA,cAAL,CAAoBF,IAApB,CAA0B,IAA1B,CAAtB;AACA,aAAKC,eAAL,GAAuB,KAAKA,eAAL,CAAqBD,IAArB,CAA2B,IAA3B,CAAvB;AACA,aAAKG,mBAAL,GAA2B,KAAKA,mBAAL,CAAyBH,IAAzB,CAA+B,IAA/B,CAA3B;AACA,aAAKI,cAAL,GAAsB,KAAKA,cAAL,CAAoBJ,IAApB,CAA0B,IAA1B,CAAtB;AACA,aAAKK,kBAAL,GAA0B,KAAKA,kBAAL,CAAwBL,IAAxB,CAA8B,IAA9B,CAA1B;AACA,aAAKM,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBN,IAAvB,CAA6B,IAA7B,CAAzB;AACA,aAAKO,YAAL,GAAoB,KAAKA,YAAL,CAAkBP,IAAlB,CAAwB,IAAxB,CAApB;AACA,aAAKQ,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBR,IAAtB,CAA4B,IAA5B,CAAxB;;AAGA;AACA,YAAMS,WAAW7D,SAAS8D,sBAAT,EAAjB;;AAEA;AACA,aAAKC,QAAL,GAAgB,IAAIC,KAAJ,EAAhB;AACA,aAAKD,QAAL,CAAcE,YAAd,CAA2B,aAA3B,EAA0C,WAA1C;AACA,aAAKF,QAAL,CAAcG,SAAd,GAA6BjD,SAA7B;AACA,aAAK8C,QAAL,CAAcE,YAAd,CAA4B,KAA5B,EAAmC,KAAKnE,YAAL,IAAqBoB,cAAxD;AACA,aAAK6C,QAAL,CAAcI,MAAd,GAAuB,KAAKhB,aAA5B;AACA,aAAKY,QAAL,CAAcK,OAAd;;AAEA;AACA;AACA;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKA,aAAL,GAAqB,KAAKN,QAAL,CAAcO,SAAd,CAAwB,IAAxB,CAArB;;AAEA;AACA;AACA;AACA;AACA,aAAKC,eAAL,GAAuB,0BAAe;AAClCC,qBAAS,QADyB;AAElCN,uBAAcjD,SAAd;AAFkC,SAAf,CAAvB;;AAKA;AACA;AACA,aAAKwD,iBAAL,GAAyB,0BAAe;AACpCD,qBAAS,KAD2B;AAEpCN,uBAAcjD,SAAd,qBAFoC;AAGpC,0BAAc,eAHsB;AAIpCyD,sBAAW,CACP;AACIF,yBAAS,KADb;AAEIN,+DAA6CjD,SAA7C;AAFJ,aADO,EAKP;AACIuD,yBAAS,KADb;AAEIN,+DAA6CjD,SAA7C;AAFJ,aALO,EASP;AACIuD,yBAAS,KADb;AAEIN,+DAA6CjD,SAA7C;AAFJ,aATO,EAaP;AACIuD,yBAAS,KADb;AAEIN,+DAA6CjD,SAA7C;AAFJ,aAbO,EAiBP;AACIuD,yBAAS,MADb;AAEIN,oDAAkCjD,SAAlC;AAFJ,aAjBO,EAqBP;AACIuD,yBAAS,MADb;AAEIN,oDAAkCjD,SAAlC;AAFJ,aArBO,EAyBP,KAAKsD,eAzBE;;AAJyB,SAAf,CAAzB;;AAiCA;AACA,aAAKI,oBAAL,GAA4B,0BAAe;AACvCH,qBAAS,KAD8B;AAEvCN,uBAAcjD,SAAd,gBAFuC;AAGvCyD,sBAAW,CAAE,KAAKD,iBAAP,EAA0B,KAAKV,QAA/B;AAH4B,SAAf,CAA5B;;AAMA;AACA,aAAKa,oBAAL,GAA4B,0BAAe;AACvCJ,qBAAS,KAD8B;AAEvCN,uBAAcjD,SAAd,oBAAsCA,SAAtC,wBAFuC;AAGvCyD,sBAAW,CAAE,KAAKC,oBAAP;AAH4B,SAAf,CAA5B;;AAOA;AACA;AACA,aAAKF,iBAAL,CAAuBI,gBAAvB,CAAyC,WAAzC,EAAsD,KAAKtB,mBAA3D;AACA,aAAKkB,iBAAL,CAAuBI,gBAAvB,CAAyC,YAAzC,EAAuD,KAAKtB,mBAA5D,EAAiF,EAAEuB,SAAS,IAAX,EAAjF;;AAEA;AACA,aAAKC,QAAL,GAAgB,KAAhB;;AAGA;AACAlB,iBAASmB,WAAT,CAAsB,KAAKJ,oBAA3B;AACA,aAAKpD,SAAL,CAAewD,WAAf,CAA4BnB,QAA5B;;AAEA;AACA,aAAKoB,aAAL,GAAqB,IAArB;;AAEA;AACA;AACA;AACA,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,mBAAL;;AAEA,aAAKC,iBAAL,GAAyB,OAAO,EAAhC;AACA,aAAKC,uBAAL,GAA+B,IAA/B;AACA,aAAKC,aAAL,GAAqB,IAArB;;AAEA;AACA,aAAKvF,kBAAL,GAA0BwB,MAAMxB,kBAAhC;;AAEA;AACA,aAAKwF,iBAAL,GAA0B;AACtBC,6BAAiB,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CADK;AAEtBC,oCAAwB,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX;AAFF,SAA1B;AAIA;AACA,aAAK1B,QAAL,CAAcvD,GAAd,GAAoB,KAAKX,SAAzB;;AAEA,eAAO,IAAP;AAEH;;;;wCAEe;AAAA;;AAEZ;AACA,iBAAKwD,eAAL;;AAEA,gBAAK,OAAO1D,MAAP,KAAkB,WAAvB,EAAqC;AAC/B,qBAAK2F,aAAL,GAAqB3F,OAAO+F,WAAP,CAAmBC,GAAnB,EAArB;AACAhG,uBAAOkF,gBAAP,CAAyB,QAAzB,EAAmC,KAAKvB,cAAxC;AACL;;AAED;AACA;AACAsC,uBAAY,YAAM;AACd,wCAAa,MAAKhB,oBAAlB,EAA2C3D,SAA3C;AACH,aAFD;AAGH;;;yCAEgB;AACb,iBAAKoE,uBAAL,GAA+B1F,OAAOkG,qBAAP,CAA8B,KAAKxC,eAAnC,CAA/B;AACH;;AAED;;;;;;;;4CAOqByC,K,EAAQ;;AAEzBA,kBAAMC,cAAN;AACA,iCAAU,KAAKtB,iBAAf,EAAkCtD,YAAlC;AACA;AACA;AACA,gBAAM,qBAAU2E,MAAME,MAAhB,EAA2B/E,SAA3B,wBAAN,EAAmE;AAC/D6E,sBAAMG,wBAAN;AACA;;AAEA;AACA,qBAAKvD,YAAL,CAAkBK,OAAlB,GAA4B,IAA5B;AACA,qBAAK0B,iBAAL,CAAuByB,KAAvB,CAA6BC,UAA7B,GAA0C,OAA1C;AACA,qBAAKpC,QAAL,CAAcmC,KAAd,CAAoBC,UAApB,GAAiC,OAAjC;;AAEA;AACA,qBAAKC,SAAL,GAAiBN,KAAjB;;AAEA,qBAAKpC,iBAAL,CAAwBoC,KAAxB;AACA,uBAAO,KAAP;AACH;;AAED;AACA9F,qBAAS6E,gBAAT,CAA2B,SAA3B,EAAsC,KAAKpB,kBAA3C;AACAzD,qBAAS6E,gBAAT,CAA2B,UAA3B,EAAuC,KAAKpB,kBAA5C;AACAzD,qBAAS6E,gBAAT,CAA2B,YAA3B,EAAyC,KAAKpB,kBAA9C;;AAEA,gBAAM4C,WAAW,6BAAkBP,KAAlB,EAAyB,KAAKlB,oBAA9B,CAAjB;;AAEA;AACA;AACA,iBAAKnD,KAAL,CAAWW,IAAX,CAAgBC,MAAhB,GAAyBgE,SAASC,CAAT,GAAa,KAAK7E,KAAL,CAAWC,SAAX,CAAqBE,UAA3D;AACA,iBAAKH,KAAL,CAAWW,IAAX,CAAgBE,MAAhB,GAAyB+D,SAASE,CAAT,GAAa,KAAK9E,KAAL,CAAWC,SAAX,CAAqBG,UAA3D;;AAEA;AACA7B,qBAAS6E,gBAAT,CAA2B,WAA3B,EAAwC,KAAKrB,cAA7C;AACAxD,qBAAS6E,gBAAT,CAA2B,WAA3B,EAAwC,KAAKrB,cAA7C,EAA6D,EAAEsB,SAAS,IAAX,EAA7D;AACH;;;uCAGegB,K,EAAQ;;AAEpB,iBAAKf,QAAL,GAAgB,IAAhB;AACA,gBAAMsB,WAAW,6BAAkBP,KAAlB,EAAyB,KAAKlB,oBAA9B,CAAjB;;AAEA,gBAAI4B,QAAQH,SAASC,CAAT,GAAa,KAAK7E,KAAL,CAAWW,IAAX,CAAgBC,MAAzC;AACA,gBAAIoE,QAAQJ,SAASE,CAAT,GAAa,KAAK9E,KAAL,CAAWW,IAAX,CAAgBE,MAAzC;;AAEA,gBAAK,KAAKb,KAAL,CAAWhB,KAAX,GAAmB,KAAKiC,YAAL,CAAkBjC,KAArC,IACD,KAAKgB,KAAL,CAAWd,MAAX,GAAoB,KAAK+B,YAAL,CAAkB/B,MADrC,IAEE6F,SAAS,KAAK9D,YAAL,CAAkBT,QAAlB,CAA2BC,IAFtC,IAGEuE,SAAS,KAAK/D,YAAL,CAAkBT,QAAlB,CAA2BE,GAHtC,IAIG,CAAC,CAAD,GAAKsE,KAAN,GAAe,KAAK/D,YAAL,CAAkB/B,MAAjC,IAA2C,KAAKc,KAAL,CAAWd,MAJxD,IAKE6F,SAAU,KAAK9D,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKgB,KAAL,CAAWhB,KALtD,EAK8D;;AAG1D,qBAAK8E,iBAAL,gBACO,kCACC,KAAKA,iBAAL,CAAuBC,eADxB,EAEC,KAAKD,iBAAL,CAAuBE,sBAFxB,EAGCe,KAHD,EAICC,KAJD,EAKC,KAAKhF,KAAL,CAAWC,SAAX,CAAqBgF,KALtB,EAMC,KAAKjF,KAAL,CAAWC,SAAX,CAAqBK,OANtB,CADP;;AAWA,qBAAKgC,QAAL,CAAcmC,KAAd,CAAoBxE,SAApB,qCACM,KAAK6D,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CADN,4BAEM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAFN,4BAGM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAHN,4BAIM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAJN,4BAKM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CALN,4BAMM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CANN;;AAQA;AACA;AACA,qBAAK/D,KAAL,CAAWW,IAAX,GAAkBuE,OAAOC,MAAP,CAAe,EAAf,EAAoB,KAAKnF,KAAL,CAAWW,IAA/B,EAAqC;AACnDG,wBAAIiE,KAD+C;AAEnDhE,wBAAIiE;AAF+C,iBAArC,CAAlB;AAIH;AACL;;;6CAEqB;AACb,iBAAK1B,QAAL,GAAgB,KAAhB;AACA,oCAAa,KAAKN,iBAAlB,EAAqCtD,YAArC;AACAnB,qBAAS6G,mBAAT,CAA8B,WAA9B,EAA2C,KAAKrD,cAAhD;AACAxD,qBAAS6G,mBAAT,CAA8B,WAA9B,EAA2C,KAAKrD,cAAhD,EAAgE,EAAEsB,SAAS,IAAX,EAAhE;;AAEA,iBAAKrD,KAAL,CAAWC,SAAX,GAAuBiF,OAAOC,MAAP,CAAe,EAAf,EAAmB,KAAKnF,KAAL,CAAWC,SAA9B,EAAyC;AAC5DE,4BAAY,KAAKH,KAAL,CAAWW,IAAX,CAAgBG,EADgC;AAE5DV,4BAAY,KAAKJ,KAAL,CAAWW,IAAX,CAAgBI;AAFgC,aAAzC,CAAvB;;AAKA,iBAAKsE,SAAL;AACH;;;0CAGehB,K,EAAQ;;AAEtB,iBAAKf,QAAL,GAAgB,IAAhB;;AAEAe,kBAAMC,cAAN;;AAEA/F,qBAAS6E,gBAAT,CAA2B,WAA3B,EAAwC,KAAKlB,YAA7C;AACA3D,qBAAS6E,gBAAT,CAA2B,UAA3B,EAAuC,KAAKjB,gBAA5C;AACA5D,qBAAS6E,gBAAT,CAA2B,WAA3B,EAAwC,KAAKlB,YAA7C;AACA3D,qBAAS6E,gBAAT,CAA2B,SAA3B,EAAsC,KAAKjB,gBAA3C;;AAEA,iBAAKyC,QAAL,GAAgB;AACZC,mBAAG,CADS;AAEZC,mBAAG;AAFS,aAAhB;AAIL;;;qCAEcT,K,EAAQ;AACnBA,kBAAMC,cAAN;AACA,iBAAKM,QAAL,GAAgB,6BAAkBP,KAAlB,EAAyB,KAAKlB,oBAA9B,CAAhB;AACA;AACA;AACA,gBAAInE,cAAJ;AAAA,gBAAWE,eAAX;AAAA,gBAAmBuB,aAAnB;AAAA,gBAAyBC,YAAzB;AAAA,gBAA8BU,cAA9B;AAAA,gBAAqCC,eAArC;;AAGA,gBAAK,KAAKsD,SAAL,CAAeJ,MAAf,CAAsBe,SAAtB,CAAgCC,QAAhC,CAA6C/F,SAA7C,2BAAL,EAAuF;;AAEjF;AACA,qBAAKQ,KAAL,CAAWC,SAAX,CAAqBM,MAArB,GAA8B,CAAE,MAAF,EAAU,KAAV,CAA9B;;AAEAvB,wBAAS,KAAK4F,QAAL,CAAcC,CAAd,GAAkB,KAAK5D,YAAL,CAAkBT,QAAlB,CAA2BC,IAAtD;AACAvB,yBAAS,KAAK0F,QAAL,CAAcE,CAAd,GAAkB,KAAK7D,YAAL,CAAkBT,QAAlB,CAA2BE,GAAtD;AACAD,uBAAO,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAAlC;AACAC,sBAAM,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAAjC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACL;;AAED,gBAAK,KAAKiE,SAAL,CAAeJ,MAAf,CAAsBe,SAAtB,CAAgCC,QAAhC,CAA6C/F,SAA7C,2BAAL,EAAuF;;AAEjF;AACA,qBAAKQ,KAAL,CAAWC,SAAX,CAAqBM,MAArB,GAA8B,CAAE,OAAF,EAAW,KAAX,CAA9B;;AAEAvB,wBAAS,KAAKiC,YAAL,CAAkBjC,KAAlB,IAA4B,KAAK4F,QAAL,CAAcC,CAAd,GAAkB,KAAK5D,YAAL,CAAkBT,QAAlB,CAA2BC,IAAzE,CAAT;AACAA,uBAAO,KAAKmE,QAAL,CAAcC,CAArB;AACA3F,yBAAS,KAAK0F,QAAL,CAAcE,CAAd,GAAkB,KAAK7D,YAAL,CAAkBT,QAAlB,CAA2BE,GAAtD;AACAA,sBAAM,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAAjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AAEL;;AAED,gBAAK,KAAKiE,SAAL,CAAeJ,MAAf,CAAsBe,SAAtB,CAAgCC,QAAhC,CAA6C/F,SAA7C,2BAAL,EAAuF;;AAEjF;AACA,qBAAKQ,KAAL,CAAWC,SAAX,CAAqBM,MAArB,GAA8B,CAAE,OAAF,EAAW,QAAX,CAA9B;;AAEAvB,wBAAQ,KAAKiC,YAAL,CAAkBjC,KAAlB,IAA4B,KAAK4F,QAAL,CAAcC,CAAd,GAAkB,KAAK5D,YAAL,CAAkBT,QAAlB,CAA2BC,IAAzE,CAAR;AACAvB,yBAAS,KAAK+B,YAAL,CAAkB/B,MAAlB,IAA6B,KAAK0F,QAAL,CAAcE,CAAd,GAAkB,KAAK7D,YAAL,CAAkBT,QAAlB,CAA2BE,GAA1E,CAAT;AACAD,uBAAO,KAAKmE,QAAL,CAAcC,CAArB;AACAnE,sBAAM,KAAKkE,QAAL,CAAcE,CAApB;AACA,oBAAK,KAAKtD,SAAL,IAAkB6C,MAAMmB,QAA7B,EAAwC;AACpC9E,0BAAM,KAAKkE,QAAL,CAAcE,CAAd,IAAsB9F,QAAQ,KAAKgB,KAAL,CAAWhB,KAAnB,GAA2B,KAAKgB,KAAL,CAAWd,MAAxC,GAAmDA,MAAvE,CAAN;AACH;AAEN;;AAED,gBAAK,KAAKyF,SAAL,CAAeJ,MAAf,CAAsBe,SAAtB,CAAgCC,QAAhC,CAA6C/F,SAA7C,2BAAL,EAAuF;;AAEjF;AACA,qBAAKQ,KAAL,CAAWC,SAAX,CAAqBM,MAArB,GAA8B,CAAE,MAAF,EAAU,QAAV,CAA9B;;AAEAvB,wBAAU,KAAK4F,QAAL,CAAcC,CAAd,GAAkB,KAAK5D,YAAL,CAAkBT,QAAlB,CAA2BC,IAAvD;AACAvB,yBAAS,KAAK+B,YAAL,CAAkB/B,MAAlB,IAA6B,KAAK0F,QAAL,CAAcE,CAAd,GAAkB,KAAK7D,YAAL,CAAkBT,QAAlB,CAA2BE,GAA1E,CAAT;AACAD,uBAAO,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAAlC;AACAC,sBAAM,KAAKkE,QAAL,CAAcE,CAApB;AACA,oBAAK,KAAKtD,SAAL,IAAkB6C,MAAMmB,QAA7B,EAAwC;AACpC9E,0BAAM,KAAKkE,QAAL,CAAcE,CAAd,IAAqB9F,QAAQ,KAAKgB,KAAL,CAAWhB,KAAnB,GAA2B,KAAKgB,KAAL,CAAWd,MAAvC,GAAkDA,MAAtE,CAAN;AACH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AAEL;;AAGKA,qBAASuG,MAAMvG,MAAN,IAAgB,KAAK+B,YAAL,CAAkB/B,MAAlC,GAA2CA,MAApD;AACAA,qBAASA,UAAU,KAAK+B,YAAL,CAAkBC,aAAlB,CAAgChC,MAA1C,GAAmD,KAAK+B,YAAL,CAAkBC,aAAlB,CAAgChC,MAAnF,GAA4FA,MAArG;AACAA,qBAASA,UAAU,KAAK+B,YAAL,CAAkBE,aAAlB,CAAgCjC,MAA1C,GAAmD,KAAK+B,YAAL,CAAkBE,aAAlB,CAAgCjC,MAAnF,GAA4FA,MAArG;AACAF,oBAAQA,SAAS,KAAKiC,YAAL,CAAkBC,aAAlB,CAAgClC,KAAzC,GAAiD,KAAKiC,YAAL,CAAkBC,aAAlB,CAAgClC,KAAjF,GAAyFA,KAAjG;AACAA,oBAAQA,SAAS,KAAKiC,YAAL,CAAkBE,aAAlB,CAAgCnC,KAAzC,GAAiD,KAAKiC,YAAL,CAAkBE,aAAlB,CAAgCnC,KAAjF,GAAyFA,KAAjG;AACAyB,mBAAOA,QAAQ,KAAKQ,YAAL,CAAkBM,QAAlB,CAA2BH,KAA3B,GAAmC,KAAKH,YAAL,CAAkBE,aAAlB,CAAgCnC,KAA3E,GACH,KAAKiC,YAAL,CAAkBM,QAAlB,CAA2BH,KAA3B,GAAmC,KAAKH,YAAL,CAAkBE,aAAlB,CAAgCnC,KADhE,GACwEyB,IAD/E;AAEAA,mBAAOA,QAAQ,KAAKQ,YAAL,CAAkBM,QAAlB,CAA2Bd,IAAnC,GAA0C,KAAKQ,YAAL,CAAkBM,QAAlB,CAA2Bd,IAArE,GAA4EA,IAAnF;AACAC,kBAAMA,OAAO,KAAKO,YAAL,CAAkBM,QAAlB,CAA2BF,MAA3B,GAAoC,KAAKJ,YAAL,CAAkBE,aAAlB,CAAgCjC,MAA3E,GACF,KAAK+B,YAAL,CAAkBM,QAAlB,CAA2BF,MAA3B,GAAoC,KAAKJ,YAAL,CAAkBE,aAAlB,CAAgCjC,MADlE,GAC2EwB,GADjF;AAEAA,kBAAOA,OAAO,KAAKO,YAAL,CAAkBM,QAAlB,CAA2Bb,GAAlC,IAAyC+E,MAAM/E,GAAN,CAA1C,GAAwD,KAAKO,YAAL,CAAkBM,QAAlB,CAA2Bb,GAAnF,GAAyFA,GAA/F;;AAEA,gBAAK,KAAKc,SAAL,IAAkB6C,MAAMmB,QAA7B,EAAwC;AACpCtG,yBAASF,QAAQ,KAAKgB,KAAL,CAAWhB,KAAnB,GAA2B,KAAKgB,KAAL,CAAWd,MAA/C;AACH;;AAED,iBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAkCA,IAAlC;AACA,iBAAKuC,iBAAL,CAAuByB,KAAvB,CAA6BhE,IAA7B,GAAwC,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAAnE;;AAEA,iBAAKQ,YAAL,CAAkBjC,KAAlB,GAA0BA,KAA1B;AACA,iBAAKgE,iBAAL,CAAuByB,KAAvB,CAA6BzF,KAA7B,GAAyC,KAAKiC,YAAL,CAAkBjC,KAA3D;;AAEA,iBAAKiC,YAAL,CAAkB/B,MAAlB,GAA2BA,MAA3B;AACA,iBAAK8D,iBAAL,CAAuByB,KAAvB,CAA6BvF,MAA7B,GAA0C,KAAK+B,YAAL,CAAkB/B,MAA5D;;AAEA,iBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiCA,GAAjC;AACA,iBAAKsC,iBAAL,CAAuByB,KAAvB,CAA6B/D,GAA7B,GAAuC,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAAlE;;AAEA,iBAAKO,YAAL,CAAkBT,QAAlB,CAA2Ba,MAA3B,GAAoC,KAAKJ,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiCxB,MAArE;AACA,iBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BY,KAA3B,GAAmC,KAAKH,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAkCzB,KAArE;;AAEA,mBAAO,KAAP;;AAGJ;AACE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEP;;;2CAEmB;;AAEhB,iBAAKsE,QAAL,GAAgB,KAAhB;AACA,iBAAKsB,QAAL,GAAgB,IAAhB;AACA,iBAAKD,SAAL,GAAiB,IAAjB;AACA,oCAAa,KAAK3B,iBAAlB,EAAqCtD,YAArC;AACAnB,qBAAS6G,mBAAT,CAA8B,WAA9B,EAA2C,KAAKlD,YAAhD;AACA3D,qBAAS6G,mBAAT,CAA8B,SAA9B,EAAyC,KAAKjD,gBAA9C;;AAEA5D,qBAAS6G,mBAAT,CAA8B,WAA9B,EAA2C,KAAKlD,YAAhD;AACA3D,qBAAS6G,mBAAT,CAA8B,UAA9B,EAA0C,KAAKjD,gBAA/C;AACA,iBAAKa,iBAAL,CAAuByB,KAAvB,CAA6BC,UAA7B,GAA0C,kBAA1C;AACA,iBAAKpC,QAAL,CAAcmC,KAAd,CAAoBC,UAApB,GAAiC,uBAAjC;AACA,gBAAI,CAAC,KAAKhB,mBAAV,EAA+B;AAC7B;AACD;;AAED,iBAAKA,mBAAL,GAA2B,KAA3B;;AAEA;AACA;AACA,gBAAI,KAAKgC,OAAT,EAAkB;AACd,qBAAKA,OAAL,GAAe,KAAf;AACA,qBAAKzE,YAAL,CAAkBgE,KAAlB,GAA0B;AACtBjG,2BAAO,KAAKiC,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKgB,KAAL,CAAWhB,KADtB;AAEtBE,4BAAQ,KAAK+B,YAAL,CAAkB/B,MAAlB,GAA2B,KAAKc,KAAL,CAAWd,MAFxB;AAGtBwB,yBAAK,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiC,KAAKV,KAAL,CAAWd,MAH3B;AAItBuB,0BAAM,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAkC,KAAKT,KAAL,CAAWhB;AAJ7B,iBAA1B;AAMH,aARD,MAQO,CAEN;AADG;;;AAGJ;AACH;;;sCAEa;;AAET;AACD,gBAAM2G,aAAa,oCACb,KAAK1E,YAAL,CAAkBjC,KADL,EAEb,KAAKiC,YAAL,CAAkB/B,MAFL,EAGb,KAAKuC,cAAL,CAAoBzC,KAHP,EAIb,KAAKyC,cAAL,CAAoBvC,MAJP,EAKb,KAAKc,KAAL,CAAWV,OALE,EAMbK,aANa,CAAnB;;AAUA,gBAAMsF,QAAQ,KAAKjF,KAAL,CAAWC,SAAX,CAAqBgF,KAArB,GAA6BU,WAAWzF,KAAtD;;AAEA,gBAAI+E,SAAS,KAAKjF,KAAL,CAAWgB,QAAxB,EAAkC;AAC9B;AACH;AACD,gBAAMZ,aAAe,CAAC,CAAD,IAAM,KAAKa,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiCiF,WAAWzF,KAAlD,CAAD,GACX,KAAKF,KAAL,CAAWC,SAAX,CAAqBG,UAArB,GAAkCuF,WAAWzF,KADtD;AAEA,gBAAMC,aAAe,CAAC,CAAD,IAAM,KAAKc,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAkCkF,WAAWzF,KAAnD,CAAD,GACX,KAAKF,KAAL,CAAWC,SAAX,CAAqBE,UAArB,GAAkCwF,WAAWzF,KADtD;;AAGA,iBAAK4D,iBAAL,gBACO,kCACC,KAAKA,iBAAL,CAAuBC,eADxB,EAEC,KAAKD,iBAAL,CAAuBE,sBAFxB;AAGC;AACA7D,sBAJD,EAKCC,UALD,EAMC6E,KAND,EAOC,KAAKjF,KAAL,CAAWC,SAAX,CAAqBK,OAPtB,CADP;;AAYA,iBAAKgC,QAAL,CAAcmC,KAAd,CAAoBxE,SAApB,iCACM,KAAK6D,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CADN,wBAEM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAFN,wBAGM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAHN,wBAIM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAJN,wBAKM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CALN,wBAMM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CANN;;AAQA,iBAAK/D,KAAL,CAAWhB,KAAX,GAAmB,KAAKgB,KAAL,CAAWhB,KAAX,GAAmB2G,WAAWzF,KAAjD;AACA,iBAAKF,KAAL,CAAWd,MAAX,GAAoB,KAAKc,KAAL,CAAWd,MAAX,GAAoByG,WAAWzF,KAAnD;;AAEA,iBAAKe,YAAL,CAAkBC,aAAlB,GAAkC;AAC9BlC,uBAAO,KAAKgB,KAAL,CAAWhB,KAAX,IAAoB,KAAKyC,cAAL,CAAoBzC,KAAxC,GAAgD,KAAKyC,cAAL,CAAoBzC,KAApE,GAA4E,KAAKgB,KAAL,CAAWhB,KADhE;AAE9BE,wBAAQ,KAAKc,KAAL,CAAWd,MAAX,IAAqB,KAAKuC,cAAL,CAAoBvC,MAAzC,GAAkD,KAAKuC,cAAL,CAAoBvC,MAAtE,GAA+E,KAAKc,KAAL,CAAWd;AAFpE,aAAlC;;AAKA,iBAAK+B,YAAL,CAAkBjC,KAAlB,GAA0B2G,WAAW3G,KAAX,IAAoB,KAAKiC,YAAL,CAAkBC,aAAlB,CAAgClC,KAApD,GAA4D,KAAKiC,YAAL,CAAkBC,aAAlB,CAAgClC,KAA5F,GAAoG2G,WAAW3G,KAAzI;AACA,iBAAKiC,YAAL,CAAkB/B,MAAlB,GAA2ByG,WAAWzG,MAAX,IAAqB,KAAK+B,YAAL,CAAkBC,aAAlB,CAAgChC,MAArD,GAA8D,KAAK+B,YAAL,CAAkBC,aAAlB,CAAgChC,MAA9F,GAAuGyG,WAAWzG,MAA7I;;AAEA,iBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiC,CAAjC;AACA,iBAAKO,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAmC,CAAnC;;AAEA,iBAAKuC,iBAAL,CAAuByB,KAAvB,CAA6BhE,IAA7B,GAAwC,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAAnE;AACA,iBAAKuC,iBAAL,CAAuByB,KAAvB,CAA6B/D,GAA7B,GAAuC,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAAlE;AACA,iBAAKsC,iBAAL,CAAuByB,KAAvB,CAA6BzF,KAA7B,GAA0C,KAAKiC,YAAL,CAAkBjC,KAA5D;AACA,iBAAKgE,iBAAL,CAAuByB,KAAvB,CAA6BvF,MAA7B,GAA2C,KAAK+B,YAAL,CAAkB/B,MAA7D;;AAEA,iBAAK+B,YAAL,CAAkBgE,KAAlB,GAA0B;AACtBjG,uBAAO,KAAKiC,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKgB,KAAL,CAAWhB,KADtB;AAEtBE,wBAAQ,KAAK+B,YAAL,CAAkB/B,MAAlB,GAA2B,KAAKc,KAAL,CAAWd,MAFxB;AAGtBwB,qBAAK,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAiC,KAAKV,KAAL,CAAWd,MAH3B;AAItBuB,sBAAM,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAkC,KAAKT,KAAL,CAAWhB;AAJ7B,aAA1B;;AAQA,iBAAKgB,KAAL,CAAWC,SAAX,GAAuBiF,OAAOC,MAAP,CAAe,EAAf,EAAmB,KAAKnF,KAAL,CAAWC,SAA9B,EAAyC;AAC5DE,sCAD4D;AAE5DC,sCAF4D;AAG5D6E;AAH4D,aAAzC,CAAvB;;AAMA,iBAAKI,SAAL;AAEH;;AAGD;;;;uCACe;AACZO,oBAAQC,GAAR,CAAY,aAAZ;AACF;;AAGD;AACA;;;;wCACiBC,S,EAAY;;AAE3B,gBAAM5B,MAAM4B,SAAZ;AAAA,gBACIC,cAAc7B,MAAM,KAAKL,aAD7B;;AAGE,gBAAKkC,cAAc,KAAKpC,iBAAxB,EAA4C;AAC1C;AACD;;AAED;AACA;AACA,iBAAKE,aAAL,GAAqBK,MAAQ6B,cAAc,KAAKpC,iBAAhD;;AAEA;AACA,iBAAKlC,cAAL,CAAoBzC,KAApB,GAA4B,KAAKmE,oBAAL,CAA0B6C,WAAtD;AACA,iBAAKvE,cAAL,CAAoBvC,MAApB,GAA6B,KAAKiE,oBAAL,CAA0B8C,YAAvD;;AAGA,gBAAIN,mBAAJ;;AAEA;AACA,gBAAK,CAAE,KAAK1E,YAAL,CAAkBK,OAAzB,EAAmC;AAC/B;AACAqE,6BAAa,oCACP,KAAKrD,QAAL,CAAc4D,YADP,EAEP,KAAK5D,QAAL,CAAc6D,aAFP,EAGP,KAAK1E,cAAL,CAAoBzC,KAHb,EAIP,KAAKyC,cAAL,CAAoBvC,MAJb,EAKP,KAAKc,KAAL,CAAWV,OALJ,EAMPK,aANO,CAAb;;AAQA;AACA,qBAAKK,KAAL,CAAWhB,KAAX,GAAmB2G,WAAW3G,KAA9B;AACA,qBAAKgB,KAAL,CAAWd,MAAX,GAAoByG,WAAWzG,MAA/B;AACA,qBAAKc,KAAL,CAAWC,SAAX,CAAqBgF,KAArB,GAA6BU,WAAWzF,KAAxC;;AAEA;AACA,qBAAKe,YAAL,CAAkB/B,MAAlB,GAA2B,KAAKc,KAAL,CAAWd,MAAtC;AACA,qBAAK+B,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKgB,KAAL,CAAWhB,KAArC;;AAEA;AACA,oBAAMoH,wBAAwB,KAAK3E,cAAL,CAAoBzC,KAApB,GAA4B,CAA1D;AACA,oBAAMqH,wBAAwB,KAAK5E,cAAL,CAAoBvC,MAApB,GAA6B,CAA3D;AACA,oBAAMoH,iBAAiB,KAAKrF,YAAL,CAAkBjC,KAAlB,GAA0B,CAAjD;AACA,oBAAMuH,kBAAkB,KAAKtF,YAAL,CAAkB/B,MAAlB,GAA2B,CAAnD;AACA,oBAAMsH,eAAeJ,wBAAwBE,cAA7C;AACA,oBAAMG,eAAeJ,wBAAwBE,eAA7C;;AAEA,qBAAKtF,YAAL,CAAkBT,QAAlB,GAA6B;AACzBE,yBAAM+F,YADmB;AAEzBrF,2BAAOoF,eAAe,KAAKxG,KAAL,CAAWhB,KAFR;AAGzBqC,4BAAQoF,eAAe,KAAKzG,KAAL,CAAWd,MAHT;AAIzBuB,0BAAM+F;AAJmB,iBAA7B;;AAOA,qBAAKvF,YAAL,CAAkBM,QAAlB,gBACO,KAAKN,YAAL,CAAkBT,QADzB;;AAIA,qBAAKR,KAAL,CAAWC,SAAX,GAAuBiF,OAAOC,MAAP,CAAe,EAAf,EAAmB,KAAKnF,KAAL,CAAWC,SAA9B,EAAyC;AAC5DE,gCAAc,CAAC,CAAD,IAAO,KAAKmC,QAAL,CAAc4D,YAAd,GAA6B,KAAKlG,KAAL,CAAWhB,KAA/C,IAAyD,CAA3D,GAAiEwH,YADjB;AAE5DpG,gCAAc,CAAC,CAAD,IAAO,KAAKkC,QAAL,CAAc6D,aAAd,GAA8B,KAAKnG,KAAL,CAAWd,MAAhD,IAA2D,CAA7D,GAAmEuH;AAFnB,iBAAzC,CAAvB;;AAKJ;AACC,aA5CD,MA4CO;AACHd,6BAAa,oCACP,KAAK1E,YAAL,CAAkBjC,KADX,EAEP,KAAKiC,YAAL,CAAkB/B,MAFX,EAGP,KAAKuC,cAAL,CAAoBzC,KAHb,EAIP,KAAKyC,cAAL,CAAoBvC,MAJb,EAKP,KAAKc,KAAL,CAAWV,OALJ,EAMPK,aANO,CAAb;;AASA,qBAAKK,KAAL,CAAWhB,KAAX,GAAmB,KAAKgB,KAAL,CAAWhB,KAAX,GAAmB2G,WAAWzF,KAAjD;AACA,qBAAKF,KAAL,CAAWd,MAAX,GAAoB,KAAKc,KAAL,CAAWd,MAAX,GAAoByG,WAAWzF,KAAnD;AACA,qBAAKF,KAAL,CAAWC,SAAX,CAAqBgF,KAArB,GAA6B,KAAKjF,KAAL,CAAWC,SAAX,CAAqBgF,KAArB,GAA6BU,WAAWzF,KAArE;;AAEA,qBAAKe,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKiC,YAAL,CAAkBgE,KAAlB,CAAwBjG,KAAxB,GAAgC,KAAKgB,KAAL,CAAWhB,KAArE;AACA,qBAAKiC,YAAL,CAAkB/B,MAAlB,GAA2B,KAAK+B,YAAL,CAAkBgE,KAAlB,CAAwB/F,MAAxB,GAAiC,KAAKc,KAAL,CAAWd,MAAvE;AACA,qBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BE,GAA3B,GAAmC,KAAKO,YAAL,CAAkBgE,KAAlB,CAAwBvE,GAAxB,GAA8B,KAAKV,KAAL,CAAWd,MAA5E;AACA,qBAAK+B,YAAL,CAAkBT,QAAlB,CAA2BC,IAA3B,GAAqC,KAAKQ,YAAL,CAAkBgE,KAAlB,CAAwBxE,IAAxB,GAA+B,KAAKT,KAAL,CAAWhB,KAA/E;AACH;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAK8E,iBAAL,gBACO,kCACC,KAAKA,iBAAL,CAAuBC,eADxB,EAEC,KAAKD,iBAAL,CAAuBE,sBAFxB,EAGC,KAAKhE,KAAL,CAAWC,SAAX,CAAqBE,UAHtB,EAIC,KAAKH,KAAL,CAAWC,SAAX,CAAqBG,UAJtB,EAKC,KAAKJ,KAAL,CAAWC,SAAX,CAAqBgF,KALtB,EAMC,KAAKjF,KAAL,CAAWC,SAAX,CAAqBK,OANtB,CADP;;AAWA;AACA,iBAAKgC,QAAL,CAAcmC,KAAd,CAAoBxE,SAApB,+BACM,KAAK6D,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CADN,sBAEM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAFN,sBAGM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAHN,sBAIM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CAJN,sBAKM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CALN,sBAMM,KAAKD,iBAAL,CAAuBC,eAAvB,CAAuC,CAAvC,CANN;;AAQE;AACA,iBAAKf,iBAAL,CAAuByB,KAAvB,CAA6BhE,IAA7B,GAAwC,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BC,IAAnE;AACA,iBAAKuC,iBAAL,CAAuByB,KAAvB,CAA6B/D,GAA7B,GAAuC,KAAKO,YAAL,CAAkBT,QAAlB,CAA2BE,GAAlE;AACA,iBAAKsC,iBAAL,CAAuByB,KAAvB,CAA6BzF,KAA7B,GAA0C,KAAKiC,YAAL,CAAkBjC,KAA5D;AACA,iBAAKgE,iBAAL,CAAuByB,KAAvB,CAA6BvF,MAA7B,GAA2C,KAAK+B,YAAL,CAAkB/B,MAA7D;;AAEA;AACA,iBAAK+B,YAAL,CAAkBC,aAAlB,GAAkC;AAC9BlC,uBAAO,KAAKgB,KAAL,CAAWhB,KAAX,IAAoB,KAAKyC,cAAL,CAAoBzC,KAAxC,GAAgD,KAAKyC,cAAL,CAAoBzC,KAApE,GAA4E,KAAKgB,KAAL,CAAWhB,KADhE;AAE9BE,wBAAQ,KAAKc,KAAL,CAAWd,MAAX,IAAqB,KAAKuC,cAAL,CAAoBvC,MAAzC,GAAkD,KAAKuC,cAAL,CAAoBvC,MAAtE,GAA+E,KAAKc,KAAL,CAAWd;AAFpE,aAAlC;;AAKA;AACA;AACA,iBAAKmG,SAAL;AAEH;;AAGD;AACA;AACA;;;;oCACY;;AAER,gBAAMqB,UAAU,KAAK5D,eAAL,CAAqB6D,UAArB,CAAgC,IAAhC,CAAhB;AACA,gBAAMrH,UAAU,KAAKU,KAAL,CAAWV,OAA3B;;AAGA,gBAAMsH,kBAAkBC,KAAKC,KAAL,CAAc,KAAK7F,YAAL,CAAkBjC,KAAlB,GAA0B,KAAKgB,KAAL,CAAWC,SAAX,CAAqBgF,KAA7D,CAAxB;AACA,gBAAM8B,mBAAmBF,KAAKC,KAAL,CAAc,KAAK7F,YAAL,CAAkB/B,MAAlB,GAA2B,KAAKc,KAAL,CAAWC,SAAX,CAAqBgF,KAA9D,CAAzB;;AAIA,iBAAKnC,eAAL,CAAqB9D,KAArB,GAA6B4H,eAA7B;AACA,iBAAK9D,eAAL,CAAqB5D,MAArB,GAA+B6H,gBAA/B;;AAEAL,oBAAQM,SAAR,CAAmB,CAAnB,EAAsB,CAAtB,EAAyBJ,kBAAkB,CAA3C,EAA8CA,kBAAkB,CAAhE;;AAEA;AACA,gBAAKtH,OAAL,EAAe;AACX;AACA;AACA;AACH;;AAGDoH,oBAAQO,IAAR;;AAGA;AACA;AACA,gBAAMC,eAAe,wDACjB,KAAKpD,iBAAL,CAAuBC,eADN,EAEjB,KAAKD,iBAAL,CAAuBE,sBAFN,EAGjB,KAAK/C,YAAL,CAAkBT,QAAlB,CAA2BC,IAHV,EAIjB,KAAKQ,YAAL,CAAkBT,QAAlB,CAA2BE,GAJV,CAArB;;AAOA;AACA,gBAAMyG,UAAUD,aAAarC,CAA7B;AAAA,gBACMuC,UAAUF,aAAapC,CAD7B;AAAA,gBAEMuC,cAAcT,eAFpB;AAAA,gBAGMU,eAAeP,gBAHrB;;AAKA;AACA,gBAAMQ,QAAQ,CAAd;AAAA,gBACMC,QAAQ,CADd;;;AAGA;AACIC,wBAAYb,eAJhB;AAAA,gBAKIc,aAAaX,gBALjB;;AAQA;AACAL,oBAAQrB,SAAR,CACI,KAAK/C,QADT;AAEI;AACA6E,mBAHJ,EAGaC,OAHb;AAII;AACAC,uBALJ,EAKiBC,YALjB;AAMI;AACAC,iBAPJ,EAOWC,KAPX;AAQI;AACAC,qBATJ,EASeC,UATf;;AAWAhB,oBAAQiB,OAAR;;AAEA,gBAAK/H,KAAL,EAAa;;AAET,qBAAKtB,kBAAL,CAAyB;AACrBO,4BAAQ,KAAKiE,eADQ;AAErBzD,8BAAU;AACNL,+BAAO,KAAKsD,QAAL,CAAc4D,YADf;AAENhH,gCAAQ,KAAKoD,QAAL,CAAc6D;AAFhB,qBAFW;AAMrBlH,6BAAS;AACLD,+BAAO4H,eADF;AAEL1H,gCAAQ6H,gBAFH;AAGLzH,iCAASA;AAHJ;AANY,iBAAzB;AAYH;AACJ;;;+BAEOe,O,EAAU;AACd;AACA,iBAAKL,KAAL,CAAWC,SAAX,CAAqBI,OAArB,GAA+BA,OAA/B;AACA,iBAAKL,KAAL,CAAWC,SAAX,CAAqBK,OAArB,GAA+B,iCAAsBD,OAAtB,CAA/B;AACA,iBAAKL,KAAL,CAAWV,OAAX,GAAqB,EAAM,KAAKU,KAAL,CAAWC,SAAX,CAAqBI,OAArB,GAA+B,GAAjC,KAA2C,CAA/C,CAArB;AACA,iBAAKuB,eAAL;AACH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;kBA/4BiB/B,W;;;;;;;;;;;;QC9DL+H,I,GAAAA,I;QAcAC,Q,GAAAA,Q;QAqCAC,a,GAAAA,a;QA8CAC,yB,GAAAA,yB;QAqCAC,iC,GAAAA,iC;QAqBAC,gB,GAAAA,gB;QA6BAC,uB,GAAAA,uB;QAiBAC,qC,GAAAA,qC;QAYAC,Y,GAAAA,Y;QAMAC,oB,GAAAA,oB;QAKAC,qB,GAAAA,qB;QAIAC,M,GAAAA,M;QAIAC,Q,GAAAA,Q;QAOAC,W,GAAAA,W;QAOAC,Q,GAAAA,Q;QAOAC,qB,GAAAA,qB;QA8BAC,2C,GAAAA,2C;AA/RhB;;;;AAIO,SAAShB,IAAT,GAAgB;AACnBzD,eAAY0E,SAASC,SAArB,EAAgC,KAAhC;AACH;;AAED;;;;;;;;;;AAUO,SAASjB,QAAT,CAAmBkB,IAAnB,EAAyBC,IAAzB,EAA8C;AAAA,QAAfC,GAAe,uEAAT/K,MAAS;;AACjD,QAAIgL,UAAU,KAAd;AACA,QAAMC,OAAO,SAAPA,IAAO,GAAW;AACpB,YAAID,OAAJ,EAAa;AAAE;AAAS;AACxBA,kBAAU,IAAV;AACA9E,8BAAsB,SAASgF,8BAAT,GAA0C;AAC5DH,gBAAII,aAAJ,CAAmB,IAAIC,WAAJ,CAAiBN,IAAjB,CAAnB;AACAE,sBAAU,KAAV;AACH,SAHD;AAIH,KAPD;AAQAD,QAAI7F,gBAAJ,CAAqB2F,IAArB,EAA2BI,IAA3B;AACH;;AAED;;;;;;;;;;;;;;;;;;;;;;;;AAwBO,SAASrB,aAAT,CAAwByB,OAAxB,EAAkC;;AAErC,QAAMC,UAAUjL,SAASuJ,aAAT,CAAwByB,QAAQxG,OAAhC,CAAhB;;AAEA,QAAKwG,QAAQ9G,SAAb,EAAyB;AACrB+G,gBAAQ/G,SAAR,GAAoB8G,QAAQ9G,SAA5B;AACH;;AAED,QAAK8G,QAAQE,UAAb,EAA0B;AACtB,aAAM,IAAIC,IAAV,IAAkBH,QAAQE,UAA1B,EAAuC;AACnCD,oBAAQhH,YAAR,CAAsBkH,IAAtB,EAA4BH,QAAQE,UAAR,CAAmBC,IAAnB,CAA5B;AACH;AACJ;;AAED,QAAKH,QAAQI,IAAb,EAAoB;AAChBH,gBAAQjG,WAAR,CAAqBhF,SAASqL,cAAT,CAAyBL,QAAQI,IAAjC,CAArB;AACH;;AAED,QAAKJ,QAAQtG,QAAR,IAAoBsG,QAAQtG,QAAR,CAAiB4G,MAA1C,EAAmD;AAC/C,YAAIC,IAAI,CAAR;AACA,YAAIC,iBAAiBR,QAAQtG,QAAR,CAAiB4G,MAAtC;AACA,eAAOC,IAAIC,cAAX,EAA2BD,GAA3B,EAAiC;AAC7BN,oBAAQjG,WAAR,CAAqBgG,QAAQtG,QAAR,CAAiB6G,CAAjB,aAA+B5L,OAAO8L,WAAtC,GAAoDT,QAAQtG,QAAR,CAAiB6G,CAAjB,CAApD,GAA0EhC,cAAeyB,QAAQtG,QAAR,CAAiB6G,CAAjB,CAAf,CAA/F;AACH;AACJ;;AAED,WAAON,OAAP;AAEH;;AAED;;;;;;;;;;;;;;;;AAgBO,SAASzB,yBAAT,CAAoCkC,gBAApC,EAAsDC,iBAAtD,EAAyE;;AAE5E;AACA;AACA,QAAMC,YAAY5L,SAASC,aAAT,CAAwByL,gBAAxB,CAAlB;AACA,QAAMG,aAAa7L,SAASC,aAAT,CAAwB0L,iBAAxB,CAAnB;;AAEA,QAAK,CAAEC,SAAF,IAAe,CAAEC,UAAtB,EAAmC;AAC/B,cAAM,IAAIC,KAAJ,qDAA4DJ,gBAA5D,YAAmFC,iBAAnF,CAAN;AACH;;AAED,QAAMI,YAAYH,UAAUI,qBAAV,EAAlB;AACA,QAAMC,aAAaJ,WAAWG,qBAAX,EAAnB;;AAEA,WAAO;AACH7J,aAAK4J,UAAU5J,GAAV,GAAgB8J,WAAW9J,GAD7B;AAEHU,eAAOkJ,UAAUlJ,KAAV,GAAkBoJ,WAAWpJ,KAFjC;AAGHC,gBAAQiJ,UAAUjJ,MAAV,GAAmBmJ,WAAWnJ,MAHnC;AAIHZ,cAAM6J,UAAU7J,IAAV,GAAiB+J,WAAW/J;AAJ/B,KAAP;AAOH;;AAED;;;;;;;;;;;;;;AAcO,SAASuH,iCAAT,CAA4CyC,YAA5C,EAA0DC,aAA1D,EAA0E;AAC7E,WAAO;AACHjK,cAAQiK,cAAc1E,WAAd,GAA4B,CAA5B,GAAgCyE,aAAazE,WAAb,GAA2B,CADhE;AAEHtF,aAAOgK,cAAczE,YAAd,GAA6B,CAA7B,GAAiCwE,aAAaxE,YAAb,GAA4B;AAFjE,KAAP;AAIH;;AAED;;;;;;;;;;;;;;AAcO,SAASgC,gBAAT,CAA2B5D,KAA3B,EAA0D;AAAA,QAAxBsG,cAAwB,uEAAP,IAAO;;;AAE7D,QAAMC,aAAaD,iBAAiBA,eAAeC,UAAhC,GAA6C1M,OAAO2M,WAAvE;AACA,QAAMC,YAAYH,iBAAiBA,eAAeG,SAAhC,GAA4C5M,OAAO6M,WAArE;;AAEA,QAAMlG,IAAI,CAAER,MAAM2G,KAAN,IAAiB3G,MAAM4G,OAAN,IAAiB5G,MAAM4G,OAAN,CAAc,CAAd,EAAiBD,KAArD,IAAiEJ,UAA3E;AACA,QAAM9F,IAAI,CAAET,MAAM6G,KAAN,IAAiB7G,MAAM4G,OAAN,IAAiB5G,MAAM4G,OAAN,CAAc,CAAd,EAAiBC,KAArD,IAAiEJ,SAA3E;;AAEA,WAAO;AACHjG,YADG;AAEHC;AAFG,KAAP;AAIH;;AAGD;;;;;;;;;;;;;;AAcO,SAASoD,uBAAT,CAAkCiD,QAAlC,EAA4CC,SAA5C,EAAuDC,QAAvD,EAAiEC,SAAjE,EAA0G;AAAA,QAA9BhM,OAA8B,uEAApB,KAAoB;AAAA,QAAbiM,MAAa,uEAAJ,CAAI;;;AAE7G,QAAMC,cAAclM,UAAUuH,KAAK4E,GAAL,CAAUH,YAAYH,QAAtB,EAAgCE,WAAWD,SAA3C,CAAV,GAAmEvE,KAAK4E,GAAL,CAAUJ,WAAWF,QAArB,EAA+BG,YAAYF,SAA3C,CAAvF;AACA;AACA,QAAMlL,QAAQsL,cAAcD,MAA5B;;AAEA;AACA,QAAMvM,QAAQ6H,KAAKC,KAAL,CAAYqE,WAAWjL,KAAvB,CAAd;AACA,QAAMhB,SAAS2H,KAAKC,KAAL,CAAYsE,YAAYlL,KAAxB,CAAf;;AAEA,WAAO;AACHA,oBADG;AAEHlB,oBAFG;AAGHE;AAHG,KAAP;AAKH;;AAEM,SAASiJ,qCAAT,CAAgDuD,WAAhD,EAA6DC,YAA7D,EAA2EzL,KAA3E,EAAmF;;AAEtF;AACA,QAAMlB,QAAQ6H,KAAKC,KAAL,CAAY4E,cAAcxL,KAA1B,CAAd;AACA,QAAMhB,SAAS2H,KAAKC,KAAL,CAAY6E,eAAezL,KAA3B,CAAf;;AAEA,WAAO;AACHlB,oBADG;AAEHE;AAFG,KAAP;AAIH;;AAEM,SAASkJ,YAAT,CAAuBoB,OAAvB,EAAyF;AAAA,QAAzDrJ,UAAyD,uEAA5C,CAA4C;AAAA,QAAzCC,UAAyC,uEAA5B,CAA4B;AAAA,QAAzB6E,KAAyB,uEAAjB,CAAiB;AAAA,QAAd3E,OAAc,uEAAJ,CAAI;;AAC5FkJ,YAAQ/E,KAAR,CAAcxE,SAAd,mBAAyCE,UAAzC,YAA4DC,UAA5D,oBAAuF6E,KAAvF,mBAA4G3E,OAA5G;AACA,WAAOkJ,OAAP;AACH;;AAED;AACO,SAASnB,oBAAT,CAA+BhI,OAA/B,EAAyC;AAC5C,WAAOA,UAAUwG,KAAK+E,EAAf,GAAoB,GAA3B;AACH;;AAED;AACO,SAAStD,qBAAT,CAAgChI,OAAhC,EAA0C;AAC7C,WAAOA,UAAU,GAAV,GAAgBuG,KAAK+E,EAA5B;AACH;;AAEM,SAASrD,MAAT,CAAiBS,IAAjB,EAAwB;AAC3B,WAAO,IAAI6C,MAAJ,WAAoB7C,IAApB,WAAP;AACH;;AAEM,SAASR,QAAT,CAAmBgB,OAAnB,EAA4B/G,SAA5B,EAAwC;AAC3C,QAAK,EAAI,eAAeqJ,QAAQhD,SAA3B,CAAL,EAA+C;AAC3C,eAAOP,OAAQS,IAAR,EAAe+C,IAAf,CAAqB,KAAKvC,OAAL,CAAa/G,SAAlC,CAAP;AACH;AACD,WAAO+G,QAAQlE,SAAR,CAAkBC,QAAlB,CAA4B9C,SAA5B,CAAP;AACH;;AAEM,SAASgG,WAAT,CAAsBe,OAAtB,EAA+B/G,SAA/B,EAA2C;AAC9C,QAAK,EAAI,eAAeqJ,QAAQhD,SAA3B,CAAL,EAA8C;AAC1C,eAAOU,QAAQ/G,SAAR,GAAqB+G,QAAQ/G,SAAR,CAAkBuJ,OAAlB,CAA2BzD,OAAQS,IAAR,CAA3B,EAA2C,EAA3C,CAA5B;AACH;AACD,WAAOQ,QAAQlE,SAAR,CAAkB2G,MAAlB,CAA0BxJ,SAA1B,CAAP;AACH;;AAEM,SAASiG,QAAT,CAAmBc,OAAnB,EAA4B/G,SAA5B,EAAwC;AAC3C,QAAK,EAAI,eAAeqJ,QAAQhD,SAA3B,CAAL,EAA8C;AAC1C,eAAOU,QAAQ/G,SAAR,IAAqB,MAAMA,SAAlC;AACH;AACD,WAAO+G,QAAQlE,SAAR,CAAkB4G,GAAlB,CAAuBzJ,SAAvB,CAAP;AACH;;AAEM,SAASkG,qBAAT,CAAgC5E,eAAhC,EAAiDC,sBAAjD,EAAyEa,CAAzE,EAA4EC,CAA5E,EAA+EG,KAA/E,EAAsFkH,MAAtF,EAA+F;;AAElG;AACApI,oBAAgB,CAAhB,IAAuBA,gBAAgB,CAAhB,IAAqB8C,KAAKuF,GAAL,CAASD,MAAT,IAAmBlH,KAA/D;AACAlB,oBAAgB,CAAhB,IAAqB,EAAEA,gBAAgB,CAAhB,IAAqB8C,KAAKwF,GAAL,CAASF,MAAT,IAAmBlH,KAA1C,CAArB;;AAEA;AACAlB,oBAAgB,CAAhB,IAAqBc,CAArB;AACAd,oBAAgB,CAAhB,IAAqBe,CAArB;;AAEA;;AAEA;AACA,QAAIwH,QAAQvI,gBAAgB,CAAhB,IAAqBA,gBAAgB,CAAhB,CAArB,GAA0CA,gBAAgB,CAAhB,IAAqBA,gBAAgB,CAAhB,CAA3E;;AAEA;AACAC,2BAAuB,CAAvB,IAA6BD,gBAAgB,CAAhB,IAAqBuI,KAAlD;AACAtI,2BAAuB,CAAvB,IAA4B,CAACD,gBAAgB,CAAhB,CAAD,GAAsBuI,KAAlD;AACAtI,2BAAuB,CAAvB,IAA4B,CAACD,gBAAgB,CAAhB,CAAD,GAAsBuI,KAAlD;AACAtI,2BAAuB,CAAvB,IAA6BD,gBAAgB,CAAhB,IAAqBuI,KAAlD;;AAGA,WAAO;AACHvI,wCADG;AAEHC;AAFG,KAAP;AAIH;;AAED;AACA;AACO,SAAS4E,2CAAT,CAAsD7E,eAAtD,EAAuEC,sBAAvE,EAA+Fa,CAA/F,EAAkGC,CAAlG,EAAsG;AACzG,QAAIyH,EAAJ,EAAQC,EAAR;AACAD,SAAK1H,IAAId,gBAAgB,CAAhB,CAAT,CAFyG,CAExE;AACjCyI,SAAK1H,IAAIf,gBAAgB,CAAhB,CAAT,CAHyG,CAGxE;AACjC;AACA,WAAO;AACHc,WAAK0H,KAAKvI,uBAAuB,CAAvB,CAAL,GAAiCwI,KAAKxI,uBAAuB,CAAvB,CADxC;AAEHc,WAAKyH,KAAKvI,uBAAuB,CAAvB,CAAL,GAAiCwI,KAAKxI,uBAAuB,CAAvB;AAFxC,KAAP;AAIH,C","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3dfb1495544f3c0d250d","import ImageEditor from './image-editor';\n\nwindow.imageEditor = new ImageEditor(\n    {\n        imagePath: 'http://localhost:8888/src/amsler.jpg',\n        imageAltText: 'A village after dark',\n        onWorkSpaceUpdated\n    },\n    document.querySelector( '.media-image-editor__canvas-container' )\n);\n\n\n// DEBUG\nfunction onWorkSpaceUpdated( newImageEditorState ) {\n    const croppedImageObj = document.querySelector( '.media-image-editor_debug__preview-container img' );\n    const croppedImageAtag = document.querySelector( '.media-image-editor_debug__preview-container a' );\n    const previewImage = newImageEditorState.canvas.toDataURL('image/jpeg', 0.8);\n    croppedImageObj.src = previewImage;\n    croppedImageObj.width = newImageEditorState.cropped.width;\n    croppedImageObj.height = newImageEditorState.cropped.height;\n    croppedImageAtag.href = previewImage;\n\n    const template = `\n        <li>\n            <var>Original image dimensions</var>\n            <samp>\n                ${newImageEditorState.original.width}\n                x ${newImageEditorState.original.height}\n            </samp>\n        </li>\n        <li>\n            <var>Cropped dimensions</var>\n            <samp>\n                ${newImageEditorState.cropped.width} x ${newImageEditorState.cropped.height}\n            </samp>\n        </li>\n        <li><var>Cropped coordinates</var> <samp>TBD</samp></li>\n        <li><var>Rotated</var> <samp>${newImageEditorState.cropped.rotated}</samp></li>\n        <li><var>Ratio to original image</var> <samp>TBD</samp></li>\n    `;\n\n    document.querySelector( '.media-image-editor_debug-values ul' ).innerHTML = template;\n\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import {\n    noop,\n    createElement,\n    calculateAspectRatioFit,\n    getRadianFromDegrees,\n    addClass,\n    hasClass,\n    removeClass,\n    getMousePosition ,\ngetOffsetRelativeToParent,\ncreateTransformMatrix,\ngetOriginalCoordinatesFromTransformedMatrix } from './utils';\n\nconst NAMESPACE = 'image-editor';\nconst IMAGE_ALT_TEXT = 'Image being edited';\nconst ACTIVE_CLASS = 'image-editor__active';\nconst EDITOR_GUTTER = .8;\nconst DEBUG = true;\n\n// https://codepen.io/anon/pen/YQJmMr\n//https://stackoverflow.com/questions/34597160/html-canvas-mouse-position-after-scale-and-translate\n\n\n\n// animationframe\n// drawImage while resizing crop area\n// https://stackoverflow.com/questions/6198771/drawing-image-in-canvas-at-an-angle-without-rotating-the-canvas\n// https://stackoverflow.com/questions/41847928/scaling-the-image-and-fitting-in-the-canvas-after-rotation\n\n// when crop tool hits boundary and there's image overflow, zoom/scale image down\n// when cropping down, cropped area zooms out to max width and height according to aspect ratio of container\n/*\n * Cropping area\n * on page load dimensions of the cropping area = the scaled dims of the image\n *\n * 1.    the min dimensions of the cropping area:\n *\n *       a) when the scaled image dims are >= than the cropped area ? 50px square (or according to the aspect ratio)\n *       b) when the scaled image dims === cropped area ? image dims\n *\n * 2.    the max dimensions of the cropping area:\n *       a) when the image dims are > than the cropped area ? = the container bounds - gutter\n *\n *       b) when a crop handler reaches its max bound in any corner\n *       i) if scaled image dim are greater than the cropped area ? make transform-origin the dragged corner of the cropped Area and scale the image\n *      while the mouse is down according to mouse position * sensitivity (the more image overflow there is the faster the growth) until the\n *      cropped area dims reach the scaled height or width of the image\n *\n *      c) when scaled image dims === cropping area dims ?\n *\n * */\n\n/*\n\n// experimental zoom out calculations, might not work\n// which is distance between the dragged corner and the nearest corner of the scaled image\n// it should form some sort of rectangle so the distance is the hypotenuse  \nfunction getHypotenuse ( a, b ) {\n    return Math.sqrt( (a * a) + ( b * b ) );\n}\nfunction getZoomRatio ( newHypontenuse, oldHypontenuse ) {\n    return newHypontenuse / oldHypontenuse   ;\n}\n*/\n\n\nexport default class ImageEditor {\n\n    constructor( props, container ) {\n\n        // cache of computed image properties\n        this.image = {\n            transform: {\n                ratio: 0,\n                translateX: 0,\n                translateY: 0,\n                degrees: 0,\n                radians: getRadianFromDegrees( 0 ),\n                origin: [ 'center', 'center' ]\n            },\n            // this will contain the last offset position of the image\n            // calculated from traslated origin\n            position: {\n                left: 0,\n                top: 0\n            },\n            rotated: false,\n            width: 0,\n            height: 0,\n            drag: {\n              startX:0,\n              startY:0,\n              dx: 0,\n              dy: 0  \n            },\n            maxRatio: 20\n        };\n\n        // the crop tool\n        this.croppingArea = {\n            // maximum dimensions of the crop tool\n            // crop rectangle cannot be bigger than these values\n            // update with viewport size * aspect ratio\n            maxDimensions: {\n                width: 0,\n                height: 0\n            },\n            // minimum dimensions of the crop tool\n            // crop rectangle cannot be smaller than these values\n            // update with aspect ratio\n            minDimensions: {\n                width: 50,\n                height: 50\n            },\n            // current position of the crop rectangle  \n            position: {\n                top: 0,\n                right: 0,\n                bottom: 0,\n                left: 0\n            },\n            // current dimensions\n            width: 0,\n            height: 0,\n            touched: false,\n            boundary: {\n                top: 0,\n                right: 0,\n                bottom: 0,\n                left: 0\n            }\n        };\n\n        this.constrain = false;\n\n        // cache of computed this.imageEditorContainer properties\n        this.outerContainer = {\n            width: 0,\n            height: 0\n        };\n\n        // this will be an ajax call\n        this.imagePath = props.imagePath;\n\n        // append elements\n        this.container = container;\n\n        // bind class methods to this\n        this.onImageLoaded = this.onImageLoaded.bind( this );\n        this.updateWorkspace = this.updateWorkspace.bind( this );\n        this.onWindowResize = this.onWindowResize.bind( this );\n        this.updateWorkspace = this.updateWorkspace.bind( this );\n        this.onStartDragCropArea = this.onStartDragCropArea.bind( this );\n        this.onDragCropArea = this.onDragCropArea.bind( this );\n        this.onStopDragCropArea = this.onStopDragCropArea.bind( this );\n        this.onStartCropResize = this.onStartCropResize.bind( this );\n        this.onCropResize = this.onCropResize.bind( this );\n        this.onStopCropResize = this.onStopCropResize.bind( this );\n\n\n        // create elements\n        const fragment = document.createDocumentFragment();\n\n        // the image to manipulate\n        this.imageObj = new Image();\n        this.imageObj.setAttribute('crossOrigin', 'anonymous');\n        this.imageObj.className = `${NAMESPACE}__image-layer`;\n        this.imageObj.setAttribute( 'alt', this.imageAltText || IMAGE_ALT_TEXT );\n        this.imageObj.onload = this.onImageLoaded;\n        this.imageObj.onerror = noop;\n\n        // create a clone of the original image\n        // so we can reset and get original props\n        // container for the original image\n        this.imageObjClone = null;\n        this.imageObjClone = this.imageObj.cloneNode(true);\n\n        // this is the offPage workspace\n        // it takes the transformed image, and calculates the positions and ratios required to create output image\n        // https://www.html5rocks.com/en/tutorials/canvas/performance/#toc-pre-render\n        // https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas \n        this.canvasWorkspace = createElement( {\n            tagName: 'canvas',\n            className: `${NAMESPACE}__canvas-workspace`\n        } );\n\n        // this is the cropping tool\n        // add the cropping tool and the canvas element\n        this.cropAreaContainer = createElement( {\n            tagName: 'div',\n            className: `${NAMESPACE}__crop-container`,\n            'aria-label': 'Cropping area',\n            children : [\n                {\n                    tagName: 'div',\n                    className: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-nw`\n                },\n                {\n                    tagName: 'div',\n                    className: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-ne`\n                },\n                {\n                    tagName: 'div',\n                    className: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-sw`\n                },\n                {\n                    tagName: 'div',\n                    className: `image-editor__draggable-corner ${NAMESPACE}__draggable-corner-se`\n                },\n                {\n                    tagName: 'span',\n                    className: `image-editor__guide ${NAMESPACE}__guide-horiz-top`\n                },\n                {\n                    tagName: 'span',\n                    className: `image-editor__guide ${NAMESPACE}__guide-horiz-bottom`\n                },\n                this.canvasWorkspace ]\n\n        } );\n\n        // this is the workspace wrapper\n        this.imageEditorWorkspace = createElement( {\n            tagName: 'div',\n            className: `${NAMESPACE}__workspace`,\n            children : [ this.cropAreaContainer, this.imageObj ]\n        } );\n\n        // this is the main container\n        this.imageEditorContainer = createElement( {\n            tagName: 'div',\n            className: `${NAMESPACE}__container ${NAMESPACE}__container-loading`,\n            children : [ this.imageEditorWorkspace ]\n        } );\n\n\n        // add event listeners for dragging\n        // TODO: add helper for multiple event handlers\n        this.cropAreaContainer.addEventListener( 'mousedown', this.onStartDragCropArea );\n        this.cropAreaContainer.addEventListener( 'touchstart', this.onStartDragCropArea, { passive: true } );\n\n        // dragging flag\n        this.dragging = false;\n\n\n        // append elements\n        fragment.appendChild( this.imageEditorContainer );\n        this.container.appendChild( fragment );\n\n        // TODO: requestAnimationFrame to optimize constant coordinate updates\n        this.dragRequestId = null;\n\n        // TODO: these flags are fairly arbitraty now\n        // and are meant to solve immediate dev problems\n        // need review\n        this.resizing = false;\n        this.cropActionTriggered\n\n        this.frameRateInterval = 1000 / 30;\n        this.requestAnimationFrameId = null;\n        this.lastTimestamp = null;\n\n        // callbacks\n        this.onWorkSpaceUpdated = props.onWorkSpaceUpdated;\n\n        // transform matrix defaults\n        this.transformMatrices  = {\n            transformMatrix: [ 1, 0, 0, 1, 0, 0 ],\n            inverseTransformMatrix: [ 1, 0, 0, 1 ]\n        };\n        // load image and prepare workspace\n        this.imageObj.src = this.imagePath;\n\n        return this;\n\n    }\n\n    onImageLoaded() {\n\n        // initial update of coordinates\n        this.updateWorkspace();\n\n        if ( typeof window !== 'undefined' ) {\n              this.lastTimestamp = window.performance.now();\n              window.addEventListener( 'resize', this.onWindowResize );\n        }\n\n        // finally, we show the workspace\n        // place it on the end of the stack to ensure the update takes place first\n        setTimeout( () => {\n            removeClass( this.imageEditorContainer, `${NAMESPACE}__container-loading` );\n        } );\n    }\n\n    onWindowResize() {\n        this.requestAnimationFrameId = window.requestAnimationFrame( this.updateWorkspace );\n    }\n\n    /*\n\n     onStartDragCropArea - main event delegator\n     Since all the interaction takes place on the cropArea,\n     we don't need to assign multiple events to each drag handle and so on\n\n     */\n    onStartDragCropArea( event ) {\n\n        event.preventDefault();\n        addClass( this.cropAreaContainer, ACTIVE_CLASS );\n        // if we've hit a drag handle, stop propagation\n        // and throw the event to the crop resize setup method\n        if  ( hasClass( event.target, `${NAMESPACE}__draggable-corner` ) ) {\n            event.stopImmediatePropagation();\n            //this.dragRequestId = window.requestAnimationFrame( this.updateWorkspace );\n\n            // signals to maintain crop dimensions\n            this.croppingArea.touched = true;\n            this.cropAreaContainer.style.transition = 'unset';\n            this.imageObj.style.transition = 'unset';\n\n            // cache the event\n            this.cropEvent = event;\n          \n            this.onStartCropResize( event );\n            return false;\n        }\n\n        // otherwise we're free to drag the image\n        document.addEventListener( 'mouseup', this.onStopDragCropArea );\n        document.addEventListener( 'touchend', this.onStopDragCropArea );\n        document.addEventListener( 'mouseleave', this.onStopDragCropArea );\n\n        const mousePos = getMousePosition( event, this.imageEditorContainer );\n\n        // we're translating the image so we have to know the delta position\n        // the start position is the mouse position - the last known position\n        this.image.drag.startX = mousePos.x - this.image.transform.translateX;\n        this.image.drag.startY = mousePos.y - this.image.transform.translateY;\n\n        // drag the image\n        document.addEventListener( 'mousemove', this.onDragCropArea );\n        document.addEventListener( 'touchmove', this.onDragCropArea, { passive: true } );\n    }\n\n\n    onDragCropArea( event ) {\n\n        this.dragging = true;\n        const mousePos = getMousePosition( event, this.imageEditorContainer );\n\n        let newDx = mousePos.x - this.image.drag.startX;\n        let newDy = mousePos.y - this.image.drag.startY;\n\n        if ( this.image.width > this.croppingArea.width && \n            this.image.height > this.croppingArea.height\n            && newDx <= this.croppingArea.position.left\n            && newDy <= this.croppingArea.position.top\n            && (-1 * newDy) + this.croppingArea.height <= this.image.height\n            && newDx >=  this.croppingArea.width - this.image.width ) {\n\n\n            this.transformMatrices = {\n                ...createTransformMatrix( \n                    this.transformMatrices.transformMatrix, \n                    this.transformMatrices.inverseTransformMatrix, \n                    newDx, \n                    newDy, \n                    this.image.transform.scale,\n                    this.image.transform.radians \n                )\n            };\n\n            this.imageObj.style.transform = `matrix(    \n                ${this.transformMatrices.transformMatrix[0]}, \n                ${this.transformMatrices.transformMatrix[1]}, \n                ${this.transformMatrices.transformMatrix[2]}, \n                ${this.transformMatrices.transformMatrix[3]}, \n                ${this.transformMatrices.transformMatrix[4]}, \n                ${this.transformMatrices.transformMatrix[5]})`;\n\n            // save the last known offset\n            // TODO: we can create some internal reducer-like methods to manage this state\n            this.image.drag = Object.assign( {},  this.image.drag, {\n                dx: newDx,\n                dy: newDy\n            });\n        }\n   }\n\n    onStopDragCropArea() {\n            this.dragging = false;\n            removeClass( this.cropAreaContainer, ACTIVE_CLASS );\n            document.removeEventListener( 'mousemove', this.onDragCropArea );\n            document.removeEventListener( 'touchmove', this.onDragCropArea, { passive: true } );\n\n            this.image.transform = Object.assign( {}, this.image.transform, {\n                translateX: this.image.drag.dx,\n                translateY: this.image.drag.dy\n            } );\n\n            this.drawImage();\n        }\n\n\n    onStartCropResize ( event ) {\n\n          this.dragging = true;\n\n          event.preventDefault();\n\n          document.addEventListener( 'touchmove', this.onCropResize );\n          document.addEventListener( 'touchend', this.onStopCropResize );\n          document.addEventListener( 'mousemove', this.onCropResize );\n          document.addEventListener( 'mouseup', this.onStopCropResize );\n\n          this.mousePos = {\n              x: 0,\n              y: 0\n          };\n    }\n\n    onCropResize ( event ) {\n        event.preventDefault();\n        this.mousePos = getMousePosition( event, this.imageEditorContainer );\n        // first check the mouse boundaries\n        // now calculate the new dimensions of the crop area\n        let width, height, left, top, right, bottom;\n\n\n        if ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-se` ) ) {\n\n              // origin of image scale should be set to the opposite corner of this handle\n              this.image.transform.origin = [ 'left', 'top' ];\n\n              width  = this.mousePos.x - this.croppingArea.position.left;\n              height = this.mousePos.y - this.croppingArea.position.top;\n              left = this.croppingArea.position.left;\n              top = this.croppingArea.position.top;\n\n              // height = height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : height;\n              // height = height <= this.croppingArea.minDimensions.height ? this.croppingArea.minDimensions.height : height;\n              // width = width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : width;\n              // width = width <= this.croppingArea.minDimensions.width ? this.croppingArea.minDimensions.width : width;\n\n              // if ( this.constrain || event.shiftKey ) {\n              //     height = width / this.image.width * this.image.height;\n              // }\n\n              // this.croppingArea.position.left = left;\n              // this.cropAreaContainer.style.left = `${ this.croppingArea.position.left  }px`;\n\n              // this.croppingArea.width = width; \n              // this.cropAreaContainer.style.width = `${ this.croppingArea.width }px`;\n\n              // this.croppingArea.height = height; \n              // this.cropAreaContainer.style.height = `${ this.croppingArea.height }px`;\n\n              // this.croppingArea.position.top = top;\n              // this.cropAreaContainer.style.top = `${ this.croppingArea.position.top }px`; \n\n              \n              // return false;\n        }\n\n        if ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-sw` ) ) {\n\n              // origin of image scale should be set to the opposite corner of this handle\n              this.image.transform.origin = [ 'right', 'top' ];\n\n              width  = this.croppingArea.width - ( this.mousePos.x - this.croppingArea.position.left );\n              left = this.mousePos.x;\n              height = this.mousePos.y - this.croppingArea.position.top;\n              top = this.croppingArea.position.top;\n\n              // height = height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : height;\n              // height = height <= this.croppingArea.minDimensions.height ? this.croppingArea.minDimensions.height : height;\n              // width = width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : width;\n              // width = width <= this.croppingArea.minDimensions.width ? this.croppingArea.minDimensions.width : width;\n              // left = left >= this.croppingArea.boundary.right - this.croppingArea.minDimensions.width \n              //   ? this.croppingArea.boundary.right - this.croppingArea.minDimensions.width : left;\n              // left = left <= this.croppingArea.boundary.left ? this.croppingArea.boundary.left : left;\n\n              // if ( this.constrain || event.shiftKey ) {\n              //     height = width / this.image.width * this.image.height;\n              // }\n\n              // this.croppingArea.position.left = left;\n              // this.cropAreaContainer.style.left = `${ this.croppingArea.position.left  }px`;\n\n              // this.croppingArea.width = width; \n              // this.cropAreaContainer.style.width = `${ this.croppingArea.width }px`;\n\n              // this.croppingArea.height = height; \n              // this.cropAreaContainer.style.height = `${ this.croppingArea.height }px`;\n\n              // this.croppingArea.position.top = top;\n              // this.cropAreaContainer.style.top = `${ this.croppingArea.position.top }px`; \n\n              \n              // return false;\n\n        }\n\n        if ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-nw` ) ) {\n\n              // origin of image scale should be set to the opposite corner of this handle\n              this.image.transform.origin = [ 'right', 'bottom' ];\n\n              width = this.croppingArea.width - ( this.mousePos.x - this.croppingArea.position.left );\n              height = this.croppingArea.height - ( this.mousePos.y - this.croppingArea.position.top );\n              left = this.mousePos.x;\n              top = this.mousePos.y ;\n              if ( this.constrain || event.shiftKey ) {\n                  top = this.mousePos.y - ( ( width / this.image.width * this.image.height ) - height );\n              }\n\n        }\n\n        if ( this.cropEvent.target.classList.contains( `${NAMESPACE}__draggable-corner-ne` ) ) {\n\n              // origin of image scale should be set to the opposite corner of this handle\n              this.image.transform.origin = [ 'left', 'bottom' ];\n              \n              width = ( this.mousePos.x - this.croppingArea.position.left );\n              height = this.croppingArea.height - ( this.mousePos.y - this.croppingArea.position.top );\n              left = this.croppingArea.position.left;\n              top = this.mousePos.y ;\n              if ( this.constrain || event.shiftKey ) {\n                  top = this.mousePos.y - ( (width / this.image.width * this.image.height ) - height );\n              }\n\n              // height = isNaN(height) ? this.croppingArea.height : height;\n              // height = height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : height;\n              // height = height <= this.croppingArea.minDimensions.height ? this.croppingArea.minDimensions.height : height;\n              // width = width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : width;\n              // width = width <= this.croppingArea.minDimensions.width ? this.croppingArea.minDimensions.width : width;\n              // left = left >= this.croppingArea.boundary.right - this.croppingArea.minDimensions.width \n              //   ? this.croppingArea.boundary.right - this.croppingArea.minDimensions.width : left;\n              // left = left <= this.croppingArea.boundary.left ? this.croppingArea.boundary.left : left;\n              \n              // top = top >= this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height \n              //   ? this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height : top;\n\n              // top = (\n              //   top <= this.croppingArea.boundary.top \n              //   || isNaN(top) ) \n              //   ? this.croppingArea.boundary.top : top;\n\n              // if ( this.constrain || event.shiftKey ) {\n              //     height = width / this.image.width * this.image.height;\n              // }\n\n              // this.croppingArea.position.left = left;\n              // this.cropAreaContainer.style.left = `${ this.croppingArea.position.left  }px`;\n\n              // this.croppingArea.width = width; \n              // this.cropAreaContainer.style.width = `${ this.croppingArea.width }px`;\n\n              // this.croppingArea.height = height; \n              // this.cropAreaContainer.style.height = `${ this.croppingArea.height }px`;\n\n              // this.croppingArea.position.top = top;\n              // this.cropAreaContainer.style.top = `${ this.croppingArea.position.top }px`; \n              \n              // return false;\n\n        }\n\n\n              height = isNaN(height) ? this.croppingArea.height : height;\n              height = height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : height;\n              height = height <= this.croppingArea.minDimensions.height ? this.croppingArea.minDimensions.height : height;\n              width = width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : width;\n              width = width <= this.croppingArea.minDimensions.width ? this.croppingArea.minDimensions.width : width;\n              left = left >= this.croppingArea.boundary.right - this.croppingArea.minDimensions.width \n                ? this.croppingArea.boundary.right - this.croppingArea.minDimensions.width : left;\n              left = left <= this.croppingArea.boundary.left ? this.croppingArea.boundary.left : left;\n              top = top >= this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height \n                ? this.croppingArea.boundary.bottom - this.croppingArea.minDimensions.height : top;\n              top = (top <= this.croppingArea.boundary.top || isNaN(top)) ? this.croppingArea.boundary.top : top;\n\n              if ( this.constrain || event.shiftKey ) {\n                  height = width / this.image.width * this.image.height;\n              }\n\n              this.croppingArea.position.left = left;\n              this.cropAreaContainer.style.left = `${ this.croppingArea.position.left  }px`;\n\n              this.croppingArea.width = width; \n              this.cropAreaContainer.style.width = `${ this.croppingArea.width }px`;\n\n              this.croppingArea.height = height; \n              this.cropAreaContainer.style.height = `${ this.croppingArea.height }px`;\n\n              this.croppingArea.position.top = top;\n              this.cropAreaContainer.style.top = `${ this.croppingArea.position.top }px`; \n              \n              this.croppingArea.position.bottom = this.croppingArea.position.top + height;\n              this.croppingArea.position.right = this.croppingArea.position.left + width;\n              \n              return false;\n\n\n          // zoom out diagonally\n            // this.zoomOut = false;\n            // this.cropActionTriggered = true;\n\n            // if ( width > this.croppingArea.width && height > this.croppingArea.height )  {\n            //   this.zoomOut = true;\n            // }\n            //  if (this.zoomOut)   {\n            //     this.zoomOutImage() ;\n            //  }  \n\n    }\n\n    onStopCropResize () {\n\n        this.dragging = false;\n        this.mousePos = null;\n        this.cropEvent = null;\n        removeClass( this.cropAreaContainer, ACTIVE_CLASS );\n        document.removeEventListener( 'mousemove', this.onCropResize );\n        document.removeEventListener( 'mouseup', this.onStopCropResize );\n\n        document.removeEventListener( 'touchmove', this.onCropResize );\n        document.removeEventListener( 'touchend', this.onStopCropResize );\n        this.cropAreaContainer.style.transition = 'all 0.09s linear';\n        this.imageObj.style.transition = 'transform 0.1s linear';\n        if (!this.cropActionTriggered) {\n          return;\n        }\n\n        this.cropActionTriggered = false;\n\n        // are we zooming out?\n        // TODO: implement this\n        if (this.zoomOut) {\n            this.zoomOut = false;\n            this.croppingArea.scale = {\n                width: this.croppingArea.width / this.image.width,\n                height: this.croppingArea.height / this.image.height,\n                top: this.croppingArea.position.top / this.image.height ,\n                left: this.croppingArea.position.left / this.image.width\n            };\n        } else {\n            //this.zoomInImage();\n        }\n\n        //this.drawImage();\n    }\n\n    zoomInImage() {\n\n         // get aspect ratio of to-be-resized crop area\n        const scaleRatio = calculateAspectRatioFit(\n              this.croppingArea.width,\n              this.croppingArea.height,\n              this.outerContainer.width,\n              this.outerContainer.height,\n              this.image.rotated,\n              EDITOR_GUTTER );\n\n\n       \n        const scale = this.image.transform.scale * scaleRatio.ratio;\n        \n        if (scale >= this.image.maxRatio) {\n            return;\n        }\n        const translateY =  (-1 * (this.croppingArea.position.top * scaleRatio.ratio ))\n              + (this.image.transform.translateY * scaleRatio.ratio);\n        const translateX =  (-1 * (this.croppingArea.position.left * scaleRatio.ratio ))\n              + (this.image.transform.translateX * scaleRatio.ratio);\n\n        this.transformMatrices = {\n            ...createTransformMatrix( \n                this.transformMatrices.transformMatrix, \n                this.transformMatrices.inverseTransformMatrix, \n                // play with this\n                translateX, \n                translateY, \n                scale,\n                this.image.transform.radians \n                )\n        };\n\n        this.imageObj.style.transform = `matrix(    \n            ${this.transformMatrices.transformMatrix[0]}, \n            ${this.transformMatrices.transformMatrix[1]}, \n            ${this.transformMatrices.transformMatrix[2]}, \n            ${this.transformMatrices.transformMatrix[3]}, \n            ${this.transformMatrices.transformMatrix[4]}, \n            ${this.transformMatrices.transformMatrix[5]})`;\n\n        this.image.width = this.image.width * scaleRatio.ratio;\n        this.image.height = this.image.height * scaleRatio.ratio;\n\n        this.croppingArea.maxDimensions = {\n            width: this.image.width >= this.outerContainer.width ? this.outerContainer.width : this.image.width,\n            height: this.image.height >= this.outerContainer.height ? this.outerContainer.height : this.image.height\n        };\n\n        this.croppingArea.width = scaleRatio.width >= this.croppingArea.maxDimensions.width ? this.croppingArea.maxDimensions.width : scaleRatio.width;\n        this.croppingArea.height = scaleRatio.height >= this.croppingArea.maxDimensions.height ? this.croppingArea.maxDimensions.height : scaleRatio.height;\n        \n        this.croppingArea.position.top = 0;\n        this.croppingArea.position.left =  0 ;\n\n        this.cropAreaContainer.style.left = `${ this.croppingArea.position.left   }px`;\n        this.cropAreaContainer.style.top = `${ this.croppingArea.position.top  }px`;\n        this.cropAreaContainer.style.width =  `${ this.croppingArea.width  }px`;\n        this.cropAreaContainer.style.height =  `${ this.croppingArea.height  }px`;\n\n        this.croppingArea.scale = {\n            width: this.croppingArea.width / this.image.width,\n            height: this.croppingArea.height / this.image.height,\n            top: this.croppingArea.position.top / this.image.height ,\n            left: this.croppingArea.position.left / this.image.width,\n        };\n  \n \n        this.image.transform = Object.assign( {}, this.image.transform, {\n            translateX,\n            translateY,\n            scale\n        } );\n\n        this.drawImage();\n\n    }\n\n\n    // TODO: zoom out when pulling the draggable corners\n    zoomOutImage() {\n       console.log('zoom out!!!');\n    }\n\n\n    // update the positions and dimensions\n    // when the workspace changes\n    updateWorkspace( timestamp ) {\n\n      const now = timestamp,\n          elapsedTime = now - this.lastTimestamp;\n\n        if ( elapsedTime < this.frameRateInterval ) {\n          return;\n        }\n\n        // if enough time has passed to call the next frame\n        // reset lastTimeStamp minus 1 frame in ms ( to adjust for frame rates other than 60fps )\n        this.lastTimestamp = now - ( elapsedTime % this.frameRateInterval );\n\n        // cache the container offset width\n        this.outerContainer.width = this.imageEditorContainer.offsetWidth;\n        this.outerContainer.height = this.imageEditorContainer.offsetHeight;\n\n\n        let scaleRatio;\n        \n        // if nothing has been touched, size the image to the workspace\n        if ( ! this.croppingArea.touched ) {\n            // get aspect ratio\n            scaleRatio = calculateAspectRatioFit(\n                  this.imageObj.naturalWidth,\n                  this.imageObj.naturalHeight,\n                  this.outerContainer.width,\n                  this.outerContainer.height,\n                  this.image.rotated,\n                  EDITOR_GUTTER );\n            \n            // apply the initial dimensions to the image      \n            this.image.width = scaleRatio.width;\n            this.image.height = scaleRatio.height;\n            this.image.transform.scale = scaleRatio.ratio;\n            \n            // apply them to the cropping area\n            this.croppingArea.height = this.image.height;\n            this.croppingArea.width = this.image.width;\n\n            // center coords of container\n            const outerContainerCenterX = this.outerContainer.width / 2;\n            const outerContainerCenterY = this.outerContainer.height / 2 ;\n            const imageHalfWidth = this.croppingArea.width / 2;\n            const imageHalfHeight = this.croppingArea.height / 2;\n            const newPositionX = outerContainerCenterX - imageHalfWidth;\n            const newPositionY = outerContainerCenterY - imageHalfHeight;\n\n            this.croppingArea.position = {\n                top:  newPositionY,\n                right: newPositionX + this.image.width,\n                bottom: newPositionY + this.image.height,\n                left: newPositionX\n            };\n\n            this.croppingArea.boundary = {\n                ...this.croppingArea.position\n            };\n\n            this.image.transform = Object.assign( {}, this.image.transform, {\n                translateX: ( -1 * ( this.imageObj.naturalWidth - this.image.width ) / 2 ) + newPositionX,\n                translateY: ( -1 * ( this.imageObj.naturalHeight - this.image.height ) / 2 ) + newPositionY\n            } );\n\n        // else the ratio we care about is the resized cropping area \n        } else {\n            scaleRatio = calculateAspectRatioFit(\n                  this.croppingArea.width,\n                  this.croppingArea.height,\n                  this.outerContainer.width,\n                  this.outerContainer.height,\n                  this.image.rotated,\n                  EDITOR_GUTTER );\n\n\n            this.image.width = this.image.width * scaleRatio.ratio;\n            this.image.height = this.image.height * scaleRatio.ratio;       \n            this.image.transform.scale = this.image.transform.scale * scaleRatio.ratio;\n\n            this.croppingArea.width = this.croppingArea.scale.width * this.image.width;\n            this.croppingArea.height = this.croppingArea.scale.height * this.image.height;\n            this.croppingArea.position.top = ( this.croppingArea.scale.top * this.image.height );\n            this.croppingArea.position.left =  ( this.croppingArea.scale.left * this.image.width);\n        }\n\n      // TODO: this is not exactly right. \n      // translateX is constantly updated, so we need to apply the correct ratio when scaling\n      // haven't worked that out yet  \n      // this.image.transform = Object.assign( {}, this.image.transform, {\n      //     translateX: this.image.transform.translateX * scaleRatio.ratio,\n      //     translateY: this.image.transform.translateY *  scaleRatio.ratio\n      // } );\n\n      // set the image transform matrix\n      this.transformMatrices = {\n          ...createTransformMatrix( \n              this.transformMatrices.transformMatrix, \n              this.transformMatrices.inverseTransformMatrix, \n              this.image.transform.translateX, \n              this.image.transform.translateY, \n              this.image.transform.scale,\n              this.image.transform.radians \n              )\n      };\n\n      // apply the matrix to the image \n      this.imageObj.style.transform = `matrix(    \n          ${this.transformMatrices.transformMatrix[0]}, \n          ${this.transformMatrices.transformMatrix[1]}, \n          ${this.transformMatrices.transformMatrix[2]}, \n          ${this.transformMatrices.transformMatrix[3]}, \n          ${this.transformMatrices.transformMatrix[4]}, \n          ${this.transformMatrices.transformMatrix[5]})`;\n\n        // resize the cropping area\n        this.cropAreaContainer.style.left = `${ this.croppingArea.position.left   }px`;\n        this.cropAreaContainer.style.top = `${ this.croppingArea.position.top  }px`;\n        this.cropAreaContainer.style.width =  `${ this.croppingArea.width  }px`;\n        this.cropAreaContainer.style.height =  `${ this.croppingArea.height  }px`;\n\n        // reset the cropping area's limits\n        this.croppingArea.maxDimensions = {\n            width: this.image.width >= this.outerContainer.width ? this.outerContainer.width : this.image.width,\n            height: this.image.height >= this.outerContainer.height ? this.outerContainer.height : this.image.height\n        };\n\n        // draw to canvas\n        // TODO: we don't actually have to do this at all until the final save\n        this.drawImage();\n\n    }\n\n\n    // TODO: at the moment we're calling this after every image transformation\n    // in fact, because we're keeping track of the transforms, we don't need to call it at all until the end\n    // it's just for the preview\n    drawImage() {\n\n        const context = this.canvasWorkspace.getContext('2d');\n        const rotated = this.image.rotated;\n\n       \n        const scaledCropWidth = Math.floor( ( this.croppingArea.width / this.image.transform.scale  ) );\n        const scaledCropHeight = Math.floor( ( this.croppingArea.height / this.image.transform.scale  ) );\n\n\n\n        this.canvasWorkspace.width = scaledCropWidth;\n        this.canvasWorkspace.height =  scaledCropHeight;\n\n        context.clearRect( 0, 0, scaledCropWidth / 2, scaledCropWidth / 2  );\n\n        // TODO\n        if ( rotated ) {\n            // origin of the canvas rotate is the middle\n            // context.translate( this.canvasWorkspace.width / 2, this.canvasWorkspace.width / 2 );\n            // context.rotate( this.image.transform.radians );\n        }\n        \n\n        context.save();\n\n\n        // invert the matrix and get the original coords \n        // from the top, left  of the cropping tool\n        const sourceCoords = getOriginalCoordinatesFromTransformedMatrix( \n            this.transformMatrices.transformMatrix, \n            this.transformMatrices.inverseTransformMatrix,\n            this.croppingArea.position.left,\n            this.croppingArea.position.top\n        );\n\n        // this is where and how far we want to crop the original image\n        const sourceX = sourceCoords.x,\n              sourceY = sourceCoords.y,\n              sourceWidth = scaledCropWidth,\n              sourceHeight = scaledCropHeight;\n\n        // get the destination x, y\n        const destX = 0,\n              destY = 0,\n\n        // the cropped area\n            destWidth = scaledCropWidth,\n            destHeight = scaledCropHeight;\n\n\n        // now draw!    \n        context.drawImage(\n            this.imageObj,\n            // x, y coordinate of the top left corner of the sub-rectangle of the source image to draw into the destination context.\n            sourceX, sourceY,\n            // w and h of the sub-rectangle of the source image to draw into the destination context.\n            sourceWidth, sourceHeight,\n            // x, y coordinates in the destination canvas at which to place the top-left corner of the source image.\n            destX, destY,\n            // w and h of the image in the destination canvas. Changing these values scales the sub-rectangle in the destination context.\n            destWidth, destHeight );\n\n        context.restore();\n\n        if ( DEBUG ) {\n\n            this.onWorkSpaceUpdated( {\n                canvas: this.canvasWorkspace,\n                original: {\n                    width: this.imageObj.naturalWidth,\n                    height: this.imageObj.naturalHeight\n                },\n                cropped: {\n                    width: scaledCropWidth,\n                    height: scaledCropHeight,\n                    rotated: rotated\n                }\n            } );\n        }  \n    }\n\n    rotate( degrees ) {\n        // TODO: check if one of 90/180/270\n        this.image.transform.degrees = degrees;\n        this.image.transform.radians = getRadianFromDegrees( degrees );\n        this.image.rotated = ! ( ( this.image.transform.degrees % 180 ) === 0 );\n        this.updateWorkspace();\n    }\n\n    // ==== editing API\n    // rotate( callback ) // returns new coords\n    // reflect( callback ) // returns new coords\n    // changeAspectRatio( callback ) // returns new coords\n    // save() // returns blob\n    // preview() // returns image/png for optional preview before save\n    // reset( callback )\n    // onImageLoaded( callback ) // allows consumers to do something after bootstrap\n    // destroy () clear container and remove all event listeners\n    // getOriginalImage() // returns original image\n    // getWorkingImage() // returns image at current crop state\n\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/image-editor.js","/**\n * Create a noop call\n * @returns {Function}\n */\nexport function noop() {\n    setTimeout( Function.prototype, 10000 );\n}\n\n/**\n * Throttle a func call every {threshhold}ms\n * https://developer.mozilla.org/en-US/docs/Web/Events/resize\n * Usage:\n    throttle(\"resize\", \"optimizedResize\");\n    // handle event\n    window.addEventListener(\"optimizedResize\", function() {\n        console.log(\"Resource conscious resize callback!\");\n    });\n */\nexport function throttle( type, name, obj = window ) {\n    let running = false;\n    const func = function() {\n        if (running) { return; }\n        running = true;\n        requestAnimationFrame(function throttledRequestAnimationFrame() {\n            obj.dispatchEvent( new CustomEvent( name ) );\n            running = false;\n        });\n    };\n    obj.addEventListener(type, func);\n}\n\n/**\n * Creates a simple DOM tree\n * @example\nconst htmlElementToAppend = createElement({\n  tagName: 'span',\n  className: 'new-class-name',\n  text: 'Spannend!',\n  attributes: {\n    'title': 'Geil!'\n  },\n  children: [{ \n      // recursive call to createElement()\n  }]\n})); // returns => <span class=\"new-class-name\" title=\"Geil!\">Spannend!</span>\n * @typedef {Object} OptionsObject\n * @property {String} tagName\n * @property {String} className\n * @property {String} text\n * @property {Object} attributes\n * @property {Array<options>} children\n * \n * @param {OptionsObject} options\n * @returns {HTMLElement}\n */\nexport function createElement( options ) {\n\n    const element = document.createElement( options.tagName );\n\n    if ( options.className ) {\n        element.className = options.className;\n    }\n\n    if ( options.attributes ) {\n        for ( let attr in options.attributes ) {\n            element.setAttribute( attr, options.attributes[attr] )\n        }\n    }\n\n    if ( options.text ) {\n        element.appendChild( document.createTextNode( options.text ) );\n    }\n\n    if ( options.children && options.children.length ) {\n        let i = 0;\n        let childrenLength = options.children.length;\n        for (; i < childrenLength; i++ ) {\n            element.appendChild( options.children[i] instanceof window.HTMLElement ? options.children[i] : createElement( options.children[i] ) );\n        }\n    }\n\n    return element;\n\n}\n\n/**\n * @example\n const offsetValues = getOffsetRelativeToParent(\n    '.child-selector',\n    '#parent-selector'\n ); // returns => { top: {n}, right: {n}, bottom: {n}, left: {n} }\n * @typedef {Object} OffsetObject\n * @property {Integer} top\n * @property {Integer} right\n * @property {Integer} bottom\n * @property {Integer} left\n *\n * @param {String} childCssSelector\n * @param {String} parentCssSelector\n * @returns {OffsetObject}\n */\nexport function getOffsetRelativeToParent( childCssSelector, parentCssSelector) {\n\n    // we have to query the DOM elements to get the latest position data\n    // in case there has been a CSS transform on the element(s)\n    const childElem = document.querySelector( childCssSelector );\n    const parentElem = document.querySelector( parentCssSelector );\n\n    if ( ! childElem || ! parentElem ) {\n        throw new Error( `One or more DOM elements can't be found with: ${childCssSelector} or ${parentCssSelector}` );\n    }\n\n    const childRect = childElem.getBoundingClientRect();\n    const parentRect = parentElem.getBoundingClientRect();\n\n    return {\n        top: childRect.top - parentRect.top,\n        right: childRect.right - parentRect.right,\n        bottom: childRect.bottom - parentRect.bottom,\n        left: childRect.left - parentRect.left\n    };\n\n}\n\n/**\n * @example\n const offsetValues = getCenterPositionRelativeToParent(\n    HTMLElement,\n    HTMLElement.parentNode\n ); // returns => { left: {n}, top: {n} }\n * @typedef {Object} CenterPosition\n * @property {Integer} top\n * @property {Integer} left\n *\n * @param {HTMLElement} childElement\n * @param {HTMLElement} parentElement\n * @returns {CenterPosition}\n */\nexport function getCenterPositionRelativeToParent( childElement, parentElement ) {\n    return {\n        left: ( parentElement.offsetWidth / 2 - childElement.offsetWidth / 2 ),\n        top: ( parentElement.offsetHeight / 2 - childElement.offsetHeight / 2 )\n    };\n}\n\n/**\n * @example\n const mousePos = getMousePosition(\n    DOMEventObject,\n    HTMLElement\n ); // returns => { x: {n}, y: {n} }\n * @typedef {Object} PositionObject\n * @property {Integer} x\n * @property {Integer} y\n *\n * @param {DOMEventObject} event\n * @param {HTMLElement} contextElement (optional if you need position relative to parent offset)\n * @returns {PositionObject}\n */\nexport function getMousePosition( event, contextElement = null ) {\n\n    const offsetLeft = contextElement ? contextElement.offsetLeft : window.pageXOffset;\n    const offsetTop = contextElement ? contextElement.offsetTop : window.pageYOffset;\n\n    const x = ( event.pageX || ( event.touches && event.touches[0].pageX ) ) - offsetLeft;\n    const y = ( event.pageY || ( event.touches && event.touches[0].pageY ) ) - offsetTop;\n\n    return {\n        x,\n        y\n    };\n}\n\n\n/**\n * Conserve aspect ratio of the orignal region. Useful when shrinking/enlarging\n * images to fit into a certain area.\n * At the moment we expect rotations of only 90 degrees.\n * This could be improved by always checking if the bounding box of a rotated rectangle fits within the scaled container\n *\n * @param {Number} srcWidth Source area width\n * @param {Number} srcHeight Source area height\n * @param {Number} maxWidth Fittable area maximum available width\n * @param {Number} maxHeight Fittable area maximum available height\n * @param {Boolean} rotated\n * @param {Number} gutter - Optional percentage to increase or decrease the new fit dimensions\n * @return {Object} { width, heigth }\n */\nexport function calculateAspectRatioFit( srcWidth, srcHeight, maxWidth, maxHeight, rotated = false, gutter = 1 ) {\n\n    const aspectRatio = rotated ? Math.min( maxHeight / srcWidth, maxWidth / srcHeight ) : Math.min( maxWidth / srcWidth, maxHeight / srcHeight );\n    // reduce ratio to gutter percentage amount\n    const ratio = aspectRatio * gutter;\n\n    // widths with ratio applied\n    const width = Math.floor( srcWidth * ratio ) ;\n    const height = Math.floor( srcHeight * ratio ) ;\n\n    return {\n        ratio,\n        width,\n        height\n    };\n}\n\nexport function calculateOriginalDimensionsFromScaled( scaledWidth, scaledHeight, ratio ) {\n\n    // widths with ratio applied\n    const width = Math.floor( scaledWidth / ratio ) ;\n    const height = Math.floor( scaledHeight / ratio ) ;\n\n    return {\n        width,\n        height\n    };\n}\n\nexport function transformCSS( element, translateX = 0, translateY = 0, scale = 0, radians = 0 ) {\n    element.style.transform = `translate( ${ translateX }px, ${ translateY }px ) scale( ${ scale } ) rotate( ${ radians }rad ) translateZ( 0px )`;\n    return element;\n}\n\n// Converts from degrees to radians.\nexport function getRadianFromDegrees( degrees ) {\n    return degrees * Math.PI / 180;\n}\n\n// Converts from radians to degrees.\nexport function getDegreesFromRadians( radians ) {\n    return radians * 180 / Math.PI;\n}\n\nexport function regExp( name ) {\n    return new RegExp( `(^| )${name}( |$)` );\n}\n\nexport function hasClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype )  ) {\n        return regExp( name ).test( this.element.className );\n    }\n    return element.classList.contains( className );\n}\n\nexport function removeClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className =  element.className.replace( regExp( name ), '' );\n    }\n    return element.classList.remove( className );\n}\n\nexport function addClass( element, className ) {\n    if ( ! ( 'classList' in Element.prototype ) ) {\n        return element.className += ' ' + className;\n    }\n    return element.classList.add( className );\n}\n\nexport function createTransformMatrix( transformMatrix, inverseTransformMatrix, x, y, scale, rotate ) {\n\n    // create the rotation and scale parts of the transformMatrix\n    transformMatrix[3] =   transformMatrix[0] = Math.cos(rotate) * scale;\n    transformMatrix[2] = -(transformMatrix[1] = Math.sin(rotate) * scale);\n\n    // add the translation\n    transformMatrix[4] = x;\n    transformMatrix[5] = y;\n\n    // calculate the inverse transformation\n\n    // first get the cross product of x axis and y axis\n    var cross = transformMatrix[0] * transformMatrix[3] - transformMatrix[1] * transformMatrix[2];\n\n    // now get the inverted axis\n    inverseTransformMatrix[0] =  transformMatrix[3] / cross;\n    inverseTransformMatrix[1] = -transformMatrix[1] / cross;\n    inverseTransformMatrix[2] = -transformMatrix[2] / cross;\n    inverseTransformMatrix[3] =  transformMatrix[0] / cross;\n    \n\n    return {\n        transformMatrix,\n        inverseTransformMatrix\n    };\n};\n\n// params: x, y coords in current, transformed matrix\n// returns x,y coords from original, untransformed matrix\nexport function getOriginalCoordinatesFromTransformedMatrix( transformMatrix, inverseTransformMatrix, x, y ) {\n    var xx, yy;\n    xx = x - transformMatrix[4];     // remove the translation\n    yy = y - transformMatrix[5];     // by subtracting the origin\n    // return the point {x:?,y:?} by multiplying xx,yy by the inverse matrix\n    return {\n        x:   xx * inverseTransformMatrix[0] + yy * inverseTransformMatrix[2],\n        y:   xx * inverseTransformMatrix[1] + yy * inverseTransformMatrix[3]\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js"],"sourceRoot":""}